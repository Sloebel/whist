{"version":3,"sources":["images/playCards sync /^/.*/.svg$","cards.png","images/phone.png","assets/sounds/playerTurn.mp3","images/playCards/10-C.svg","images/playCards/10-D.svg","images/playCards/10-H.svg","images/playCards/10-S.svg","images/playCards/11-C.svg","images/playCards/11-D.svg","images/playCards/11-H.svg","images/playCards/11-S.svg","images/playCards/12-C.svg","images/playCards/12-D.svg","images/playCards/12-H.svg","images/playCards/12-S.svg","images/playCards/13-C.svg","images/playCards/13-D.svg","images/playCards/13-H.svg","images/playCards/13-S.svg","images/playCards/14-C.svg","images/playCards/14-D.svg","images/playCards/14-H.svg","images/playCards/14-S.svg","images/playCards/2-C.svg","images/playCards/2-D.svg","images/playCards/2-H.svg","images/playCards/2-J.svg","images/playCards/2-S.svg","images/playCards/3-C.svg","images/playCards/3-D.svg","images/playCards/3-H.svg","images/playCards/3-S.svg","images/playCards/4-C.svg","images/playCards/4-D.svg","images/playCards/4-H.svg","images/playCards/4-S.svg","images/playCards/5-C.svg","images/playCards/5-D.svg","images/playCards/5-H.svg","images/playCards/5-S.svg","images/playCards/6-C.svg","images/playCards/6-D.svg","images/playCards/6-H.svg","images/playCards/6-S.svg","images/playCards/7-C.svg","images/playCards/7-D.svg","images/playCards/7-H.svg","images/playCards/7-S.svg","images/playCards/8-C.svg","images/playCards/8-D.svg","images/playCards/8-H.svg","images/playCards/8-S.svg","images/playCards/9-C.svg","images/playCards/9-D.svg","images/playCards/9-H.svg","images/playCards/9-S.svg","firebase/fire.ts","firebase/auth.ts","firebase/db.ts","utils/events/EventEmitter.ts","services/NotificationSrv.ts","authentication/AuthUserContext.ts","authentication/withAuthentication.tsx","authentication/Login.tsx","constants/routes.ts","authentication/SignUp.tsx","authentication/withAuthorization.tsx","dialogs/NewLeague.tsx","dialogs/ResumeLeague.js","utils/Utils.ts","common/dragPad/DragPad.js","constants/dialogs.ts","dialogs/ReorderPlayers.tsx","dialogs/NewGameDialog/NewGameDialog.tsx","dialogs/GameInvite.tsx","constants/cards.ts","dialogs/Dialog.tsx","main/MainMenu.tsx","main/Main.js","constants/states.ts","utils/game-utils.ts","common/cards/Icons.js","common/table/MobileTable.js","common/table/renderers.js","common/cards/Modal.js","common/numbers/Pad.js","common/transition/Css.js","common/player/Pad.js","common/twoWayArrow/TwoWayArrow.jsx","game/PlayCard/PlayCard.tsx","game/ThrownCard/ThrownCard.tsx","game/GamePad/GamePad.js","models/IGameModel.ts","game/GameMobileView.js","constants/scores.ts","services/GameSrv.ts","game/GameTab.tsx","common/loader/Loader.tsx","leagueSummary/LeagueSummary.js","services/LeagueSrv.ts","league/League.tsx","dataTemplates/gameTpl.ts","App.js","registerServiceWorker.js","index.tsx"],"names":["map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","module","exports","fire","firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","auth","db","database","createUser","email","password","createUserWithEmailAndPassword","signInUser","signInWithEmailAndPassword","signOut","usersRef","ref","leaguesRef","doCreateUser","userInfo","set","onceGetUsers","once","onceGetLeagues","EventEmitter","handlers","handler","this","push","filter","h","data","slice","forEach","gameInviteEventEmitter","callback","on","userId","currentUser","uid","gameInvitesRef","child","invite","val","snapshot","console","log","trigger","AuthUserContext","React","createContext","withAuthentication","Component","state","authUser","onAuthStateChanged","setState","Provider","value","props","FormItem","Item","Login","isLoading","handleSubmit","values","history","then","catch","error","alert","message","Consumer","style","textAlign","marginTop","type","size","onClick","goBack","icon","ArrowLeftOutlined","to","onFinish","className","name","rules","required","prefix","MailOutlined","color","placeholder","LockOutlined","htmlType","loading","withRouter","SignUp","formRef","createRef","handleConfirmBlur","target","confirmDirty","compareToFirstPassword","rule","form","current","getFieldValue","validateToNextPassword","validateFields","nickname","user","UserOutlined","SmileOutlined","validator","onBlur","withAuthorization","authCondition","WithAuthorization","width","position","top","Option","NewLeague","leagueID","onCreateLeague","users","description","savingLeagueLoader","players","key","lastID","newID","active","setNewLeagueID","closeModal","showDialog","afterClose","onAfterClose","visible","count","fetchPlayers","title","destroyOnClose","maskClosable","confirmLoading","onOk","onCancel","okText","getContainer","layout","label","len","mode","notFoundContent","ResumeLeague","activeLeagues","footer","itemLayout","dataSource","renderItem","item","Meta","hasTouch","window","navigator","maxTouchPoints","document","documentElement","addListener","element","addEventListener","removeEventListener","shuffle","array","arrayCopy","i","length","j","Math","floor","random","springSetting1","stiffness","damping","springSetting2","clamp","n","min","max","Dialogs","allColors","height","DragPad","handleTouchStart","pressLocation","handleMouseDown","touches","handleTouchMove","preventDefault","handleMouseMove","pageX","pageY","order","lastPress","isPressed","mouseCircleDelta","dx","dy","mouseXY","col","round","row","from","findIndex","p","newOrder","arr","_arr","abs","splice","unshift","pop","reorder","pressX","pressY","handleMouseUp","onChange","colors","reduce","colorObj","player","unListenTouchmove","unListenTouchend","unListenMousemove","unListenMouseup","x","y","visualPosition","translateX","translateY","scale","spring","boxShadow","onMouseDown","bind","onTouchStart","backgroundColor","WebkitTransform","transform","zIndex","ReorderPlayers","handleOnCancel","handleOnOk","handleDragChange","NewGameDialog","setGameMode","modeSelected","handleAfterClose","wrapClassName","closable","centered","cancelText","bodyStyle","display","GameInvite","handleOk","handleCancel","leagueTitle","newGameId","inviter","CARDS","CARDS_SHORT","DialogsMapping","NEW_LEAGUE","NewLeagueDialog","RESUME_LEAGUE","ResumeLeagueDialog","REORDER_PLAYERS","NEW_GAME","GAME_INVITE","Dialog","dialog","dialogProps","DialogEl","MainMenu","items","index","text","disabled","block","Main","newLeague","resumeLeague","orderByChild","equalTo","some","fetch","off","navigateToLeague","showResumeLeagueDialog","closeResumeLeagueDialog","showNewLeagueDialog","closeNewLeagueDialog","INPUT_MODE","CardsType","CLUB","C","DIAMOND","D","HART","H","SPADE","S","NT","calcIfRoundFell","roundData","didRoundFell","bid","won","cardsList","cardsFamilyScoreMap","getDevicePlayerIndex","nextPlayerIndex","dealCards","shuffledCards","shuffleCards","arrayOf4","sortCardsArrays","setCardsByPlayer","cardsArray","cardsArr","obj","sortCards","cards","sort","cardX","cardY","split","cardXNum","cardXType","cardYNum","cardYType","Spade","viewBox","enableBackground","d","fill","Hart","Diamond","points","Club","ChangePlayers","MobileTable","rounds","currentRound","leagueScores","gameID","gutter","marginBottom","span","getTableHeaders","fell","factor","getRoundCol","TrophyTwoTone","twoToneColor","getLeagueScoresCol","playerIndex","playerName","highestBidder","Icon","component","cardsRenderer","trump","CardsModal","showModal","trumpIconMap","prevProp","ghost","QuestionOutlined","onTrumpSelect","NumbersPad","getButtons","baseNum","amount","disabledNumber","Array","num","onBtnClick","showMore","toggleMore","onSelect","textContent","CSS_TRANSITIONS","Css","div","classList","add","setTimeout","remove","prevProps","children","el","PlayerPad","score","undefined","TWO_WAY_ARROW_DIRECTION","TwoWayArrow","direction","PlayCard","card","preSelected","thrown","onCardClick","clickHandler","useCallback","event","src","require","ThrownCard","thrownType","hasWinner","useState","setStyle","useEffect","confirm","config","maxCount","GAME_STATUS","GamePad","audio","Audio","playerTurn","getNextPlayer","selectedPlayer","getBeforePlayer","getBeforePlayerBid","getRoundData","getBeforePlayers","getPlayerAggregateScore","roundsData","roundIndex","aggregateScore","getPlayersButtons","allRounds","currentRoundData","dot","Button","handleCardClick","preSelectedCard","devicePlayerIndex","onCardThrown","inputMode","WON","currentTarget","offsetParent","offsetTop","left","offsetLeft","ownThrownCardInitPos","thrownCards","currentHand","thrownCard","isAllBids","every","_","toggleMute","isMute","reorderPlayersDialogVisible","trumpModalVisible","handCardType","handleSwitchMode","handleCardsPadChange","handleNumberSelect","setSelectedPlayer","showChangeHighestBidderConfirm","showChangePlayerDialog","handleReorderPlayersAfterClose","gameMode","ownCardsState","handsState","prevAllRounds","prevCurrentRound","prevCurrentRoundData","playAudio","currentBidder","BID","stateToUpdate","find","hand","uniqueResult","Map","playerHand","has","uniqueHand","checked","segment","warning","everyoneBid","isAllowedToSelectPlayer","handleRemoteBidFlow","prop","newRoundData","nextPlayer","nextPlayerBid","beforePlayerBid","beforePlayers","bids","aBid","content","okType","bid0","bid1","bid2","bid3","check","playersButtons","isRemote","Group","buttonStyle","justify","checkedChildren","unCheckedChildren","SoundOutlined","cardsMarkerRef","calculateDisableNum","isNumberPadDisabled","shape","PlayersContext","reorderPlayers","getThrownCardsPlacement","getCards","hasCardType","isDevicePlayer","handWinner","fn","playerOnPadMap","toWinner","getFromTo","markerTop","markerWidth","offsetWidth","CARD_MARKER_HEIGHT","CARD_HEIGHT","CARD_WIDTH","getToWinnerCalc","fromTop","fromLeft","getFromToCalc","play","GameMobileView","carouselSwipedLeft","currentView","onCurrentViewChange","carouselEl","nextRound","goToRound","Number","toRoundBefore","carouselSwipedRight","unListenSwipedLeft","unListenSwipedRight","playersColumns","handleSave","handleCardThrown","showNavigation","LeftOutlined","RightOutlined","GAME_DEFAULT_SCORES","GameService","gameKey","cardsByPlayer","update","cardsState","cardIndex","playersOrder","GameTab","gameRef","leagueGamesRef","gameSummaryRef","ownCardsStateRef","summaryToUpdate","prevRounds","gameData","newData","calculatePlayerScore","currentTotalBid","currentTotalWon","allHasWonInput","entries","indexOf","getTotalWonBid","calculateSummary","status","FINISHED","updateGameStatus","scores","totalScore0","totalScore1","totalScore2","totalScore3","totalScore","calculateLeagueScores","mapToPlayersObj","newThrownCards","turnOf","updateOwnCardState","rowScore","pow","diff","a","b","scoreIndex","leagueScore","currentRoundIndex","playersSummary","pIndex","stood","totalRounds","totalHBrounds","stoodWhileHB","stoodInOver","totalOverRounds","stoodInUnder","totalNTrounds","stoodInNT","stoodWhenLastBidder","totalStoodWhenLastBidder","rIndex","lastBidder","successRate","wins","total","successRateHB","successRateOver","successRateUnder","successRateNT","successRateLastBidder","gameSummary","match","params","toggleSlide","setCurrentViewState","getLeagueScores","leagueScore0","leagueScore1","leagueScore2","leagueScore3","summaryObj","initColumns","columns","dealer","selectActiveRound","handleReorderPlayers","snap","gameRefData","loaderStateCb","prevState","handleGameModeChange","currentHandState","handleHandFinished","calculateHandScore","newRound","setCardsToPlayers","createPortal","BorderOuterOutlined","TableOutlined","querySelector","body","winner","trumpCards","calculateHandWinner","goToNextHand","gameToUpdate","getTotalRemoteWonBid","updateHandCardsState","Loader","statsObj","LeagueSummary","getScoreRow","games","scoreReducer","getStatsRow","statsKey","getWinRateRow","calculateRate","sum","game","toPercentage","preCalculateRate","parseFloat","toFixed","sumObj","category","league","dbRef","gameKeys","lastKey","orderByKey","endAt","playerKey","LeagueService","Promise","inviteKey","setInviteObj","invited","setAllInvited","invitedRefs","playersKeys","removeAllInvited","sets","promise","all","gameInviteRef","Content","SubMenu","League","leagueRef","toggleDrawer","drawerVisible","setLoaderState","setNewGameDialogState","show","newGameDialog","addGame","leagueGames","blockedBy","newGameKey","gameTpl","initRoundData","totalBids","score0","aggregateScore0","won0","score1","aggregateScore1","won1","score2","aggregateScore2","won2","score3","aggregateScore3","won3","rateInit","ACTIVE","gameDataTpl","updates","addGamePlayers","menuSelected","url","location","matchGame","pathname","handleMenuItemClick","newGameDialogHandler","leagueData","changedIndex","open","onHandleClick","onClose","getMenu","path","render","exact","selectedKeys","defaultOpenKeys","DashboardOutlined","GoldOutlined","toString","PlusOutlined","ExportOutlined","isAddGameOk","blockLeague","unblockLeague","invitePlayers","shufflePlayers","lastGame","App","onGameInvite","showGameInvite","acceptGameInvite","loader","closeGameInvite","inlineHeader","toggleHeaderInline","handleWindowSizeChange","inline","unlistenHistory","listen","action","unlistenWinResize","listenToWinResize","NotificationService","registerGameInvite","orientation","userAgent","phoneImg","alt","screenSize","isLocalhost","Boolean","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","basename","getElementById","URL","origin","response","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"yGAAA,IAAIA,EAAM,CACT,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,aAAc,IACd,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,IACb,YAAa,KAId,SAASC,EAAeC,GACvB,IAAIC,EAAKC,EAAsBF,GAC/B,OAAOG,EAAoBF,GAE5B,SAASC,EAAsBF,GAC9B,IAAIG,EAAoBC,EAAEN,EAAKE,GAAM,CACpC,IAAIK,EAAI,IAAIC,MAAM,uBAAyBN,EAAM,KAEjD,MADAK,EAAEE,KAAO,mBACHF,EAEP,OAAOP,EAAIE,GAEZD,EAAeS,KAAO,WACrB,OAAOC,OAAOD,KAAKV,IAEpBC,EAAeW,QAAUR,EACzBS,EAAOC,QAAUb,EACjBA,EAAeE,GAAK,K,oBC1EpBU,EAAOC,QAAU,IAA0B,mC,oBCA3CD,EAAOC,QAAU,IAA0B,mC,oBCA3CD,EAAOC,QAAU,IAA0B,wC,4SCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,E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","file":"static/js/main.a83e5f26.chunk.js","sourcesContent":["var map = {\n\t\"./10-C.svg\": 331,\n\t\"./10-D.svg\": 332,\n\t\"./10-H.svg\": 333,\n\t\"./10-S.svg\": 334,\n\t\"./11-C.svg\": 335,\n\t\"./11-D.svg\": 336,\n\t\"./11-H.svg\": 337,\n\t\"./11-S.svg\": 338,\n\t\"./12-C.svg\": 339,\n\t\"./12-D.svg\": 340,\n\t\"./12-H.svg\": 341,\n\t\"./12-S.svg\": 342,\n\t\"./13-C.svg\": 343,\n\t\"./13-D.svg\": 344,\n\t\"./13-H.svg\": 345,\n\t\"./13-S.svg\": 346,\n\t\"./14-C.svg\": 347,\n\t\"./14-D.svg\": 348,\n\t\"./14-H.svg\": 349,\n\t\"./14-S.svg\": 350,\n\t\"./2-C.svg\": 351,\n\t\"./2-D.svg\": 352,\n\t\"./2-H.svg\": 353,\n\t\"./2-J.svg\": 354,\n\t\"./2-S.svg\": 355,\n\t\"./3-C.svg\": 356,\n\t\"./3-D.svg\": 357,\n\t\"./3-H.svg\": 358,\n\t\"./3-S.svg\": 359,\n\t\"./4-C.svg\": 360,\n\t\"./4-D.svg\": 361,\n\t\"./4-H.svg\": 362,\n\t\"./4-S.svg\": 363,\n\t\"./5-C.svg\": 364,\n\t\"./5-D.svg\": 365,\n\t\"./5-H.svg\": 366,\n\t\"./5-S.svg\": 367,\n\t\"./6-C.svg\": 368,\n\t\"./6-D.svg\": 369,\n\t\"./6-H.svg\": 370,\n\t\"./6-S.svg\": 371,\n\t\"./7-C.svg\": 372,\n\t\"./7-D.svg\": 373,\n\t\"./7-H.svg\": 374,\n\t\"./7-S.svg\": 375,\n\t\"./8-C.svg\": 376,\n\t\"./8-D.svg\": 377,\n\t\"./8-H.svg\": 378,\n\t\"./8-S.svg\": 379,\n\t\"./9-C.svg\": 380,\n\t\"./9-D.svg\": 381,\n\t\"./9-H.svg\": 382,\n\t\"./9-S.svg\": 383\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 186;","module.exports = __webpack_public_path__ + \"static/media/cards.03003d3d.png\";","module.exports = __webpack_public_path__ + \"static/media/phone.b4836590.png\";","module.exports = __webpack_public_path__ + \"static/media/playerTurn.303a9497.mp3\";","module.exports = __webpack_public_path__ + \"static/media/10-C.90a1d2da.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-D.1e7ceb93.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-H.a99c411d.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-S.8b991ebd.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-C.e4d58ae7.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-D.b2cc7b26.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-H.c357eab3.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-S.e9f02fbd.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-C.483c9a18.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-D.e34fab0b.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-H.ddc0d874.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-S.84f4e7a8.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-C.f612b546.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-D.0ff22a04.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-H.60e7d399.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-S.22bb59a1.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-C.49a458de.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-D.3fde324e.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-H.e892e743.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-S.78374225.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-C.8a51f4b1.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-D.dd5bdb07.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-H.15c2e192.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-J.2efb9493.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-S.bce46c7b.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-C.6f681593.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-D.15244443.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-H.5d6c501c.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-S.56340b99.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-C.b4c5fedb.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-D.c1449960.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-H.a23231b3.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-S.10c84208.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-C.0eb86f9c.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-D.152f12ae.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-H.8196387a.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-S.143b7322.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-C.4cb8bdad.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-D.bd92854e.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-H.19f2ecf2.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-S.ade7c7e4.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-C.d8d8520b.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-D.204f8d6f.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-H.f0681bb0.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-S.f6bb3b39.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-C.fe3de886.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-D.b6635e40.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-H.eac2a810.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-S.6e2329eb.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-C.a91a0922.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-D.2c4bfcfc.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-H.75cb4cf1.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-S.30d03378.svg\";","import firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport \"firebase/auth\";\n\n// Initialize Firebase\nconst config = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID\n};\nconst fire = firebase.initializeApp(config);\n\nconst auth = firebase.auth();\nconst db = firebase.database();\n\nexport { fire, db, auth };\n\n// export default fire;\n","import { auth } from './fire';\n\n// Sign Up\nexport const createUser = (email: string, password: string) =>\n  auth.createUserWithEmailAndPassword(email, password);\n\n// Sign In\nexport const signInUser = (email: string, password: string) =>\n  auth.signInWithEmailAndPassword(email, password);\n\n// Sign out\nexport const signOut = () => auth.signOut();\n","import { db } from './fire';\r\n\r\n// database refs\r\nexport const usersRef = db.ref('users');\r\nexport const leaguesRef = db.ref('leagues');\r\n\r\n// User API\r\n\r\nexport const doCreateUser = (id: any, userInfo: any) =>\r\n  db.ref(`users/${id}`).set(userInfo);\r\n\r\nexport const onceGetUsers = () => usersRef.once('value');\r\n\r\nexport const onceGetLeagues = () => leaguesRef.once('value');\r\n","export interface IEventEmitter<T> {\n  on(handler: (data?: T) => void): void;\n  off(handler: (data?: T) => void): void;\n}\n\nexport type IHandler<T> = (data?: T) => void;\n\nexport class EventEmitter<T> {\n  private handlers: Array<IHandler<T>> = [];\n\n  public on(handler: IHandler<T>): void {\n    this.handlers.push(handler);\n  }\n\n  public off(handler: IHandler<T>): void {\n    this.handlers = this.handlers.filter(h => h !== handler);\n  }\n\n  public trigger(data?: T) {\n    this.handlers.slice(0).forEach(h => h(data));\n  }\n}\n","import { fire } from '../firebase';\nimport { EventEmitter } from '../utils/events/EventEmitter';\nimport { IGameInvite } from './LeagueSrv';\n\n// TODO: handle posible of many notification\n// for example: two game invites from two different leagues\nclass NotificationsService {\n  private gameInviteEventEmitter: EventEmitter<\n    IGameInvite\n  > = new EventEmitter();\n\n  public registerGameInvite(callback: () => void) {\n    this.gameInviteEventEmitter.on(callback);\n\n    const userId = fire.auth().currentUser?.uid;\n    const gameInvitesRef = fire\n      .database()\n      .ref()\n      .child(`notifications/gameInvites`);\n\n    gameInvitesRef\n      .child(`/invitedPlayers/${userId}`)\n      .on('child_added', (invite) => {\n        gameInvitesRef.child(invite.val()).once('value', (snapshot) => {\n          console.log(snapshot.val());\n          this.gameInviteEventEmitter.trigger(snapshot.val());\n        });\n      });\n  }\n}\n\nexport default new NotificationsService();\n","import React from 'react';\n\nexport type UserContext = firebase.User | null;\n\nconst AuthUserContext = React.createContext<UserContext>(null);\n\nexport default AuthUserContext;\n","import React from 'react';\nimport { fire } from '../firebase';\nimport AuthUserContext from './AuthUserContext';\n\nconst withAuthentication = (Component: React.ComponentType) => {\n  class WithAuthentication extends React.Component {\n    public state = {\n      authUser: null,\n    };\n\n    componentDidMount() {\n      fire.auth().onAuthStateChanged(authUser => {\n        authUser\n          ? this.setState({ authUser })\n          : this.setState({ authUser: null });\n      });\n    }\n\n    render() {\n      const { authUser } = this.state;\n\n      return (\n        <AuthUserContext.Provider value={authUser}>\n          <Component {...this.props} />\n        </AuthUserContext.Provider>\n      );\n    }\n  }\n\n  return WithAuthentication;\n};\n\nexport default withAuthentication;\n","import React from \"react\";\r\nimport { withRouter, Link, RouteComponentProps } from \"react-router-dom\";\r\nimport { Form, Input, Button } from \"antd\";\r\nimport {\r\n  MailOutlined,\r\n  LockOutlined,\r\n  ArrowLeftOutlined\r\n} from \"@ant-design/icons\";\r\nimport * as routes from \"../constants/routes\";\r\nimport { auth } from \"../firebase\";\r\nimport AuthUserContext from \"./AuthUserContext\";\r\n\r\nimport \"./Login.scss\";\r\nimport { IFormValues } from \"../models/common/BasicTypes\";\r\n\r\nconst FormItem = Form.Item;\r\n\r\nexport interface ILoginState {\r\n  isLoading: boolean;\r\n}\r\n\r\nexport interface ILoginProps extends RouteComponentProps {}\r\n\r\nclass Login extends React.Component<ILoginProps, ILoginState> {\r\n  state = {\r\n    isLoading: false\r\n  };\r\n\r\n  private handleSubmit = (values: IFormValues) => {\r\n    this.setState({ isLoading: true });\r\n\r\n    const { history } = this.props;\r\n    const { email, password } = values;\r\n\r\n    auth\r\n      .signInUser(email, password)\r\n      .then(authUser => {\r\n        console.log(authUser);\r\n        history.push(routes.MAIN);\r\n      })\r\n      .catch(error => {\r\n        // Handle Errors here.\r\n        // var errorCode = error.code;\r\n        // var errorMessage = error.message;\r\n        // ...\r\n        alert(error.message);\r\n        this.setState({ isLoading: false });\r\n      });\r\n  };\r\n\r\n  public render() {\r\n    const { history } = this.props;\r\n    const { isLoading } = this.state;\r\n\r\n    return (\r\n      <AuthUserContext.Consumer>\r\n        {authUser =>\r\n          !authUser ? (\r\n            <Form onFinish={this.handleSubmit} className=\"login-form\">\r\n              <FormItem\r\n                name=\"email\"\r\n                rules={[\r\n                  {\r\n                    type: \"email\",\r\n                    message: \"The input is not valid E-mail!\"\r\n                  },\r\n                  {\r\n                    required: true,\r\n                    message: \"Please input your email!\"\r\n                  }\r\n                ]}\r\n              >\r\n                <Input\r\n                  prefix={<MailOutlined style={{ color: \"rgba(0,0,0,.25)\" }} />}\r\n                  placeholder=\"email\"\r\n                  size=\"large\"\r\n                />\r\n              </FormItem>\r\n              <FormItem\r\n                name=\"password\"\r\n                rules={[\r\n                  { required: true, message: \"Please input your Password!\" }\r\n                ]}\r\n              >\r\n                <Input\r\n                  prefix={<LockOutlined style={{ color: \"rgba(0,0,0,.25)\" }} />}\r\n                  type=\"password\"\r\n                  placeholder=\"password\"\r\n                  size=\"large\"\r\n                />\r\n              </FormItem>\r\n              <FormItem>\r\n                {/* <a className=\"login-form-forgot\" href=\"\">\r\n                  Forgot password\r\n                </a> */}\r\n                <Button\r\n                  type=\"primary\"\r\n                  htmlType=\"submit\"\r\n                  size=\"large\"\r\n                  className=\"login-form-button\"\r\n                  loading={isLoading}\r\n                >\r\n                  Log in\r\n                </Button>\r\n                Or <Link to={routes.SIGN_UP}>register now!</Link>\r\n              </FormItem>\r\n            </Form>\r\n          ) : (\r\n            <div style={{ textAlign: \"center\", marginTop: \"50px\" }}>\r\n              <p>You are already logged in,</p>\r\n              <Button\r\n                type=\"primary\"\r\n                size=\"small\"\r\n                onClick={() => history.goBack()}\r\n                icon={<ArrowLeftOutlined />}\r\n              >\r\n                Go back\r\n              </Button>{\" \"}\r\n              or <Link to={routes.MAIN}>Go Home</Link>\r\n            </div>\r\n          )\r\n        }\r\n      </AuthUserContext.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Login);\r\n","export const SIGN_IN = '/login';\nexport const SIGN_UP = '/signup';\nexport const MAIN = '/';\nexport const LEAGUE = '/league';\nexport const GAME = '/game';","import React from 'react';\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\r\nimport { Form, Input, Button } from 'antd';\r\nimport {\r\n  SmileOutlined,\r\n  UserOutlined,\r\n  MailOutlined,\r\n  LockOutlined,\r\n} from '@ant-design/icons';\r\nimport { auth, db } from '../firebase';\r\nimport './Login.scss';\r\nimport { IFormValues } from '../models/common/BasicTypes';\r\nimport { FormInstance } from 'antd/lib/form';\r\n\r\nconst FormItem = Form.Item;\r\n\r\ninterface ISignUpState {\r\n  confirmDirty: boolean;\r\n  isLoading: boolean;\r\n}\r\n\r\ninterface ISignUpProps extends RouteComponentProps {}\r\n\r\nclass SignUp extends React.Component<ISignUpProps, ISignUpState> {\r\n  private formRef = React.createRef<FormInstance>();\r\n\r\n  public constructor(props: ISignUpProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      confirmDirty: false,\r\n      isLoading: false,\r\n    };\r\n  }\r\n\r\n  private handleConfirmBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    this.setState({ confirmDirty: this.state.confirmDirty || !!value });\r\n  };\r\n\r\n  private compareToFirstPassword = (rule: any, value: any, callback: any) => {\r\n    const form = this.formRef.current;\r\n\r\n    if (form && value && value !== form.getFieldValue('password')) {\r\n      callback('Two passwords that you enter is inconsistent!');\r\n    } else {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  private validateToNextPassword = (rule: any, value: any, callback: any) => {\r\n    const form = this.formRef.current;\r\n\r\n    if (value && this.state.confirmDirty) {\r\n      form && form.validateFields(['confirm']);\r\n    }\r\n    callback();\r\n  };\r\n\r\n  private handleSubmit = (values: IFormValues) => {\r\n    this.setState({ isLoading: true });\r\n\r\n    const { name, nickname, email, password } = values;\r\n    auth\r\n      .createUser(email, password)\r\n      .then(authUser => {\r\n        // Create a user in own accessible Firebase Database too\r\n        authUser &&\r\n          authUser.user &&\r\n          db\r\n            .doCreateUser(authUser.user.uid, { name, nickname, email })\r\n            .then(() => {\r\n              this.props.history.push('/');\r\n            })\r\n            .catch(error => {\r\n              alert(error.message);\r\n              this.setState({ isLoading: false });\r\n            });\r\n      })\r\n      .catch(error => {\r\n        alert(error.message);\r\n        this.setState({ isLoading: false });\r\n      });\r\n  };\r\n\r\n  public render() {\r\n    const { isLoading } = this.state;\r\n\r\n    return (\r\n      <Form\r\n        onFinish={this.handleSubmit}\r\n        ref={this.formRef}\r\n        className=\"login-form\"\r\n      >\r\n        <FormItem\r\n          name=\"name\"\r\n          rules={[{ required: true, message: 'Please input your name!' }]}\r\n        >\r\n          <Input\r\n            prefix={<UserOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Name\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"nickname\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please input your Nickname!',\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<SmileOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Nickname\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"email\"\r\n          rules={[\r\n            {\r\n              type: 'email',\r\n              message: 'The input is not valid E-mail!',\r\n            },\r\n            {\r\n              required: true,\r\n              message: 'Please input your email!',\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<MailOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Email\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"password\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please input your Password!',\r\n            },\r\n            {\r\n              validator: this.validateToNextPassword,\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<LockOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            type=\"password\"\r\n            placeholder=\"Password\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"confirm\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please confirm your password!',\r\n            },\r\n            {\r\n              validator: this.compareToFirstPassword,\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<LockOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            type=\"password\"\r\n            placeholder=\"Confirm password\"\r\n            onBlur={this.handleConfirmBlur}\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem>\r\n          <Button\r\n            type=\"primary\"\r\n            htmlType=\"submit\"\r\n            size=\"large\"\r\n            className=\"login-form-button\"\r\n            loading={isLoading}\r\n          >\r\n            Sign Up\r\n          </Button>\r\n        </FormItem>\r\n      </Form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(SignUp);\r\n","import React from 'react';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\nimport { Spin } from 'antd';\nimport { fire } from '../firebase';\nimport * as routes from '../constants/routes';\nimport AuthUserContext, { UserContext } from './AuthUserContext';\n\ninterface IWithAuthorizationProps extends RouteComponentProps {}\n\nconst withAuthorization = <TProps,>(\n  authCondition: (authUser: UserContext) => boolean\n) => (Component: React.ComponentType<TProps>) => {\n  class WithAuthorization extends React.Component<\n    IWithAuthorizationProps & TProps\n  > {\n    public componentDidMount() {\n      fire.auth().onAuthStateChanged((authUser: UserContext) => {\n        if (!authCondition(authUser)) {\n          this.props.history.push(routes.SIGN_IN);\n        }\n      });\n    }\n\n    public render() {\n      return (\n        <AuthUserContext.Consumer>\n          {authUser =>\n            authUser ? (\n              <Component {...this.props} />\n            ) : (\n              <div className=\"full-view loader\">\n                <Spin\n                  size=\"large\"\n                  style={{ width: '100%', position: 'relative', top: '50%' }}\n                />\n              </div>\n            )\n          }\n        </AuthUserContext.Consumer>\n      );\n    }\n  }\n\n  return withRouter(WithAuthorization);\n};\n\nexport default withAuthorization;\n","import React, { Component } from 'react';\r\nimport { Modal, Form, Input, Select, Spin } from 'antd';\r\nimport { fire } from '../firebase';\r\nimport { onceGetUsers, onceGetLeagues } from '../firebase/db';\r\nimport { IBasicDialogProps } from './Dialog';\r\nimport { FormInstance } from 'antd/lib/form/Form';\r\nimport { IRawPlayer, IPlayer } from '../models/IPlayerModel';\r\n\r\nconst FormItem = Form.Item;\r\nconst Option = Select.Option;\r\n\r\ninterface INewLeagueState {\r\n  showDialog: boolean;\r\n  loading: boolean;\r\n  savingLeagueLoader: boolean;\r\n  users: { [userKey: string]: IRawPlayer };\r\n  count: number;\r\n}\r\n\r\nexport interface INewLeagueProps extends IBasicDialogProps<number> {}\r\n\r\nclass NewLeague extends Component<INewLeagueProps, INewLeagueState> {\r\n  private leagueID: number | undefined;\r\n  private formRef = React.createRef<FormInstance>();\r\n\r\n  constructor(props: INewLeagueProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showDialog: this.props.visible,\r\n      users: {},\r\n      count: 0,\r\n      loading: true,\r\n      // addPlayerCollapse: [],\r\n      savingLeagueLoader: false,\r\n    };\r\n  }\r\n\r\n  fetchPlayers() {\r\n    onceGetUsers().then((snapshot) => {\r\n      if (snapshot.val()) {\r\n        this.setState({ users: snapshot.val(), loading: false });\r\n      } else {\r\n        this.setState({ loading: false });\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchPlayers();\r\n  }\r\n\r\n  render() {\r\n    const { showDialog, users, loading, savingLeagueLoader } = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        title=\"Create League\"\r\n        visible={showDialog}\r\n        destroyOnClose={true}\r\n        maskClosable={false}\r\n        confirmLoading={savingLeagueLoader}\r\n        onOk={this.onCreateLeague}\r\n        onCancel={this.closeModal}\r\n        afterClose={this.afterClose}\r\n        // width=\"600px\"\r\n        okText=\"Save & Play\"\r\n        getContainer=\".app\"\r\n      >\r\n        <Form ref={this.formRef} layout=\"vertical\">\r\n          <FormItem\r\n            label=\"Title\"\r\n            name=\"title\"\r\n            rules={[\r\n              { required: true, message: 'Please input the league title!' },\r\n            ]}\r\n          >\r\n            <Input />\r\n          </FormItem>\r\n          <FormItem label=\"Description\" name=\"description\">\r\n            <Input type=\"textarea\" />\r\n          </FormItem>\r\n          {\r\n            <FormItem\r\n              label=\"Players\"\r\n              name=\"players\"\r\n              rules={[{ required: true, len: 4, type: 'array' }]}\r\n            >\r\n              <Select\r\n                mode=\"multiple\"\r\n                notFoundContent={loading ? <Spin size=\"small\" /> : null}\r\n              >\r\n                {Object.keys(users).map((key) => (\r\n                  <Option key={key} value={key}>\r\n                    {users[key].nickname}\r\n                  </Option>\r\n                ))}\r\n              </Select>\r\n            </FormItem>\r\n          }\r\n        </Form>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  private onCreateLeague = () => {\r\n    const form = this.formRef.current;\r\n    const { users } = this.state;\r\n\r\n    form &&\r\n      form\r\n        .validateFields(['title', 'description', 'players'])\r\n        .then((values) => {\r\n          const { description } = values;\r\n          this.setState({ savingLeagueLoader: true });\r\n\r\n          const players: IPlayer[] = values.players.map((key: string) => ({\r\n            key,\r\n            nickname: users[key].nickname,\r\n          }));\r\n\r\n          onceGetLeagues().then((snapshot) => {\r\n            const lastID = snapshot.val() && snapshot.val().lastID;\r\n            const newID = lastID ? lastID + 1 : 1;\r\n\r\n            fire\r\n              .database()\r\n              .ref('leagues/list/_' + newID)\r\n              .set({\r\n                ...values,\r\n                players,\r\n                description: description || '',\r\n                leagueID: newID,\r\n                active: true,\r\n              })\r\n              .then(() => this.setNewLeagueID(newID));\r\n            fire.database().ref('leagues/lastID').set(newID);\r\n          });\r\n        });\r\n  };\r\n\r\n  private setNewLeagueID = (leagueID: number) => {\r\n    this.leagueID = leagueID;\r\n\r\n    this.closeModal();\r\n  };\r\n  // in order to preserve the animation when closing\r\n  // there is also an inner state although visible state initialy is from props\r\n  private closeModal = () => {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n  };\r\n\r\n  private afterClose = () => {\r\n    const { onAfterClose } = this.props;\r\n\r\n    if (typeof onAfterClose === 'function') {\r\n      onAfterClose(this.leagueID);\r\n    }\r\n  };\r\n}\r\n\r\nexport default NewLeague;\r\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Modal, List } from 'antd';\nimport './ResumeLeague.scss';\n\nclass ResumeLeague extends Component {\n  state = {\n    showDialog: this.props.visible,\n  };\n\n  closeModal(leagueID) {\n    // if leagueID - first close the modal then afterClose will pass the leagueID to rout to the right location\n    this.leagueID = leagueID;\n\n    this.setState({\n      showDialog: false,\n    });\n  }\n\n  render() {\n    const { afterClose, activeLeagues } = this.props;\n    const { showDialog } = this.state;\n\n    return (\n      <Modal\n        title=\"Resume League\"\n        visible={showDialog}\n        destroyOnClose={true}\n        maskClosable={false}\n        width=\"600px\"\n        footer={null}\n        onCancel={() => this.closeModal()}\n        afterClose={() => afterClose(this.leagueID)}\n      >\n        <p>List of open leagues</p>\n        <List\n          itemLayout=\"horizontal\"\n          dataSource={activeLeagues}\n          renderItem={item => (\n            <List.Item>\n              <List.Item.Meta\n                title={\n                  <a onClick={() => this.closeModal(item.leagueID)}>\n                    {item.title}\n                  </a>\n                }\n              />\n            </List.Item>\n          )}\n        />\n      </Modal>\n    );\n  }\n}\n\nexport default withRouter(ResumeLeague);\n","export const hasTouch = (): boolean =>\n  !!window.navigator.maxTouchPoints ||\n  'ontouchstart' in document.documentElement;\n\nexport function addListener(\n  element: HTMLElement,\n  type: string,\n  callback: (e: Event) => void\n) {\n  element.addEventListener(type, callback);\n\n  return () => {\n    element.removeEventListener(type, callback);\n  };\n}\n\nexport function isMobileBrowser(): boolean {\n  return (\n    typeof window.orientation !== 'undefined' ||\n    navigator.userAgent.indexOf('IEMobile') !== -1\n  );\n}\n\nexport const unique = <T>(array: T[]) => Array.from(new Set(array));\n\nexport const shuffle = (array: any[]) => {\n  const arrayCopy = [...array];\n\n  for (let i = arrayCopy.length - 1; i > 0; i--) {\n    let j = Math.floor(Math.random() * (i + 1));\n    [arrayCopy[i], arrayCopy[j]] = [arrayCopy[j], arrayCopy[i]];\n  }\n\n  return arrayCopy;\n};\n","import React from \"react\";\nimport { Motion, spring } from \"react-motion\";\nimport { addListener } from \"../../utils/Utils\";\nimport { UserOutlined } from \"@ant-design/icons\";\nimport \"./DragPad.scss\";\n\nconst springSetting1 = { stiffness: 180, damping: 10 };\nconst springSetting2 = { stiffness: 120, damping: 17 };\n\nexport function reorder(arr, from, to) {\n  const _arr = [...arr];\n\n  if (Math.abs(from - to) === arr.length - 1) {\n    [_arr[to], _arr[from]] = [_arr[from], _arr[to]];\n  } else if (from < to && to - from > 1) {\n    const val = _arr[from];\n    _arr.splice(from, 1);\n    _arr.unshift(_arr.pop());\n    _arr.splice(to, 0, val);\n  } else {\n    const val = _arr[from];\n    _arr.splice(from, 1);\n    _arr.splice(to, 0, val);\n  }\n\n  return _arr;\n}\n\nfunction clamp(n, min, max) {\n  return Math.max(Math.min(n, max), min);\n}\n\nconst allColors = [\"#EF767A\", \"#9acaff\", \"#49BEAA\", \"#49DCB1\"];\nconst [count, width, height] = [4, 80, 80];\n\n// indexed by visual position\n// const layout = [0, 1, 2, 3].map(n => {\n//   const row = Math.floor(n / 3);\n//   const col = n % 3;\n//   return [width * col, height * row];\n// });\n\nconst layout = [\n  [width * 1, height * 0],\n  [width * 2, height * 1],\n  [width * 1, height * 2],\n  [width * 0, height * 1]\n];\n\nexport default class DragPad extends React.Component {\n  unListenTouchmove;\n  unListenTouchend;\n  unListenMousemove;\n  unListenMouseup;\n  colors;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      mouseXY: [0, 0],\n      mouseCircleDelta: [0, 0], // difference between mouse and circle pos for x + y coords, for dragging\n      lastPress: null, // key of the last pressed component\n      isPressed: false,\n      order: props.players,\n      from: null,\n      to: null\n    };\n\n    this.colors = props.players.reduce((colorObj, player, i) => {\n      colorObj[player.key] = allColors[i];\n\n      return colorObj;\n    }, {});\n  }\n\n  componentDidMount() {\n    this.unListenTouchmove = addListener(\n      window,\n      \"touchmove\",\n      this.handleTouchMove\n    );\n    this.unListenTouchend = addListener(window, \"touchend\", this.handleMouseUp);\n    this.unListenMousemove = addListener(\n      window,\n      \"mousemove\",\n      this.handleMouseMove\n    );\n    this.unListenMouseup = addListener(window, \"mouseup\", this.handleMouseUp);\n  }\n\n  componentWillUnmount() {\n    this.unListenTouchmove();\n    this.unListenTouchend();\n    this.unListenMousemove();\n    this.unListenMouseup();\n  }\n\n  handleTouchStart = (key, pressLocation, e) => {\n    this.handleMouseDown(key, pressLocation, e.touches[0]);\n  };\n\n  handleTouchMove = e => {\n    e.preventDefault();\n    this.handleMouseMove(e.touches[0]);\n  };\n\n  handleMouseMove = ({ pageX, pageY }) => {\n    const {\n      order,\n      lastPress,\n      isPressed,\n      mouseCircleDelta: [dx, dy]\n    } = this.state;\n\n    if (isPressed) {\n      const mouseXY = [pageX - dx, pageY - dy];\n\n      const col = clamp(Math.round(mouseXY[0] / width), 0, 2);\n      const row = clamp(\n        Math.round(mouseXY[1] / height),\n        0,\n        Math.floor(count / 2)\n      );\n\n      // if col === 1 && row === 0 => index = 0;\n      // if col === 2 && row === 1 => index = 1;\n      // if col === 1 && row === 2 => index = 2;\n      // if col === 0 && row === 1 => index = 3;\n\n      let to = null;\n\n      if (col === 1 && row === 0) {\n        to = 0;\n      } else if (col === 2 && row === 1) {\n        to = 1;\n      } else if (col === 1 && row === 2) {\n        to = 2;\n      } else if (col === 0 && row === 1) {\n        to = 3;\n      }\n\n      const from = order.findIndex(p => p.key === lastPress);\n\n      const newOrder =\n        typeof to === \"number\" && to !== from && reorder(order, from, to);\n\n      this.setState({\n        mouseXY,\n        order: newOrder ? newOrder : [...order],\n        from: newOrder ? from : this.state.from,\n        to: newOrder ? to : this.state.to\n      });\n    }\n  };\n\n  handleMouseDown = (key, [pressX, pressY], { pageX, pageY }) => {\n    this.setState({\n      lastPress: key,\n      isPressed: true,\n      mouseCircleDelta: [pageX - pressX, pageY - pressY],\n      mouseXY: [pressX, pressY]\n    });\n  };\n\n  handleMouseUp = () => {\n    this.setState({ isPressed: false, mouseCircleDelta: [0, 0] });\n\n    if (typeof this.props.onChange === \"function\") {\n      const { order, from, to } = this.state;\n      this.props.onChange(order, from, to);\n    }\n  };\n\n  render() {\n    const { order, lastPress, isPressed, mouseXY } = this.state;\n\n    return (\n      <div className=\"drag-pad\">\n        <div className=\"drag-pad-content\">\n          {order.map((player, key) => {\n            let style;\n            let x;\n            let y;\n            const visualPosition = order.findIndex(p => p.key === player.key);\n            // const visualPosition = order.indexOf(player.index);\n            if (player.key === lastPress && isPressed) {\n              [x, y] = mouseXY;\n              style = {\n                translateX: x,\n                translateY: y,\n                scale: spring(1.2, springSetting1),\n                boxShadow: spring(\n                  (x - (3 * width - 50) / 2) / 15,\n                  springSetting1\n                )\n              };\n            } else {\n              [x, y] = layout[visualPosition];\n              style = {\n                translateX: spring(x, springSetting2),\n                translateY: spring(y, springSetting2),\n                scale: spring(1, springSetting1),\n                boxShadow: spring(\n                  (x - (3 * width - 50) / 2) / 15,\n                  springSetting1\n                )\n              };\n            }\n            return (\n              <Motion key={player.key} style={style}>\n                {({ translateX, translateY, scale, boxShadow }) => (\n                  <div\n                    onMouseDown={this.handleMouseDown.bind(null, player.key, [\n                      x,\n                      y\n                    ])}\n                    onTouchStart={this.handleTouchStart.bind(null, player.key, [\n                      x,\n                      y\n                    ])}\n                    className=\"player-icon\"\n                    style={{\n                      backgroundColor: this.colors[player.key],\n                      WebkitTransform: `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`,\n                      transform: `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`,\n                      zIndex: player.key === lastPress ? 99 : visualPosition,\n                      boxShadow: `${boxShadow}px 5px 5px rgba(0,0,0,0.5)`\n                    }}\n                  >\n                    <UserOutlined />\n                    <span>{player.nickname}</span>\n                  </div>\n                )}\n              </Motion>\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import NewLeagueDialog from '../dialogs/NewLeague';\nimport ResumeLeagueDialog from '../dialogs/ResumeLeague';\nimport ReorderPlayers from '../dialogs/ReorderPlayers';\nimport NewGameDialog from '../dialogs/NewGameDialog/NewGameDialog';\nimport GameInvite from '../dialogs/GameInvite';\n\nexport enum Dialogs {\n  NEW_LEAGUE = 'NEW_LEAGUE',\n  RESUME_LEAGUE = 'RESUME_LEAGUE',\n  REORDER_PLAYERS = 'REORDER_PLAYERS',\n  NEW_GAME = 'NEW_GAME',\n  GAME_INVITE = 'GAME_INVITE',\n}\n\nexport const DialogsMapping = {\n  [Dialogs.NEW_LEAGUE]: NewLeagueDialog,\n  [Dialogs.RESUME_LEAGUE]: ResumeLeagueDialog,\n  [Dialogs.REORDER_PLAYERS]: ReorderPlayers,\n  [Dialogs.NEW_GAME]: NewGameDialog,\n  [Dialogs.GAME_INVITE]: GameInvite,\n};\n","import React, { Component } from 'react';\r\nimport { Modal } from 'antd';\r\nimport DragPad from '../common/dragPad/DragPad';\r\nimport { IBasicDialogProps } from './Dialog';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\ninterface IReorderPlayersState {\r\n  showDialog: boolean;\r\n  order: IPlayer[];\r\n}\r\n\r\nexport interface IReorderPlayersProps extends IBasicDialogProps<any> {\r\n  players: IPlayer[];\r\n  onOk: (order: IPlayer[]) => void;\r\n}\r\n\r\nexport default class ReorderPlayers extends Component<\r\n  IReorderPlayersProps,\r\n  IReorderPlayersState\r\n> {\r\n  constructor(props: IReorderPlayersProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showDialog: props.visible,\r\n      order: props.players,\r\n    };\r\n\r\n    this.handleOnCancel = this.handleOnCancel.bind(this);\r\n    this.handleOnOk = this.handleOnOk.bind(this);\r\n    this.afterClose = this.afterClose.bind(this);\r\n    this.handleDragChange = this.handleDragChange.bind(this);\r\n  }\r\n\r\n  public render() {\r\n    const { players } = this.props;\r\n    const { showDialog } = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        title=\"Reorder Players\"\r\n        visible={showDialog}\r\n        destroyOnClose={true}\r\n        maskClosable={false}\r\n        width=\"600px\"\r\n        onOk={this.handleOnOk}\r\n        onCancel={this.handleOnCancel}\r\n        afterClose={this.afterClose}\r\n      >\r\n        <DragPad players={players} onChange={this.handleDragChange} />\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  private handleOnCancel() {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n  }\r\n\r\n  private handleOnOk() {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n\r\n    const { onOk } = this.props;\r\n    if (typeof onOk === 'function') {\r\n      const { order } = this.state;\r\n      onOk(order);\r\n    }\r\n  }\r\n\r\n  private afterClose() {\r\n    const { onAfterClose } = this.props;\r\n\r\n    if (typeof onAfterClose === 'function') {\r\n      onAfterClose();\r\n    }\r\n  }\r\n\r\n  private handleDragChange(order: IPlayer[]) {\r\n    this.setState({\r\n      order,\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\nimport { Modal } from 'antd';\nimport './NewGameDialog.scss';\nimport { GameMode } from '../../models/IGameModel';\nimport { IBasicDialogProps } from '../Dialog';\n\ninterface INewGameDialogState {\n  showDialog: boolean;\n  modeSelected?: GameMode;\n}\n\nexport interface INewGameDialogProps extends IBasicDialogProps<GameMode> {}\n\nexport default class NewGameDialog extends React.Component<\n  INewGameDialogProps,\n  INewGameDialogState\n> {\n  public constructor(props: INewGameDialogProps) {\n    super(props);\n\n    this.state = {\n      showDialog: props.visible,\n    };\n  }\n\n  public render() {\n    const { showDialog } = this.state;\n\n    return (\n      <Modal\n        wrapClassName=\"remote-local-dialog\"\n        visible={showDialog}\n        destroyOnClose={true}\n        closable={false}\n        maskClosable={false}\n        centered={true}\n        width=\"300px\"\n        okText={'Frontal'}\n        cancelText={'OnLine'}\n        onOk={this.setGameMode('local')}\n        onCancel={this.setGameMode('remote')}\n        afterClose={this.handleAfterClose}\n        bodyStyle={{ display: 'none' }}\n      />\n    );\n  }\n\n  private setGameMode = (mode: GameMode) => () => {\n    this.setState({\n      showDialog: false,\n      modeSelected: mode,\n    });\n  };\n\n  private handleAfterClose = () => {\n    const { onAfterClose } = this.props;\n\n    if (typeof onAfterClose === 'function' && this.state.modeSelected) {\n      onAfterClose(this.state.modeSelected);\n    }\n  };\n}\n","import React from 'react';\nimport { Modal } from 'antd';\nimport { IGameInvite } from '../services/LeagueSrv';\nimport { IBasicDialogProps } from './Dialog';\n\ninterface IGameInviteState {\n  showDialog: boolean;\n}\n\nexport interface IGameInviteProps extends IBasicDialogProps<any> {\n  invite: IGameInvite;\n  onOk: () => void;\n}\n\nexport default class GameInvite extends React.Component<\n  IGameInviteProps,\n  IGameInviteState\n> {\n  public constructor(props: IGameInviteProps) {\n    super(props);\n\n    this.state = {\n      showDialog: props.visible,\n    };\n  }\n\n  public render() {\n    const { showDialog } = this.state;\n    const { leagueTitle, newGameId, inviter } = this.props.invite;\n\n    return (\n      <Modal\n        title=\"Game Invite\"\n        visible={showDialog}\n        destroyOnClose={true}\n        closable={true}\n        maskClosable={false}\n        centered={true}\n        width=\"300px\"\n        okText={'Join'}\n        cancelText={'Cancel'}\n        onOk={this.handleOk}\n        onCancel={this.handleCancel}\n        afterClose={this.handleAfterClose}\n      >\n        <div>\n          {`${inviter.nickname} from ${leagueTitle} invites you to join game ${newGameId}`}\n        </div>\n      </Modal>\n    );\n  }\n\n  private handleOk = () => {\n    this.setState({\n      showDialog: false,\n    });\n\n    const { onOk } = this.props;\n    if (typeof onOk === 'function') {\n      onOk();\n    }\n  };\n\n  private handleCancel = () => {\n    this.setState({\n      showDialog: false,\n    });\n  };\n\n  private handleAfterClose = () => {\n    const { onAfterClose } = this.props;\n\n    if (typeof onAfterClose === 'function') {\n      onAfterClose();\n    }\n  };\n}\n","export enum CARDS {\r\n  SPADE = 'SPADE',\r\n  HART = 'HART',\r\n  DIAMOND = 'DIAMOND',\r\n  CLUB = 'CLUB',\r\n  NT = 'NT',\r\n}\r\n\r\nexport enum CARDS_SHORT {\r\n  C = 'C',\r\n  D = 'D',\r\n  H = 'H',\r\n  S = 'S',\r\n}\r\n\r\nexport const CardsType = {\r\n  [CARDS.CLUB]: CARDS_SHORT.C,\r\n  [CARDS.DIAMOND]: CARDS_SHORT.D,\r\n  [CARDS.HART]: CARDS_SHORT.H,\r\n  [CARDS.SPADE]: CARDS_SHORT.S,\r\n  [CARDS.NT]: 'NT',\r\n};\r\n","import React from 'react';\nimport { DialogsMapping, Dialogs } from '../constants/dialogs';\nimport { INewGameDialogProps } from './NewGameDialog/NewGameDialog';\nimport { IGameInviteProps } from './GameInvite';\nimport { IReorderPlayersProps } from './ReorderPlayers';\nimport { INewLeagueProps } from './NewLeague';\n\nexport interface IBasicDialogProps<T> {\n  visible: boolean;\n  onAfterClose?: <T>(arg?: T) => void;\n}\n\n// TODO: remove the any once all the dialogs are ts and implement dinamic typing\nexport type DialogProps =\n  | INewGameDialogProps\n  | IGameInviteProps\n  | IReorderPlayersProps\n  | INewLeagueProps\n  | any;\n\nexport interface IDialogProps {\n  dialog: Dialogs;\n  dialogProps?: DialogProps;\n}\n\nconst Dialog: React.FC<IDialogProps> = (props) => {\n  const { dialog, dialogProps } = props;\n  const DialogEl = DialogsMapping[dialog];\n\n  return <DialogEl {...dialogProps} />;\n};\n\nexport default Dialog;\n","import React from 'react';\nimport { Button } from 'antd';\nimport Dialog, { DialogProps } from '../dialogs/Dialog';\nimport { Dialogs } from '../constants/dialogs';\n\nexport interface IMainMenuItem {\n  text: string;\n  onClick?: () => void;\n  dialog?: Dialogs;\n  disabled?: boolean;\n  dialogProps: DialogProps;\n}\n\nexport interface IMainMenuProps {\n  items: IMainMenuItem[];\n}\n\nconst MainMenu = (props: IMainMenuProps) => {\n  return (\n    <ul className=\"app-menu\">\n      {props.items.map((item, index) => {\n        const { onClick, text, dialog, dialogProps, disabled } = item;\n\n        // the Dialog should not be instanced unless it's visible\n        // in some Dialogs there are calls to the DB\n        return (\n          <li key={index}>\n            <Button onClick={onClick} size=\"large\" disabled={disabled} block>\n              {text}\n            </Button>\n            {dialog && dialogProps.visible ? (\n              <Dialog dialog={dialog} dialogProps={dialogProps} />\n            ) : (\n              ''\n            )}\n          </li>\n        );\n      })}\n    </ul>\n  );\n};\n\nexport default MainMenu;\n","import React, { Component } from 'react';\nimport { fire, auth } from '../firebase';\nimport withAuthorization from '../authentication/withAuthorization';\nimport MainMenu from './MainMenu';\nimport * as routes from './../constants/routes';\nimport { Dialogs } from './../constants/dialogs';\n\nclass Main extends Component {\n  // Dialogs visible states controling if the Dialog should be instansiated or not\n  // this outer state is for saving unnecessary access to the DB\n  state = {\n    activeLeagues: [],\n    newLeague: false,\n    resumeLeague: false,\n  };\n\n  /* Create reference to activeLeagues in Firebase Database */\n  activeLeagues = fire\n    .database()\n    .ref('leagues/list')\n    .orderByChild('active')\n    .equalTo(true);\n\n  fetch() {\n    this.activeLeagues.on('value', (snapshot) => {\n      if (snapshot.val()) {\n        const userId = fire.auth().currentUser.uid;\n\n        // filtering leagues data by userId,\n        // TODO: check if possible to fix the data differently in the database for better queries\n        // TODO: fix the loader functionality\n        this.setState({\n          activeLeagues: Object.values(snapshot.val()).filter(({ players }) =>\n            Object.values(players).some(({ key }) => key === userId)\n          ),\n          loading: false,\n        });\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.fetch();\n  }\n\n  componentWillUnmount() {\n    this.activeLeagues.off('value');\n  }\n\n  showResumeLeagueDialog() {\n    this.setState({\n      resumeLeague: true,\n    });\n  }\n\n  closeResumeLeagueDialog(leagueID) {\n    this.setState({\n      resumeLeague: false,\n    });\n\n    this.navigateToLeague(leagueID);\n  }\n\n  showNewLeagueDialog() {\n    this.setState({\n      newLeague: true,\n    });\n  }\n\n  closeNewLeagueDialog(leagueID) {\n    this.setState({\n      newLeague: false,\n    });\n\n    this.navigateToLeague(leagueID);\n  }\n\n  navigateToLeague(leagueID) {\n    if (leagueID) {\n      this.props.history.push(`${routes.LEAGUE}/` + leagueID);\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"app-main\">\n        <MainMenu\n          items={[\n            {\n              text: 'Resume League',\n              onClick: this.showResumeLeagueDialog.bind(this),\n              dialog: Dialogs.RESUME_LEAGUE,\n              disabled: this.state.activeLeagues.length === 0,\n              dialogProps: {\n                afterClose: this.closeResumeLeagueDialog.bind(this),\n                visible: this.state.resumeLeague,\n                activeLeagues: this.state.activeLeagues,\n              },\n            },\n            {\n              text: 'Create League',\n              onClick: this.showNewLeagueDialog.bind(this),\n              dialog: Dialogs.NEW_LEAGUE,\n              dialogProps: {\n                onAfterClose: this.closeNewLeagueDialog.bind(this),\n                visible: this.state.newLeague,\n              },\n            },\n            { text: 'Settings' },\n            { text: 'Scores' },\n            {\n              text: 'Sign Out',\n              onClick: auth.signOut,\n            },\n          ]}\n        />\n      </div>\n    );\n  }\n}\n\nconst authCondition = (authUser) => !!authUser;\n\nexport default withAuthorization(authCondition)(Main);\n","export enum INPUT_MODE {\r\n  BID = 'BID',\r\n  WON = 'WON',\r\n}\r\n","import { fire } from '../firebase';\r\nimport { CardsType, CARDS_SHORT, CARDS } from '../constants/cards';\r\nimport {\r\n  IPlayerHand,\r\n  ICardsFromTo,\r\n  ICardsPosition,\r\n  IRoundData,\r\n  IHandState,\r\n} from '../models/IGameModel';\r\nimport { ThrownCardType } from '../game/ThrownCard/ThrownCard';\r\nimport { shuffle } from './Utils';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport const getTotalWonBid = (roundData: IRoundData) => {\r\n  let currentTotalBid: number = 0;\r\n  let currentTotalWon: number = 0;\r\n  let allHasWonInput: boolean = true;\r\n\r\n  for (const [key, value] of Object.entries(roundData)) {\r\n    if (key.indexOf('bid') > -1 && value !== null && value !== '') {\r\n      currentTotalBid += value * 1;\r\n    }\r\n\r\n    if (key.indexOf('won') > -1) {\r\n      if (value !== null && value !== '') {\r\n        currentTotalWon += value * 1;\r\n      } else {\r\n        allHasWonInput = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return { currentTotalBid, currentTotalWon, allHasWonInput };\r\n};\r\n\r\nexport const getTotalRemoteWonBid = (roundData: IRoundData) => {\r\n  let currentTotalBid: number = 0;\r\n  let currentTotalWon: number = 0;\r\n\r\n  [0, 1, 2, 3].forEach((player) => {\r\n    currentTotalBid += +roundData[`bid${player}`];\r\n    currentTotalWon += +roundData[`won${player}`];\r\n  });\r\n\r\n  return { currentTotalBid, currentTotalWon };\r\n};\r\n\r\nexport const calcIfRoundFell = (roundData: IRoundData): boolean => {\r\n  let didRoundFell = true;\r\n\r\n  for (let i = 0; i < 4; i++) {\r\n    const bid = `bid${i}`;\r\n    const won = `won${i}`;\r\n\r\n    if (\r\n      typeof roundData[bid] !== 'number' ||\r\n      typeof roundData[won] !== 'number'\r\n    ) {\r\n      didRoundFell = false;\r\n      break;\r\n    } else if (roundData[bid] === roundData[won]) {\r\n      didRoundFell = false;\r\n      break;\r\n    }\r\n  }\r\n\r\n  return didRoundFell;\r\n};\r\n\r\nexport const cardsList: string[] = (function () {\r\n  const arr: string[] = [];\r\n  for (const type of Object.values(CardsType)) {\r\n    for (let i = 2; i < 15; i++) {\r\n      arr.push(`${i}-${type}`);\r\n    }\r\n  }\r\n\r\n  return arr;\r\n})();\r\n\r\nconst cardsFamilyScoreMap = {\r\n  [CardsType.CLUB]: 1,\r\n  [CardsType.DIAMOND]: 0,\r\n  [CardsType.HART]: 2,\r\n  [CardsType.SPADE]: 3,\r\n};\r\n\r\nexport const getDevicePlayerIndex = (players: IPlayer[]): number => {\r\n  return players.findIndex(\r\n    (player) => player.key === fire.auth().currentUser?.uid\r\n  );\r\n};\r\n\r\nexport const nextPlayerIndex = (index: number) => {\r\n  return index + 1 > 3 ? index + 1 - 4 : index + 1;\r\n};\r\n\r\nexport const dealCards = (players: IPlayer[]) => {\r\n  const shuffledCards = shuffleCards(cardsList);\r\n  const arrayOf4: string[][] = [[], [], [], []];\r\n\r\n  for (let i = 0; i < 52; i += 4) {\r\n    for (let j = 0; j < arrayOf4.length; j++) {\r\n      arrayOf4[j].push(shuffledCards[i + j]);\r\n    }\r\n  }\r\n\r\n  sortCardsArrays(arrayOf4);\r\n\r\n  return setCardsByPlayer(players, arrayOf4);\r\n};\r\n\r\nexport const shuffleCards = (cardsArray: string[]) => shuffle(cardsArray);\r\n\r\nexport const shufflePlayers = (players: IPlayer[]) => shuffle(players);\r\n\r\nconst setCardsByPlayer = (players: IPlayer[], cardsArr: string[][]) =>\r\n  players.reduce((obj, player, index) => {\r\n    obj[player.key] = cardsArr[index];\r\n    return obj;\r\n  }, {} as { [key: string]: string[] });\r\n\r\nconst sortCardsArrays = (cardsArray: string[][]) => {\r\n  cardsArray.forEach((arr) => sortCards(arr));\r\n};\r\n\r\nconst sortCards = (cards: string[]) =>\r\n  cards.sort((cardX, cardY) => {\r\n    const [cardXNum, cardXType] = cardX.split('-');\r\n    const [cardYNum, cardYType] = cardY.split('-');\r\n\r\n    if (cardsFamilyScoreMap[cardXType] < cardsFamilyScoreMap[cardYType]) {\r\n      return 1;\r\n    }\r\n    if (cardsFamilyScoreMap[cardXType] > cardsFamilyScoreMap[cardYType]) {\r\n      return -1;\r\n    }\r\n\r\n    return +cardYNum - +cardXNum;\r\n  });\r\n\r\nexport const uniqueHand = (hand: IPlayerHand[]) => {\r\n  const uniqueResult = [];\r\n  const map = new Map();\r\n\r\n  for (const playerHand of hand) {\r\n    if (!map.has(playerHand.player)) {\r\n      map.set(playerHand.player, true);\r\n\r\n      uniqueResult.push(playerHand);\r\n    }\r\n  }\r\n\r\n  return uniqueResult;\r\n};\r\n\r\nconst CARD_WIDTH = 90;\r\nconst CARD_HEIGHT = 126;\r\nconst CARD_MARKER_HEIGHT = 188;\r\n\r\nexport const getFromToCalc = (\r\n  thrownType: ThrownCardType,\r\n  markerTop: number,\r\n  markerWidth: number,\r\n  ownThrownCardInitPos: ICardsPosition\r\n): ICardsFromTo => {\r\n  switch (thrownType) {\r\n    case 'right':\r\n      return {\r\n        from: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth + CARD_WIDTH,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth / 2,\r\n        },\r\n      };\r\n\r\n    case 'left':\r\n      return {\r\n        from: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: -CARD_WIDTH,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth / 2 - CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'top':\r\n      return {\r\n        from: {\r\n          top: CARD_HEIGHT / 2,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT * 0.8,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    case 'bottom':\r\n      let fromTop: number | undefined = undefined;\r\n      let fromLeft: number | undefined = undefined;\r\n\r\n      if (ownThrownCardInitPos) {\r\n        fromTop = ownThrownCardInitPos.top;\r\n        fromLeft = ownThrownCardInitPos.left;\r\n      }\r\n\r\n      return {\r\n        from:\r\n          typeof fromTop === 'number' && typeof fromLeft === 'number'\r\n            ? {\r\n                top: fromTop,\r\n                left: fromLeft,\r\n              }\r\n            : undefined,\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT * 0.2,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    default:\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop,\r\n          left: markerWidth / 2,\r\n        },\r\n      };\r\n  }\r\n};\r\n\r\nexport const getToWinnerCalc = (\r\n  direction: ThrownCardType,\r\n  markerTop: number,\r\n  markerWidth: number\r\n) => {\r\n  switch (direction) {\r\n    case 'right':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth + CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'left':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: -CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'top':\r\n      return {\r\n        to: {\r\n          top: 0,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    case 'bottom':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT + CARD_HEIGHT * 3,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n  }\r\n};\r\n\r\nexport const calculateHandWinner = (roundData: IRoundData) => {\r\n  const { trump, handsState, currentHand } = roundData;\r\n  const currentHandState = handsState && handsState[currentHand as number];\r\n  const { thrownCards } = currentHandState as IHandState;\r\n\r\n  const trumpCards = thrownCards.filter(\r\n    (thrown) =>\r\n      (thrown.card.split('-')[1] as CARDS_SHORT) === CardsType[trump as CARDS]\r\n  );\r\n\r\n  if (trumpCards.length) {\r\n    const thrownSorted = trumpCards.sort(\r\n      (a, b) => +b.card.split('-')[0] - +a.card.split('-')[0]\r\n    );\r\n\r\n    return thrownSorted[0];\r\n  } else {\r\n    const handCardType = thrownCards[0].card.split('-')[1];\r\n    const thrownSorted = thrownCards\r\n      .filter((thrown) => thrown.card.split('-')[1] === handCardType)\r\n      .sort((a, b) => +b.card.split('-')[0] - +a.card.split('-')[0]);\r\n\r\n    return thrownSorted[0];\r\n  }\r\n};\r\n","import React from 'react';\n\nexport const Spade = () => (\n\t<svg  x=\"0px\" y=\"0px\" viewBox=\"0 0 511.96 511.96\" style={{enableBackground:'new 0 0 511.96 511.96'}} width=\"1em\" height=\"1em\">\n\t\t<g>\n\t\t\t<path d=\"M302.728,390.351c16.49,15.934,26.368,25.759,55.905,24.541c43.494-1.783,83.871-25.459,106.364-62.729\n\t\t\t\tc38.78-64.247,17.576-128.53-23.702-166.824L272.705,6.528c-9.507-8.704-24.082-8.704-33.589,0L68.073,185.34\n\t\t\t\tc-40.13,37.226-57.256,99.037-23.729,161.483c21.283,39.645,61.767,66.357,106.726,68.087c29.281,1.121,40.801-8.66,57.759-24.488\n\t\t\t\tc4.458-4.167,11.767-1.033,11.767,5.076l0.009,29.987c0,16.172-4.228,32.071-12.253,46.115l-15.519,27.154\n\t\t\t\tc-3.354,5.888,0.892,13.206,7.671,13.206h110.813c6.78,0,11.034-7.318,7.671-13.206l-15.519-27.154\n\t\t\t\tc-8.024-14.045-12.244-29.943-12.244-46.115v-30.296C291.226,389.213,298.429,386.202,302.728,390.351\"/>\n\t\t\t<path style={{fill:'#2A2D33'}}  d=\"M427.21,329.362c-8.701,14.419-21.869,26.091-37.482,33.362c-10.397,4.841-21.597,7.606-32.91,8.072\n\t\t\t\tc-4.871,0.201-8.657,4.312-8.457,9.184c0.201,4.871,4.312,8.657,9.184,8.457c13.661-0.563,27.144-3.891,39.635-9.707\n\t\t\t\tc18.759-8.735,34.611-22.785,45.145-40.244c19.021-31.51,20.189-64.061,7.087-94.822c-1.911-4.485-7.096-6.573-11.581-4.662\n\t\t\t\tc-4.485,1.911-6.573,7.096-4.662,11.581C444.131,276.316,443.177,302.911,427.21,329.362z\"/>\n\t\t</g>\n\t</svg>\n);\n\nexport const Hart = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 510.977 510.977\" style={{enableBackground:'new 0 0 510.977 510.977'}} width=\"1em\" height=\"1em\">\n    <g>\n      <path style={{fill:'#D71E00'}} d=\"M255.22,105.177c19.535-49.77,61.325-87.79,113.231-87.79c43.705,0,79.625,23.111,108.871,54.44\n        c38.859,41.622,56.17,137.216-15.863,209.24c-36.546,36.546-205.815,212.524-205.815,212.524S86.384,317.613,49.838,281.066\n        c-72.033-72.024-55.578-167.618-15.863-209.24c29.581-31.002,65.165-54.44,108.871-54.44\n        C194.751,17.386,235.685,55.407,255.22,105.177\"/>\n      <path style={{fill:'#B21606'}} d=\"M429.848,94.824c26.006,21.865,39.538,63.103,31.858,97.341c-0.675,2.978-1.395,6.021-2.154,9.091\n        c-1.17,4.733,1.718,9.518,6.45,10.689c4.733,1.17,9.518-1.718,10.689-6.45c0.787-3.183,1.534-6.339,2.238-9.446\n        c9.114-40.635-6.622-88.592-37.718-114.736c-16.942-14.251-37.574-20.273-68.03-20.273c-4.875,0-8.828,3.952-8.828,8.828\n        s3.952,8.828,8.828,8.828C399.8,78.694,416.45,83.554,429.848,94.824z\"/>\n    </g>\n  </svg>\n);\n\nexport const Diamond = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{enableBackground: 'new 0 0 512 512'}} width=\"1em\" height=\"1em\">\n    <g>\n      <polygon style={{fill:'#D71E00'}} points=\"256,0 45.714,256 256,512 466.286,256 \t\"/>\n      <path style={{fill:'#B21606'}} d=\"M248.872,448.656c-3.162,3.937-2.533,9.692,1.404,12.853c3.937,3.162,9.692,2.533,12.853-1.404\n        l64-79.698c3.162-3.937,2.533-9.692-1.404-12.853c-3.937-3.162-9.692-2.533-12.853,1.404L248.872,448.656z\"/>\n    </g>\n  </svg>\n);\n\nexport const Club = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 511.998 511.998\" style={{enableBackground: 'new 0 0 511.998 511.998'}} width=\"1em\" height=\"1em\">\n    <g>\n      <path d=\"M419.381,199.229c-26.651-12.378-51.541-12.674-74.177-7.186c18.441-21.827,29.058-50.472,27.396-81.642\n        C369.438,51,320.017,2.36,260.58,0.087c-66.578-2.542-121.353,50.67-121.353,116.682c0,28.699,10.393,54.937,27.567,75.273\n        c-22.636-5.488-47.526-5.192-74.177,7.186c-41.023,19.061-69.569,59.401-70.153,104.628\n        c-0.835,65.204,51.757,118.317,116.763,118.317c31.412,0,59.859-12.459,80.842-32.633v34.403c0,16.501-4.303,32.714-12.495,47.041\n        l-15.755,27.576c-3.422,5.991,0.907,13.438,7.797,13.438h112.766c6.899,0,11.219-7.446,7.797-13.438l-15.755-27.576\n        c-8.183-14.327-12.495-30.54-12.495-47.041V389.54c20.992,20.175,49.439,32.633,80.842,32.633\n        c65.006,0,117.607-53.113,116.763-118.317C488.95,258.629,460.403,218.289,419.381,199.229\"/>\n      <path style={{fill:'#2A2D33'}} d=\"M423.915,355.877c-13.621,13.805-31.752,21.385-51.142,21.385c-4.961,0-8.982,4.022-8.982,8.982\n        c0,4.961,4.022,8.982,8.982,8.982c24.196,0,46.934-9.506,63.927-26.729c16.991-17.2,26.197-40.066,25.888-64.288\n        c-0.063-4.96-4.136-8.93-9.096-8.867c-4.96,0.063-8.93,4.136-8.867,9.096C444.872,323.859,437.529,342.095,423.915,355.877z\"/>\n    </g>\n  </svg>  \n);\n\nexport const ChangePlayers = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{enableBackground: 'new 0 0 512 512'}} width=\"1em\" height=\"1em\">\n    <g>\n      <g>\n        <path d=\"M170.256,403.875c10.65-12.234,17.122-28.196,17.122-45.652c0-38.393-31.234-69.627-69.627-69.627\n          c-14.451,0-27.886,4.428-39.024,11.994c-1.632-10.049-2.463-20.254-2.463-30.537c0-49.249,18.842-95.868,53.054-131.273\n          c25.408-26.294,57.27-44.329,92.103-52.568l-23.142,27.868l23.133,19.21l59.366-71.49L201.539,17.43l-14.69,26.236l24.912,13.95\n          c-39.327,9.833-75.273,30.476-104.065,60.27c-39.659,41.041-61.5,95.081-61.5,152.168c0,20.2,2.752,40.155,8.17,59.414\n          c-3.996,8.772-6.241,18.504-6.241,28.756c0,17.491,6.497,33.483,17.185,45.726c-37.719,14.016-64.668,50.375-64.668,92.914v15.034\n          h234.473v-15.034C235.117,454.25,208.078,417.838,170.256,403.875z M117.752,318.665c21.813,0,39.558,17.746,39.558,39.558\n          s-17.746,39.558-39.559,39.558c-21.812,0-39.557-17.746-39.557-39.558S95.94,318.665,117.752,318.665z M32.362,481.828\n          c6.879-30.85,34.471-53.977,67.363-53.977h36.311c32.892,0,60.484,23.128,67.363,53.977H32.362z\"/>\n      </g>\n    </g>\n    <g>\n      <g>\n        <path d=\"M511.357,208.266c0-42.611-27.04-79.025-64.86-92.988c10.65-12.233,17.122-28.196,17.122-45.652\n          C463.619,31.234,432.385,0,393.992,0c-38.393,0-69.627,31.234-69.627,69.626c0,17.491,6.497,33.483,17.186,45.726\n          c-37.719,14.016-64.667,50.375-64.667,92.915v15.034h171.669c3.701,14.892,5.576,30.234,5.576,45.751\n          c0,45.405-16.341,89.291-46.014,123.576c-21.289,24.598-48.406,43.143-78.51,54.073l19.818-31.008l-25.335-16.193l-50.044,78.3\n          L358.173,512l11.325-27.855l-25.967-10.556c33.429-12.822,63.523-33.788,87.321-61.284\n          c34.401-39.748,53.347-90.623,53.347-143.254c0-15.46-1.611-30.777-4.793-45.751h31.952V208.266z M393.992,30.069\n          c21.813,0,39.558,17.746,39.558,39.557c0,21.813-17.746,39.558-39.558,39.558s-39.558-17.746-39.558-39.558\n          C354.434,47.814,372.179,30.069,393.992,30.069z M308.603,193.232c6.879-30.851,34.471-53.978,67.363-53.978h36.311\n          c32.892,0,60.484,23.128,67.363,53.978H308.603z\"/>\n      </g>\n    </g>\n    <g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n  </svg>\n);\n","import React from 'react';\nimport { Row, Col } from 'antd';\nimport { TrophyTwoTone } from '@ant-design/icons';\nimport { cardsRenderer } from './renderers';\n\nconst MobileTable = (props) => {\n  const {\n    dataSource: rounds,\n    players,\n    currentRound,\n    leagueScores,\n    gameID,\n  } = props;\n\n  // const onDragEnd = (fromIndex, toIndex) => {\n  //   console.log(\"onDragEnd\");\n  // };\n\n  return (\n    <div className=\"game-table\">\n      <h3 className=\"game-header\">Game {gameID}</h3>\n      <Row gutter={1} className=\"table-header\" style={{ marginBottom: 1 }}>\n        <Col span={4}>\n          <div className=\"table-cell\">round</div>\n        </Col>\n        {getTableHeaders(players)}\n      </Row>\n\n      {rounds.map((round, i) => (\n        <Row\n          gutter={1}\n          className={`table-row ${\n            currentRound - 1 === i ? 'current-round' : ''\n          } ${round.fell ? 'round-fell' : ''}`}\n          key={i}\n        >\n          <Col span={4}>\n            <div className=\"table-cell\">\n              {i + 1}{' '}\n              {round.factor > 1 && (\n                <span className=\"round-factor\">{`x${round.factor}`}</span>\n              )}\n            </div>\n          </Col>\n          {getRoundCol(players, round)}\n        </Row>\n      ))}\n\n      <Row gutter={1} className={`table-row`}>\n        <Col span={4}>\n          <div className=\"table-cell\">\n            <TrophyTwoTone twoToneColor=\"#52c41a\" />\n          </div>\n        </Col>\n        {getLeagueScoresCol(players, leagueScores)}\n      </Row>\n    </div>\n  );\n};\n\nexport default MobileTable;\n\n///////////////////////////\n//\n// helpers\n//\n///////////////////////////\n\nexport const getTableHeaders = (players) =>\n  players.map(({ index: playerIndex, playerName }) => (\n    <Col key={playerIndex} span={5}>\n      <div className=\"table-cell\">{playerName}</div>\n    </Col>\n  ));\n\nconst getRoundCol = (players, roundData) =>\n  players.map(({ index: playerIndex }) => (\n    <Col span={5} key={playerIndex}>\n      <div\n        className={`table-cell score-cell ${\n          roundData[`bid${playerIndex}`] !== roundData[`won${playerIndex}`]\n            ? 'fell'\n            : ''\n        } ${playerIndex === roundData.highestBidder ? 'highest-bidder' : ''}`}\n      >\n        {roundData[`aggregateScore${playerIndex}`]}\n        {playerIndex === roundData.highestBidder && (\n          <span className=\"trump\">{cardsRenderer(roundData.trump)}</span>\n        )}\n      </div>\n    </Col>\n  ));\n\nconst getLeagueScoresCol = (players, leagueScores) =>\n  players.map(({ index: playerIndex }) => (\n    <Col span={5} key={playerIndex}>\n      <div className={`table-cell`}>\n        {leagueScores[`leagueScore${playerIndex}`] !== ''\n          ? leagueScores[`leagueScore${playerIndex}`]\n          : '-'}\n      </div>\n    </Col>\n  ));\n","import React from 'react';\nimport Icon from '@ant-design/icons';\nimport { Spade, Hart, Diamond, Club } from '../cards/Icons';\nimport { CARDS } from '../../constants/cards';\n\nexport const cardsRenderer = (text) => {\n  switch (text) {\n    case CARDS.SPADE:\n      return <Icon component={Spade} />;\n    case CARDS.HART:\n      return <Icon component={Hart} />;\n    case CARDS.DIAMOND:\n      return <Icon component={Diamond} />;\n    case CARDS.CLUB:\n      return <Icon component={Club} />;\n    case CARDS.NT:\n      return 'NT';\n  }\n};\n","import React, { Component } from 'react';\nimport { Button, Modal } from 'antd';\nimport Icon, { QuestionOutlined } from '@ant-design/icons';\nimport { Spade, Hart, Diamond, Club } from './Icons';\nimport './Modal.scss';\n\nclass CardsModal extends Component {\n  state = { visible: false };\n\n  componentDidUpdate(prevProp) {\n    if (\n      prevProp.visible !== this.props.visible &&\n      this.props.visible !== this.state.visible\n    ) {\n      this.setState({\n        visible: this.props.visible,\n      });\n    }\n  }\n\n  showModal = () => {\n    this.setState({\n      visible: true,\n    });\n  };\n\n  handleCancel = () => {\n    this.setState({\n      visible: false,\n    });\n  };\n\n  onTrumpSelect(value) {\n    this.props.onChange(value);\n    this.setState({\n      visible: false,\n    });\n  }\n\n  trumpIconMap = {\n    SPADE: Spade,\n    HART: Hart,\n    DIAMOND: Diamond,\n    CLUB: Club,\n    NT: 'NT',\n  };\n\n  render() {\n    const { trump, disabled } = this.props;\n\n    return (\n      <div className=\"cards-modal\">\n        trump\n        <Button\n          ghost\n          className=\"card-btn\"\n          onClick={this.showModal}\n          disabled={disabled}\n        >\n          {trump ? (\n            trump === 'NT' ? (\n              'NT'\n            ) : (\n              <Icon component={this.trumpIconMap[trump]} />\n            )\n          ) : (\n            <QuestionOutlined />\n          )}\n        </Button>\n        <Modal\n          footer={null}\n          visible={this.state.visible}\n          onCancel={this.handleCancel}\n          className=\"cards-modal-dialog\"\n        >\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'SPADE')}\n          >\n            <Icon component={Spade} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'HART')}\n          >\n            <Icon component={Hart} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'DIAMOND')}\n          >\n            <Icon component={Diamond} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'CLUB')}\n          >\n            <Icon component={Club} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'NT')}\n          >\n            NT\n          </Button>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nexport default CardsModal;\n","import React, { Component } from 'react';\nimport { Button } from 'antd';\nimport './Pad.scss';\n\nexport default class NumbersPad extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      showMore: false,\n    };\n\n    this.toggleMore = this.toggleMore.bind(this);\n    this.onBtnClick = this.onBtnClick.bind(this);\n  }\n\n  toggleMore() {\n    this.setState({\n      showMore: !this.state.showMore,\n    });\n  }\n\n  onBtnClick(e) {\n    this.props.onSelect(e.target.textContent * 1);\n  }\n\n  render() {\n    const { disabled } = this.props;\n    const btnSize = 'default';\n    const { showMore } = this.state;\n\n    return (\n      <div>\n        <div className=\"dial-pad\">\n          {!showMore ? this.getButtons(0, 10) : this.getButtons(10, 4)}\n          <Button\n            size={btnSize}\n            onClick={this.toggleMore}\n            className=\"more-less-btn\"\n            disabled={disabled}\n          >\n            {!showMore ? 'More...' : 'Less...'}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  getButtons = (baseNum, amount) => {\n    const { disabled, disabledNumber } = this.props;\n    const btnSize = 'default';\n\n    return Array(amount)\n      .fill(baseNum)\n      .map((num, i) => (\n        <Button\n          key={i}\n          onClick={this.onBtnClick}\n          size={btnSize}\n          disabled={disabled || disabledNumber === i + num}\n        >\n          {i + num}\n        </Button>\n      ));\n  };\n}\n","import React, { Component } from 'react';\n\nexport const CSS_TRANSITIONS = {\n  FADE_IN: 'fade-in',\n  SLIDE_UP: 'slide-up'\n}\n\nexport default class Css extends Component {\n  componentDidMount() {\n    const type = this.props.type;\n    this.div.classList.add(type);\n    setTimeout(() => this.div.classList.remove(type), 400);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.children !== this.props.children) {\n      const type = this.props.type;\n      this.div.classList.add(type);\n      setTimeout(() => this.div.classList.remove(type), 400);\n    }\n  }\n  render() {\n    return (\n      <div\n        className={''}\n        ref={(el) => this.div = el}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}","import React from 'react';\nimport './Pad.css';\nimport Css, { CSS_TRANSITIONS } from '../transition/Css';\n\nconst PlayerPad = (props) => {\n  const { name, bid, won, score } = props;\n\n  return (\n    <div className=\"player-pad\">\n      <div className=\"pad-name\">\n        {name}&nbsp;\n        {score !== undefined &&\n          <span className=\"pad-score\">\n            [<Css type={CSS_TRANSITIONS.SLIDE_UP}>{score}</Css>]\n        </span>}\n      </div>\n\n      <div className=\"pad-bid-won\">\n        Bid: {typeof bid === 'number' ? bid : ' '} Won: {won}\n      </div>\n    </div>\n  );\n};\n\nexport default PlayerPad;","import React from 'react';\nimport './TwoWayArrow.css';\n\nexport const TWO_WAY_ARROW_DIRECTION = {\n  TOP: 'top',\n  BOTTOM: 'bottom'\n};\n\n// TODO: add option for horizontal arrow \n// https://codepen.io/hakimel/pen/gfIsk \n// https://codepen.io/Sloebel/pen/MdLKdY\n\nconst TwoWayArrow = (props) => {\n  return (\n    <div className={`arrow-indicator ${props.direction || ''}`}>\n      <span><i></i><i></i></span>\n      <i></i>\n      <span><i></i><i></i></span>\n    </div>\n  )\n};\n\nexport default TwoWayArrow;","import React, { useCallback } from 'react';\nimport './PlayCard.scss';\n\nexport interface IPlayCardProps {\n  card: string;\n  preSelected: boolean;\n  thrown: boolean;\n  disabled: boolean;\n  onCardClick: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n}\n\nconst PlayCard = (props: IPlayCardProps) => {\n  const { card, preSelected, thrown, onCardClick, disabled } = props;\n\n  const clickHandler = useCallback(\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      if (!disabled) {\n        onCardClick(event);\n      }\n    },\n    [onCardClick, disabled]\n  );\n\n  return (\n    <div\n      className={`play-card ${preSelected ? 'pre-selected' : ''} ${\n        thrown ? 'thrown' : ''\n      } ${disabled ? 'disabled' : ''}`}\n      onClick={clickHandler}\n    >\n      <img src={require(`../../images/playCards/${card}.svg`)} />\n    </div>\n  );\n};\n\nexport default PlayCard;\n","import React, { useState, useEffect } from 'react';\nimport './ThrownCard.scss';\n\nexport type ThrownCardType = 'top' | 'left' | 'right' | 'bottom';\n\nexport interface IThrownCardProps {\n  card?: string;\n  thrownType: ThrownCardType;\n  from?: { top: number; left: number };\n  to: { top: number; left: number };\n  hasWinner?: boolean;\n}\n\nconst ThrownCard = (props: IThrownCardProps) => {\n  const { card, thrownType, from, to, hasWinner } = props;\n  const [style, setStyle] = useState(from ? from : to);\n\n  useEffect(() => {\n    setStyle(to);\n  }, [to]);\n\n  return (\n    <div\n      className={`thrown-card ${thrownType} ${hasWinner ? 'has-winner' : ''}`}\n      style={{ ...style }}\n    >\n      {card && (\n        <img\n          src={require(`../../images/playCards/${card}.svg`)}\n          style={{ width: '90px' }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ThrownCard;\n","import React, { Component } from 'react';\r\nimport { Radio, Switch, Badge, Row, Col, Modal, message, Button } from 'antd';\r\nimport { SoundOutlined } from '@ant-design/icons';\r\nimport Icon from '@ant-design/icons';\r\nimport CardsModal from '../../common/cards/Modal';\r\nimport { ChangePlayers } from '../../common/cards/Icons';\r\nimport NumbersPad from '../../common/numbers/Pad';\r\nimport PlayerPad from '../../common/player/Pad';\r\nimport { INPUT_MODE } from '../../constants/states';\r\nimport Dialog from '../../dialogs/Dialog';\r\nimport { Dialogs } from '../../constants/dialogs';\r\nimport { PlayersContext } from '../GameTab';\r\nimport Css, { CSS_TRANSITIONS } from '../../common/transition/Css';\r\nimport TwoWayArrow, {\r\n  TWO_WAY_ARROW_DIRECTION,\r\n} from '../../common/twoWayArrow/TwoWayArrow';\r\nimport PlayCard from '../PlayCard/PlayCard';\r\nimport ThrownCard from '../ThrownCard/ThrownCard';\r\nimport {\r\n  nextPlayerIndex,\r\n  uniqueHand,\r\n  getFromToCalc,\r\n  getToWinnerCalc,\r\n} from '../../utils/game-utils';\r\nimport playerTurn from '../../assets/sounds/playerTurn.mp3';\r\nimport './GamePad.scss';\r\n\r\nconst confirm = Modal.confirm;\r\nmessage.config({\r\n  top: 100,\r\n  maxCount: 3,\r\n});\r\n\r\nclass GamePad extends Component {\r\n  audio = new Audio(playerTurn);\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      selectedPlayer: undefined,\r\n      reorderPlayersDialogVisible: false,\r\n      trumpModalVisible: false,\r\n      preSelectedCard: undefined,\r\n      thrownCard: undefined,\r\n      thrownCards: [],\r\n      handCardType: undefined,\r\n      isMute: false,\r\n    };\r\n\r\n    this.handleSwitchMode = this.handleSwitchMode.bind(this);\r\n    this.handleCardsPadChange = this.handleCardsPadChange.bind(this);\r\n    this.handleNumberSelect = this.handleNumberSelect.bind(this);\r\n    this.setSelectedPlayer = this.setSelectedPlayer.bind(this);\r\n    this.showChangeHighestBidderConfirm = this.showChangeHighestBidderConfirm.bind(\r\n      this\r\n    );\r\n    this.showChangePlayerDialog = this.showChangePlayerDialog.bind(this);\r\n    this.handleReorderPlayersAfterClose = this.handleReorderPlayersAfterClose.bind(\r\n      this\r\n    );\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.gameMode === 'remote') {\r\n      const { devicePlayerIndex, ownCardsState } = this.props;\r\n      const currentRoundData = this.getRoundData();\r\n      const { handsState, currentHand, inputMode } = currentRoundData;\r\n\r\n      const {\r\n        allRounds: prevAllRounds,\r\n        currentRound: prevCurrentRound,\r\n      } = prevProps;\r\n      const prevCurrentRoundData =\r\n        prevAllRounds.length && prevAllRounds[prevCurrentRound - 1];\r\n\r\n      if (\r\n        prevCurrentRoundData.inputMode !== inputMode &&\r\n        inputMode === INPUT_MODE.WON\r\n      ) {\r\n        this.setState({\r\n          selectedPlayer: currentRoundData.highestBidder,\r\n        });\r\n\r\n        if (currentRoundData.highestBidder === devicePlayerIndex) {\r\n          this.playAudio();\r\n        }\r\n      }\r\n\r\n      if (\r\n        prevCurrentRoundData.currentBidder !== currentRoundData.currentBidder &&\r\n        inputMode === INPUT_MODE.BID\r\n      ) {\r\n        this.setState({\r\n          selectedPlayer: currentRoundData.currentBidder,\r\n        });\r\n      }\r\n\r\n      const prevHandsState = prevCurrentRoundData.handsState;\r\n      if (prevHandsState !== handsState) {\r\n        const stateToUpdate = {};\r\n        const thrown =\r\n          handsState &&\r\n          handsState[currentHand] &&\r\n          (handsState[currentHand]['thrownCards'] || []).find(\r\n            (thrown) => thrown.player === devicePlayerIndex\r\n          );\r\n\r\n        if (thrown && thrown.card && (ownCardsState || []).length > 1) {\r\n          stateToUpdate.thrownCard = thrown.card;\r\n        } else {\r\n          stateToUpdate.thrownCard = undefined;\r\n        }\r\n\r\n        if (handsState) {\r\n          const thrownCards = handsState[currentHand]['thrownCards']\r\n            ? uniqueHand([\r\n                ...this.state.thrownCards,\r\n                ...handsState[currentHand]['thrownCards'],\r\n              ])\r\n            : [];\r\n\r\n          stateToUpdate.thrownCards = thrownCards;\r\n          stateToUpdate.selectedPlayer = handsState[currentHand]['turnOf'];\r\n          stateToUpdate.handCardType =\r\n            thrownCards[0] && thrownCards[0].card.split('-')[1];\r\n        } else {\r\n          stateToUpdate.thrownCards = [];\r\n          stateToUpdate.selectedPlayer = currentRoundData.highestBidder;\r\n          stateToUpdate.handCardType = undefined;\r\n        }\r\n\r\n        if (\r\n          inputMode === INPUT_MODE.WON &&\r\n          stateToUpdate.selectedPlayer === devicePlayerIndex\r\n        ) {\r\n          this.playAudio();\r\n        }\r\n\r\n        this.setState(stateToUpdate);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleSwitchMode(checked) {\r\n    const { onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { trump, segment, handsState } = roundData;\r\n\r\n    if (segment === 0) {\r\n      return message.warning('Total Bids are 13?!?!');\r\n    }\r\n\r\n    if (this.state.thrownCard || handsState) {\r\n      return message.warning('Can`t change bids after a card was thrown');\r\n    }\r\n\r\n    const everyoneBid = this.isAllBids(roundData);\r\n\r\n    if (trump && everyoneBid) {\r\n      this.setState({\r\n        selectedPlayer: undefined,\r\n      });\r\n\r\n      onChange({\r\n        ...roundData,\r\n        inputMode: checked ? INPUT_MODE.WON : INPUT_MODE.BID,\r\n      });\r\n    } else {\r\n      message.warning('Bids are not completed');\r\n    }\r\n  }\r\n\r\n  setSelectedPlayer(e) {\r\n    if (this.isAllowedToSelectPlayer() && e.target.type === 'radio') {\r\n      this.setState({\r\n        selectedPlayer: e.target.value,\r\n      });\r\n    }\r\n  }\r\n\r\n  isAllowedToSelectPlayer() {\r\n    const { gameMode } = this.props;\r\n    const roundData = this.getRoundData();\r\n\r\n    if (gameMode === 'remote') {\r\n      const { inputMode, highestBidder } = roundData;\r\n\r\n      return inputMode === INPUT_MODE.WON || typeof highestBidder === 'number'\r\n        ? false\r\n        : true;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  handleCardsPadChange(trump) {\r\n    const { onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode } = roundData;\r\n\r\n    this.setState({ trumpModalVisible: false });\r\n\r\n    if (inputMode !== INPUT_MODE.WON) {\r\n      onChange({ ...roundData, trump });\r\n    }\r\n  }\r\n\r\n  handleNumberSelect(num) {\r\n    const { players, currentRound, onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode, highestBidder } = roundData;\r\n\r\n    if (inputMode === INPUT_MODE.BID && this.props.gameMode === 'remote') {\r\n      return this.handleRemoteBidFlow(num);\r\n    }\r\n\r\n    const { selectedPlayer } = this.state;\r\n    const mode = inputMode === INPUT_MODE.BID ? 'bid' : 'won';\r\n    const prop = mode + selectedPlayer;\r\n\r\n    const newRoundData = {};\r\n\r\n    if (inputMode === INPUT_MODE.BID) {\r\n      if (currentRound === 13) {\r\n        if (\r\n          (num >= 5 && !roundData[`bid${highestBidder}`]) ||\r\n          roundData[`bid${highestBidder}`] < num\r\n        ) {\r\n          newRoundData.highestBidder = selectedPlayer;\r\n        }\r\n      } else {\r\n        const nextPlayer = this.getNextPlayer(selectedPlayer, players);\r\n        const nextPlayerBid = roundData[`bid${nextPlayer}`];\r\n        const beforePlayerBid = this.getBeforePlayerBid(selectedPlayer, players);\r\n\r\n        if (\r\n          nextPlayerBid === undefined || nextPlayerBid === '' ||\r\n          nextPlayer === highestBidder\r\n        ) {\r\n          // validate first bid is more then 5\r\n          if (\r\n            (!highestBidder && highestBidder !== 0) ||\r\n            highestBidder === selectedPlayer\r\n          ) {\r\n            if (num < 5) {\r\n              return message.warning('First Bid should be more then 5');\r\n            } else {\r\n              newRoundData.highestBidder = selectedPlayer;\r\n            }\r\n          } else if (num >= 5) {\r\n            this.showChangeHighestBidderConfirm(\r\n              onChange,\r\n              roundData,\r\n              prop,\r\n              num,\r\n              selectedPlayer,\r\n              players\r\n            );\r\n          } else if (\r\n           !beforePlayerBid && beforePlayerBid !== 0\r\n          ) {\r\n            return message.warning('The Bids are not in the right order!!');\r\n          }\r\n        } else {\r\n          return message.warning(\r\n            'The Next Player already Bid, Can not change bid'\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    newRoundData[prop] = num;\r\n    onChange({ ...roundData, ...newRoundData }, selectedPlayer);\r\n  }\r\n\r\n  calculateDisableNum() {\r\n    const { players } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { highestBidder, inputMode } = roundData;\r\n    const { selectedPlayer } = this.state;\r\n\r\n    if (typeof selectedPlayer !== 'number') return undefined;\r\n\r\n    if (inputMode !== INPUT_MODE.BID) return undefined;\r\n\r\n    if (this.getNextPlayer(selectedPlayer, players) !== highestBidder)\r\n      return undefined;\r\n\r\n    // get the list of players bided before\r\n    const beforePlayers = this.getBeforePlayers(selectedPlayer, players);\r\n\r\n    // loop through 3 players before selectedPlayer\r\n    // if all bid already return segment else return undefined\r\n\r\n    let bids = 0;\r\n\r\n    for (const player of beforePlayers) {\r\n      const aBid = roundData[`bid${player}`];\r\n      if (aBid === null) return undefined;\r\n\r\n      bids += aBid;\r\n    }\r\n\r\n    return 13 - bids;\r\n  }\r\n\r\n  showChangeHighestBidderConfirm(\r\n    onChange,\r\n    roundData,\r\n    prop,\r\n    num,\r\n    selectedPlayer,\r\n    players\r\n  ) {\r\n    confirm({\r\n      title: 'Change Highest Bidder?',\r\n      content: '(will reset the rest of the bids)',\r\n      okType: 'danger',\r\n      onOk() {\r\n        onChange(\r\n          {\r\n            ...roundData,\r\n            bid0: '',\r\n            bid1: '',\r\n            bid2: '',\r\n            bid3: '',\r\n            [prop]: num,\r\n            highestBidder: selectedPlayer,\r\n          },\r\n          selectedPlayer\r\n        );\r\n      },\r\n      onCancel: () => {\r\n        const beforePlayerBid = this.getBeforePlayerBid(selectedPlayer, players);\r\n\r\n        if (beforePlayerBid || beforePlayerBid === 0) {\r\n          onChange({ ...roundData, [prop]: num }, selectedPlayer);\r\n        } else {\r\n          message.warning('The Bids are not in the right order!!');\r\n          onChange({ ...roundData }, selectedPlayer);\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  getNextPlayer = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    const nextIndex = index + 1 > 3 ? index + 1 - 4 : index + 1;\r\n\r\n    return players[nextIndex].index;\r\n  };\r\n\r\n  getBeforePlayer = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    const beforeIndex = index - 1 > -1 ? index - 1 : index - 1 + 4;\r\n\r\n    return players[beforeIndex].index;\r\n  };\r\n\r\n  getBeforePlayerBid = (selectedPlayer, players) => {\r\n    const roundData = this.getRoundData();\r\n    \r\n    return roundData[`bid${this.getBeforePlayer(selectedPlayer, players)}`];\r\n  }\r\n\r\n  getBeforePlayers = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    return players\r\n      .filter((player) => index !== player.index)\r\n      .map((player) => player.index);\r\n  };\r\n\r\n  // getAfterPlayers = (selectedPlayer) => [1, 2, 3].map(afterPlayer => selectedPlayer + afterPlayer > 4 ? selectedPlayer + afterPlayer - 4 : selectedPlayer + afterPlayer);\r\n\r\n  getPlayerAggregateScore = (roundsData, roundIndex, playerIndex) => {\r\n    const roundData = roundsData[roundIndex];\r\n\r\n    if (!roundData) {\r\n      return 0;\r\n    }\r\n\r\n    const aggregateScore = roundData[`aggregateScore${playerIndex}`];\r\n    // if round.fell == true, look for round before\r\n    if (typeof aggregateScore === 'number' && !roundData.fell) {\r\n      return aggregateScore;\r\n    }\r\n\r\n    return this.getPlayerAggregateScore(\r\n      roundsData,\r\n      roundIndex - 1,\r\n      playerIndex\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { devicePlayerIndex, gameMode } = this.props;\r\n    const currentRoundData = this.getRoundData();\r\n    const {\r\n      round,\r\n      check,\r\n      trump,\r\n      segment,\r\n      inputMode,\r\n      fell,\r\n      factor,\r\n    } = currentRoundData;\r\n    const {\r\n      selectedPlayer,\r\n      reorderPlayersDialogVisible,\r\n      trumpModalVisible,\r\n      isMute,\r\n    } = this.state;\r\n    const isAllBids = this.isAllBids(currentRoundData);\r\n    const playersButtons = this.getPlayersButtons();\r\n    const isRemote = gameMode === 'remote';\r\n\r\n    return (\r\n      <Radio.Group\r\n        buttonStyle=\"solid\"\r\n        className={`game-pad-container ${fell ? 'round-fell' : ''}`}\r\n        onChange={this.setSelectedPlayer}\r\n        value={selectedPlayer}\r\n      >\r\n        <h3>Round: {round}</h3>\r\n        <Row type=\"flex\" justify=\"space-around\">\r\n          <Col>\r\n            <Switch\r\n              onChange={this.handleSwitchMode}\r\n              checkedChildren={isRemote ? ' Play ' : ' Won '}\r\n              unCheckedChildren=\" Bid \"\r\n              checked={inputMode === INPUT_MODE.WON}\r\n            />\r\n            <div className=\"segment\">\r\n              Bids:{' '}\r\n              <Css type={CSS_TRANSITIONS.FADE_IN}>\r\n                {!isAllBids ? `${segment && 13 + segment}` : segment}\r\n              </Css>\r\n              <TwoWayArrow\r\n                direction={\r\n                  isAllBids &&\r\n                  (segment > 0\r\n                    ? TWO_WAY_ARROW_DIRECTION.TOP\r\n                    : TWO_WAY_ARROW_DIRECTION.BOTTOM)\r\n                }\r\n              />\r\n            </div>\r\n            <div>Check: {check ? 'yes' : 'no'}</div>\r\n            <Css type={CSS_TRANSITIONS.FADE_IN}>\r\n              {fell ? <div className=\"fell-indicator\">round fell</div> : ''}\r\n            </Css>\r\n            {!fell && factor > 1 && (\r\n              <div className=\"factor-indicator\">{`x${factor}`}</div>\r\n            )}\r\n            {isRemote && (\r\n              <Button\r\n                className={`toggle-sound-btn ${isMute ? 'is-mute' : ''}`}\r\n                type=\"link\"\r\n                icon={<SoundOutlined />}\r\n                onClick={this.toggleMute}\r\n              />\r\n            )}\r\n          </Col>\r\n          <Col className=\"item item2\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex + 1)]}\r\n          </Col>\r\n          <Col>\r\n            <CardsModal\r\n              trump={trump}\r\n              onChange={this.handleCardsPadChange}\r\n              disabled={inputMode === INPUT_MODE.WON}\r\n              visible={trumpModalVisible}\r\n            />\r\n          </Col>\r\n        </Row>\r\n\r\n        <div\r\n          className=\"thrown-cards-marker\"\r\n          ref={(el) => (this.cardsMarkerRef = el)}\r\n        ></div>\r\n\r\n        <Row type=\"flex\" justify=\"space-around\">\r\n          <Col className=\"item item4\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex)]}\r\n          </Col>\r\n          <Col style={{ zIndex: 1 }}>\r\n            {isRemote && inputMode === INPUT_MODE.WON ? (\r\n              <div className=\"number-pad-placement\"></div>\r\n            ) : (\r\n              <NumbersPad\r\n                disabledNumber={this.calculateDisableNum()}\r\n                onSelect={this.handleNumberSelect}\r\n                disabled={this.isNumberPadDisabled()}\r\n              />\r\n            )}\r\n          </Col>\r\n          <Col className=\"item item6\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex + 2)]}\r\n          </Col>\r\n        </Row>\r\n        <Row type=\"flex\" justify=\"center\" style={{ position: 'relative' }}>\r\n          <Col className=\"item item8\">{playersButtons[devicePlayerIndex]}</Col>\r\n          {!isRemote && round === 1 && inputMode === INPUT_MODE.BID && (\r\n            <div>\r\n              <Button\r\n                type=\"dashed\"\r\n                shape=\"circle\"\r\n                className=\"change-players-btn\"\r\n                onClick={this.showChangePlayerDialog}\r\n              >\r\n                <Icon component={ChangePlayers} />\r\n              </Button>\r\n              {reorderPlayersDialogVisible && (\r\n                <PlayersContext.Consumer>\r\n                  {({ players, reorderPlayers }) => (\r\n                    <Dialog\r\n                      dialog={Dialogs.REORDER_PLAYERS}\r\n                      dialogProps={{\r\n                        onOk: reorderPlayers,\r\n                        onAfterClose: this.handleReorderPlayersAfterClose,\r\n                        visible: reorderPlayersDialogVisible,\r\n                        players,\r\n                      }}\r\n                    />\r\n                  )}\r\n                </PlayersContext.Consumer>\r\n              )}\r\n            </div>\r\n          )}\r\n        </Row>\r\n        {isRemote && this.getThrownCardsPlacement()}\r\n        {this.getCards()}\r\n      </Radio.Group>\r\n    );\r\n  }\r\n\r\n  getPlayersButtons = () => {\r\n    const { allRounds, currentRound, players } = this.props;\r\n    const currentRoundData = allRounds.length && allRounds[currentRound - 1];\r\n    const highestBidder = currentRoundData.highestBidder;\r\n\r\n    return players.map(({ index: playerIndex, playerName }, i) => {\r\n      return (\r\n        <Badge key={playerIndex} dot={highestBidder === playerIndex}>\r\n          <Radio.Button value={playerIndex}>\r\n            <PlayerPad\r\n              name={playerName}\r\n              bid={currentRoundData[`bid${playerIndex}`]}\r\n              won={currentRoundData[`won${playerIndex}`]}\r\n              score={this.getPlayerAggregateScore(\r\n                allRounds,\r\n                currentRound - 1,\r\n                playerIndex\r\n              )}\r\n            />\r\n          </Radio.Button>\r\n        </Badge>\r\n      );\r\n    });\r\n  };\r\n\r\n  showChangePlayerDialog() {\r\n    this.setState({\r\n      reorderPlayersDialogVisible: true,\r\n    });\r\n  }\r\n\r\n  handleReorderPlayersAfterClose() {\r\n    this.setState({\r\n      reorderPlayersDialogVisible: false,\r\n    });\r\n  }\r\n\r\n  handleRemoteBidFlow(num) {\r\n    const { devicePlayerIndex, onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { highestBidder } = roundData;\r\n    const { selectedPlayer } = this.state;\r\n    const stateToUpdate = {};\r\n\r\n    if (typeof highestBidder !== 'number') {\r\n      if (num < 5) {\r\n        return message.warning('First Bid should be more then 5');\r\n      } else {\r\n        stateToUpdate.highestBidder = selectedPlayer;\r\n        stateToUpdate[`bid${selectedPlayer}`] = num;\r\n        stateToUpdate.currentBidder = nextPlayerIndex(selectedPlayer);\r\n\r\n        if (!roundData.trump) {\r\n          setTimeout(\r\n            () =>\r\n              this.setState({\r\n                trumpModalVisible: true,\r\n              }),\r\n            300\r\n          );\r\n        }\r\n      }\r\n    } else if (devicePlayerIndex === selectedPlayer) {\r\n      stateToUpdate[`bid${selectedPlayer}`] = num;\r\n      const nextPlayer = nextPlayerIndex(selectedPlayer);\r\n\r\n      if (nextPlayer === highestBidder) {\r\n        stateToUpdate.currentBidder = '';\r\n\r\n        setTimeout(() => this.handleSwitchMode(true), 1500);\r\n      } else {\r\n        stateToUpdate.currentBidder = nextPlayerIndex(selectedPlayer);\r\n      }\r\n    }\r\n\r\n    if (Object.keys(stateToUpdate).length) {\r\n      onChange({ ...roundData, ...stateToUpdate }, selectedPlayer);\r\n    }\r\n  }\r\n\r\n  getCards() {\r\n    const { ownCardsState, devicePlayerIndex } = this.props;\r\n    const {\r\n      preSelectedCard,\r\n      thrownCard,\r\n      handCardType,\r\n      selectedPlayer,\r\n    } = this.state;\r\n\r\n    if (ownCardsState) {\r\n      const hasCardType = Object.values(ownCardsState).some(\r\n        (card) => card.split('-')[1] === handCardType\r\n      );\r\n      const isDevicePlayer = devicePlayerIndex === selectedPlayer;\r\n\r\n      return (\r\n        <div className=\"cards-container\">\r\n          {Object.values(ownCardsState).map((card) => (\r\n            <PlayCard\r\n              key={card}\r\n              card={card}\r\n              preSelected={preSelectedCard === card}\r\n              thrown={thrownCard === card}\r\n              onCardClick={this.handleCardClick(card)}\r\n              disabled={\r\n                isDevicePlayer &&\r\n                hasCardType &&\r\n                card.split('-')[1] !== handCardType\r\n              }\r\n            />\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return '';\r\n  }\r\n\r\n  // TODO: memoize it\r\n  getThrownCardsPlacement() {\r\n    if (!this.cardsMarkerRef) {\r\n      return '';\r\n    }\r\n    const currentRoundData = this.getRoundData();\r\n    const { handsState, currentHand } = currentRoundData;\r\n    const handWinner = handsState && handsState[currentHand].handWinner;\r\n    const { thrownCards } = this.state;\r\n    const { devicePlayerIndex } = this.props;\r\n    const fn = nextPlayerIndex;\r\n\r\n    const playerOnPadMap = {\r\n      [devicePlayerIndex]: 'bottom',\r\n      [fn(devicePlayerIndex)]: 'left',\r\n      [fn(devicePlayerIndex + 1)]: 'top',\r\n      [fn(devicePlayerIndex + 2)]: 'right',\r\n    };\r\n\r\n    const toWinner =\r\n      handWinner !== undefined &&\r\n      this.getFromTo(playerOnPadMap[handWinner], true);\r\n\r\n    return (\r\n      <div className=\"hand-cards-container\">\r\n        {thrownCards.map((thrown) => {\r\n          const { from, to } =\r\n            toWinner || this.getFromTo(playerOnPadMap[thrown.player]);\r\n\r\n          return (\r\n            <ThrownCard\r\n              key={thrown.player}\r\n              thrownType={playerOnPadMap[thrown.player]}\r\n              card={thrown.card}\r\n              from={from}\r\n              to={to}\r\n              hasWinner={handWinner !== undefined}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleCardClick = (card) => (e) => {\r\n    const { preSelectedCard, selectedPlayer } = this.state;\r\n    const {\r\n      currentRound,\r\n      devicePlayerIndex,\r\n      onCardThrown,\r\n    } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode } = roundData;\r\n\r\n    if (inputMode === INPUT_MODE.WON && selectedPlayer === devicePlayerIndex) {\r\n      if (preSelectedCard === card) {\r\n        // throw card\r\n\r\n        // set the initial position of own thrown card\r\n        const top = e.currentTarget.offsetParent.offsetTop - 15;\r\n        const left = e.currentTarget.offsetLeft;\r\n        this.ownThrownCardInitPos = { top, left };\r\n\r\n        this.setState({\r\n          thrownCards: [\r\n            ...this.state.thrownCards,\r\n            {\r\n              player: selectedPlayer,\r\n              card,\r\n            },\r\n          ],\r\n        });\r\n\r\n        onCardThrown(card, selectedPlayer, currentRound, roundData.currentHand);\r\n\r\n        this.setState({\r\n          thrownCard: card,\r\n          // preSelectedCard: undefined,\r\n        });\r\n      } else {\r\n        this.setState({\r\n          preSelectedCard: card,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // calculate end position by thrownType\r\n  getFromTo(type, toWinner) {\r\n    const markerTop = this.cardsMarkerRef && this.cardsMarkerRef.offsetTop;\r\n    const markerWidth = this.cardsMarkerRef && this.cardsMarkerRef.offsetWidth;\r\n\r\n    if (toWinner) {\r\n      return getToWinnerCalc(type, markerTop, markerWidth);\r\n    }\r\n\r\n    return getFromToCalc(\r\n      type,\r\n      markerTop,\r\n      markerWidth,\r\n      this.ownThrownCardInitPos\r\n    );\r\n  }\r\n\r\n  // TODO: memoize it\r\n  isAllBids = (roundData) =>\r\n    Array(4)\r\n      .fill(1)\r\n      .every((_, i) => typeof roundData[`bid${i}`] === 'number');\r\n\r\n  getRoundData() {\r\n    const { allRounds, currentRound } = this.props;\r\n    return allRounds.length && allRounds[currentRound - 1];\r\n  }\r\n\r\n  playAudio() {\r\n    !this.state.isMute && this.audio.play();\r\n  }\r\n\r\n  isNumberPadDisabled() {\r\n    const { devicePlayerIndex, gameMode } = this.props;\r\n    const { selectedPlayer } = this.state;\r\n\r\n    return (\r\n      typeof selectedPlayer !== 'number' ||\r\n      (gameMode === 'remote' && devicePlayerIndex !== selectedPlayer)\r\n    );\r\n  }\r\n\r\n  toggleMute = () => {\r\n    this.setState({\r\n      isMute: !this.state.isMute,\r\n    });\r\n  };\r\n}\r\n\r\nexport default GamePad;\r\n","import { INPUT_MODE } from '../constants/states';\r\nimport { IPlayerScoresSummary, IPlayer } from './IPlayerModel';\r\nimport { CARDS } from '../constants/cards';\r\n\r\nexport type GameMode = 'local' | 'remote';\r\n\r\nexport enum GAME_STATUS {\r\n  ACTIVE = 'ACTIVE',\r\n  FINISHED = 'FINISHED',\r\n}\r\n\r\nexport interface IThrownCard {\r\n  card: string;\r\n  player: number;\r\n}\r\n\r\nexport interface IHandState {\r\n  handWinner?: number;\r\n  status: GAME_STATUS;\r\n  thrownCards: IThrownCard[];\r\n}\r\nexport interface IHandsState {\r\n  [handKey: number]: IHandState;\r\n}\r\n\r\nexport interface IBaseRoundData {\r\n  [index: string]: any;\r\n  segment: string | number;\r\n  totalBids: string | number;\r\n  trump: CARDS | string;\r\n  check: boolean;\r\n  factor: number;\r\n  fell: boolean;\r\n  highestBidder: string | number;\r\n  currentBidder?: number;\r\n  inputMode: INPUT_MODE;\r\n  score0: string | number;\r\n  score1: string | number;\r\n  score2: string | number;\r\n  score3: string | number;\r\n  aggregateScore0: string | number;\r\n  aggregateScore1: string | number;\r\n  aggregateScore2: string | number;\r\n  aggregateScore3: string | number;\r\n  bid0: string | number;\r\n  bid1: string | number;\r\n  bid2: string | number;\r\n  bid3: string | number;\r\n  won0: string | number;\r\n  won1: string | number;\r\n  won2: string | number;\r\n  won3: string | number;\r\n  currentHand?: number;\r\n}\r\n\r\nexport interface IRoundData extends IBaseRoundData {\r\n  round: number;\r\n  handsState?: IHandsState;  \r\n}\r\n\r\nexport interface IPlayerHand {\r\n  player: number;\r\n  hand: string;\r\n}\r\n\r\nexport interface ICardsPosition {\r\n  top: number;\r\n  left: number;\r\n}\r\n\r\nexport interface ICardsFromTo {\r\n  from?: ICardsPosition;\r\n  to: ICardsPosition;\r\n}\r\n\r\nexport interface IGameColumn {\r\n  playerName: string;\r\n  index: number;\r\n}\r\n\r\nexport type GameViewType = 'table' | 'panel';\r\n\r\nexport type LeagueScoreType =\r\n  | 'leagueScore0'\r\n  | 'leagueScore1'\r\n  | 'leagueScore2'\r\n  | 'leagueScore3';\r\nexport type LeagueScoreTypeMap = {\r\n  [key in LeagueScoreType]?: number;\r\n};\r\n\r\nexport type TotalScoreType =\r\n  | 'totalScore0'\r\n  | 'totalScore1'\r\n  | 'totalScore2'\r\n  | 'totalScore3';\r\nexport type TotalScoreTypeMap = {\r\n  [key in TotalScoreType]?: number;\r\n};\r\n\r\nexport interface IBaseGameData extends TotalScoreTypeMap {\r\n  [index: string]: any;\r\n  rounds: IRoundData[];\r\n  currentRound: number;\r\n  status?: GAME_STATUS;\r\n}\r\n\r\nexport interface ILeagueGameModel {\r\n  gameID: string;\r\n  gameMode?: GameMode;\r\n  playersOrder?: IPlayer[];\r\n  status?: GAME_STATUS;\r\n}\r\n\r\nexport interface IGameData extends IBaseGameData, ILeagueGameModel {\r\n  [index: string]: any;\r\n  gameID: string;\r\n  dealer?: string;\r\n  gameMode?: GameMode;\r\n  playersOrder?: IPlayer[];\r\n  ownCardsState?: string[];\r\n}\r\n\r\nexport interface IGamePlayersSummary {\r\n  [player: string]: IPlayerScoresSummary;\r\n}\r\n","import React, { Component } from 'react';\nimport { Button } from 'antd';\nimport { RightOutlined, LeftOutlined } from '@ant-design/icons';\nimport MobileTable from '../common/table/MobileTable';\nimport GamePad from './GamePad/GamePad';\nimport { hasTouch, addListener } from '../utils/Utils';\n\nexport default class GameMobileView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.carouselEl = React.createRef();\n    this.carouselSwipedRight = this.carouselSwipedRight.bind(this);\n    this.carouselSwipedLeft = this.carouselSwipedLeft.bind(this);\n  }\n\n  componentDidMount() {\n    if (hasTouch()) {\n      this.unListenSwipedLeft = addListener(\n        this.carouselEl,\n        'swiped-left',\n        this.carouselSwipedLeft\n      );\n      this.unListenSwipedRight = addListener(\n        this.carouselEl,\n        'swiped-right',\n        this.carouselSwipedRight\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    if (hasTouch()) {\n      this.unListenSwipedLeft();\n      this.unListenSwipedRight();\n    }\n  }\n\n  carouselSwipedLeft = () => {\n    const { currentView, onCurrentViewChange } = this.props;\n\n    if (currentView !== 'panel') {\n      onCurrentViewChange('panel');\n    } else {\n      this.carouselEl.classList.add('bounce-left');\n      setTimeout(() => this.carouselEl.classList.remove('bounce-left'), 400);\n    }\n  };\n\n  carouselSwipedRight() {\n    const { currentView, onCurrentViewChange } = this.props;\n\n    if (currentView !== 'table') {\n      onCurrentViewChange('table');\n    } else {\n      this.carouselEl.classList.add('bounce-right');\n      setTimeout(() => this.carouselEl.classList.remove('bounce-right'), 400);\n    }\n  }\n\n  nextRound = () => {\n    const { goToRound, currentRound } = this.props;\n    const round = Number(currentRound);\n\n    if (round < 13) {\n      goToRound && goToRound(round + 1);\n    }\n  };\n\n  toRoundBefore = () => {\n    const { goToRound, currentRound } = this.props;\n    const round = Number(currentRound);\n\n    if (round !== 1) {\n      goToRound && goToRound(round - 1);\n    }\n  };\n\n  render() {\n    const {\n      gameID,\n      gameMode,\n      ownCardsState,\n      currentView,\n      rounds,\n      playersColumns,\n      currentRound,\n      handleSave,\n      leagueScores,\n      devicePlayerIndex,\n      handleCardThrown,\n    } = this.props;\n\n    return (\n      <div\n        className={`game-mobile-view ${\n          gameMode === 'remote' ? 'mode-remote' : ''\n        }`}\n      >\n        <div className=\"my-carousel\" ref={(el) => (this.carouselEl = el)}>\n          <div className={`my-carousel-slides-container ${currentView}`}>\n            <div className=\"my-carousel-slide\">\n              <MobileTable\n                dataSource={rounds}\n                leagueScores={leagueScores}\n                players={playersColumns}\n                currentRound={currentRound}\n                gameID={gameID}\n              />\n            </div>\n            <div className=\"my-carousel-slide\">\n              <GamePad\n                gameMode={gameMode}\n                ownCardsState={ownCardsState}\n                onCardThrown={handleCardThrown}\n                currentRound={currentRound}\n                allRounds={rounds}\n                players={playersColumns}\n                devicePlayerIndex={devicePlayerIndex}\n                onChange={handleSave}\n              />\n            </div>\n          </div>\n        </div>\n        {this.showNavigation() && (\n          <div className=\"round-navigation\">\n            {currentRound !== 1 && (\n              <Button\n                type=\"primary\"\n                className=\"left\"\n                ghost\n                onClick={this.toRoundBefore}\n              >\n                <LeftOutlined />\n                {`Round ${currentRound - 1}`}\n              </Button>\n            )}\n\n            {currentRound !== 13 && (\n              <Button type=\"primary\" ghost onClick={this.nextRound}>\n                {`Round ${Number(currentRound) + 1}`}\n                <RightOutlined />\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  showNavigation() {\n    const { gameMode, ownCardsState, currentView } = this.props;\n\n    return (\n      gameMode !== 'remote' ||\n      (ownCardsState || []).length === 0 ||\n      currentView === 'table'\n    );\n  }\n}\n","export const GAME_DEFAULT_SCORES = [10, 7, 3, 1];","import { fire } from '../firebase';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport default class GameService {\r\n  // the request to set cards by player will happen only if current user is the dealer\r\n  // but if the data already exist it will not override it (by database rules)\r\n  public static setCardsToPlayers(\r\n    gameKey: string,\r\n    round: number,\r\n    cardsByPlayer: {\r\n      [key: string]: string[];\r\n    }\r\n  ) {\r\n    fire\r\n      .database()\r\n      .ref()\r\n      .child(`cardsByGame/${gameKey}/round${round}`)\r\n      .update(\r\n        {\r\n          cardsState: cardsByPlayer,\r\n        },\r\n        (error) => {\r\n          if (error) {\r\n            console.error('cards state probably already exists');\r\n          }\r\n        }\r\n      );\r\n  }\r\n\r\n  public static updateHandCardsState(\r\n    gameKey: string,\r\n    round: number,\r\n    cardIndex?: string\r\n  ) {\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    if (userId) {\r\n      fire\r\n        .database()\r\n        .ref()\r\n        .child(`cardsByGame/${gameKey}/round${round}/cardsState/${userId}`)\r\n        .update({ [`${cardIndex}`]: null });\r\n    }\r\n  }\r\n\r\n  public static savePlayersOrder(\r\n    leagueID: string,\r\n    gameKey: string,\r\n    playersOrder: IPlayer[]\r\n  ) {\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${gameKey}`)\r\n      .update({ playersOrder });\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { fire } from '../firebase';\r\nimport { Button, message } from 'antd';\r\nimport { TableOutlined, BorderOuterOutlined } from '@ant-design/icons';\r\nimport {\r\n  getDevicePlayerIndex,\r\n  dealCards,\r\n  nextPlayerIndex,\r\n  getTotalWonBid,\r\n  calcIfRoundFell,\r\n  getTotalRemoteWonBid,\r\n  calculateHandWinner,\r\n} from '../utils/game-utils';\r\nimport './GameTab.scss';\r\nimport { INPUT_MODE } from '../constants/states';\r\nimport GameMobileView from './GameMobileView';\r\nimport { GAME_DEFAULT_SCORES } from '../constants/scores';\r\nimport GameService from '../services/GameSrv';\r\nimport {\r\n  IGameColumn,\r\n  GameViewType,\r\n  GAME_STATUS,\r\n  IGameData,\r\n  ILeagueGameModel,\r\n  IGamePlayersSummary,\r\n  IRoundData,\r\n  TotalScoreTypeMap,\r\n  TotalScoreType,\r\n  LeagueScoreTypeMap,\r\n  LeagueScoreType,\r\n  IThrownCard,\r\n} from '../models/IGameModel';\r\nimport { RouteComponentProps } from 'react-router-dom';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport const PlayersContext = React.createContext<{\r\n  players: IPlayer[];\r\n  reorderPlayers?: (newOrder: IPlayer[]) => void;\r\n}>({ players: [] });\r\n\r\ntype GameRouteParams = {\r\n  leagueID: string;\r\n  gameID: string;\r\n};\r\n\r\nexport interface IGameTabProps extends RouteComponentProps<GameRouteParams> {\r\n  players: IPlayer[];\r\n  loaderStateCb: (loading: boolean) => void;\r\n}\r\n\r\nexport interface IGameTabState {\r\n  players: IPlayer[];\r\n  devicePlayerIndex: number | null;\r\n  columns: IGameColumn[];\r\n  currentView: GameViewType;\r\n  gameData: Partial<IGameData>;\r\n  gameSummary: IGamePlayersSummary;\r\n}\r\n\r\nclass GameTab extends Component<IGameTabProps, IGameTabState> {\r\n  private gameRef?: firebase.database.Reference;\r\n  private leagueGamesRef?: firebase.database.Query;\r\n  private gameSummaryRef?: firebase.database.Reference;\r\n  private ownCardsStateRef?: firebase.database.Reference;\r\n  private gameKey: string = '';\r\n\r\n  constructor(props: IGameTabProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      players: props.players,\r\n      devicePlayerIndex: null, //this.getDevicePlayerIndex(props.players),\r\n      columns: [], //this.initColumns(props.players),\r\n      currentView: 'table',\r\n      gameData: {\r\n        currentRound: 1,\r\n        dealer: undefined,\r\n        rounds: [],\r\n        totalScore0: undefined,\r\n        totalScore1: undefined,\r\n        totalScore2: undefined,\r\n        totalScore3: undefined,\r\n        // status: '',\r\n      },\r\n      gameSummary: {},\r\n    };\r\n\r\n    this.selectActiveRound = this.selectActiveRound.bind(this);\r\n    this.setCurrentViewState = this.setCurrentViewState.bind(this);\r\n    // this.selectActiveRound = this.selectActiveRound.bind(this);\r\n    this.handleReorderPlayers = this.handleReorderPlayers.bind(this);\r\n  }\r\n\r\n  private fetch() {\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { leagueID, gameID } = params;\r\n\r\n    const db = fire.database();\r\n\r\n    if (this.gameRef) {\r\n      this.gameRef.off('value');\r\n    }\r\n\r\n    this.leagueGamesRef = db\r\n      .ref(`leagueGames/_${leagueID}`)\r\n      .orderByChild('gameID')\r\n      .equalTo(Number(gameID));\r\n\r\n    this.leagueGamesRef.once('value', (snapshot) => {\r\n      const gameData = Object.values(snapshot.val())[0] as ILeagueGameModel;\r\n      const gameKey = Object.keys(snapshot.val())[0];\r\n      this.gameKey = gameKey;\r\n      this.gameRef = db.ref(`games/${gameKey}`);\r\n      this.gameSummaryRef = db.ref(\r\n        `leagueGamesSummary/_${leagueID}/${gameKey}/players`\r\n      );\r\n      const { gameMode, playersOrder } = gameData;\r\n\r\n      const players = playersOrder || this.props.players;\r\n\r\n      this.setState({\r\n        players,\r\n        columns: this.initColumns(players),\r\n        devicePlayerIndex: getDevicePlayerIndex(players),\r\n      });\r\n\r\n      this.gameRef.on('value', (snap) => {\r\n        const gameRefData = snap.val();\r\n\r\n        this.setState({\r\n          gameData: {\r\n            ...this.state.gameData,\r\n            gameMode,\r\n            ...gameRefData,\r\n          },\r\n        });\r\n\r\n        this.props.loaderStateCb(false);\r\n      });\r\n\r\n      this.gameSummaryRef.on('value', (snap) => {\r\n        this.setState({\r\n          gameSummary: {\r\n            ...snap.val(),\r\n          },\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.gameRef?.off('value');\r\n    this.gameSummaryRef?.off('value');\r\n    if (this.ownCardsStateRef) {\r\n      this.ownCardsStateRef.off('value');\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(\r\n    prevProps: IGameTabProps,\r\n    prevState: IGameTabState\r\n  ) {\r\n    if (prevProps.match.params.gameID !== this.props.match.params.gameID) {\r\n      this.fetch();\r\n    }\r\n\r\n    const { gameData } = this.state;\r\n\r\n    if (\r\n      prevState.gameData.gameMode !== gameData.gameMode ||\r\n      prevState.gameData.currentRound !== gameData.currentRound\r\n    ) {\r\n      this.handleGameModeChange();\r\n    }\r\n\r\n    if (prevState.gameData !== gameData) {\r\n      const { currentRound, dealer, gameMode } = gameData;\r\n      const roundData = this.getRoundData(currentRound as number);\r\n\r\n      if (gameMode === 'remote' && roundData) {\r\n        const { handsState, currentHand } = roundData;\r\n        const currentHandState =\r\n          handsState && handsState[currentHand as number];\r\n        const userId = fire.auth().currentUser?.uid;\r\n\r\n        if (\r\n          currentHandState &&\r\n          (currentHandState.thrownCards || []).length === 4 &&\r\n          currentHandState.status === 'ACTIVE'\r\n        ) {\r\n          setTimeout(() => {\r\n            if (dealer === userId) {\r\n              this.handleHandFinished(roundData);\r\n            }\r\n          }, 2500);\r\n        }\r\n\r\n        if (\r\n          currentHand === 13 &&\r\n          (handsState || {})[currentHand].status === 'FINISHED' &&\r\n          dealer === userId\r\n        ) {\r\n          this.calculateHandScore(roundData);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleSave = (row: IRoundData, player: number) => {\r\n    const stateToUpdate: Partial<IGameData> = {};\r\n    let summaryToUpdate;\r\n    const prevRounds = this.state.gameData.rounds || [];\r\n    const newData = [...prevRounds];\r\n    const index = newData.findIndex((item) => row.round === item.round);\r\n\r\n    const item = newData[index];\r\n\r\n    newData.splice(index, 1, {\r\n      ...item,\r\n      ...row,\r\n    });\r\n\r\n    // reference to the new Data relevant row to update with score and segment\r\n    row = newData[index];\r\n\r\n    if (typeof player === 'number') {\r\n      // calculate score\r\n      this.calculatePlayerScore(row, player, newData, index, stateToUpdate);\r\n\r\n      //update O/U\r\n      const {\r\n        currentTotalBid,\r\n        currentTotalWon,\r\n        allHasWonInput,\r\n      } = getTotalWonBid(row);\r\n\r\n      row.segment = currentTotalBid !== null ? currentTotalBid - 13 : '';\r\n      row.check = allHasWonInput && currentTotalWon === 13;\r\n\r\n      // calculate if round fell - change next round factor\r\n      if (row.check) {\r\n        const didRoundFell = calcIfRoundFell(row);\r\n\r\n        if (didRoundFell) {\r\n          row.fell = true;\r\n\r\n          if (row.round < 12) {\r\n            // because metaData index is zero based row.round value is next round index\r\n            newData[row.round].factor = row.factor * 2;\r\n          } else if (row.factor > 1) {\r\n            newData[row.round].factor = row.factor;\r\n          }\r\n        } else if (row.fell) {\r\n          row.fell = false;\r\n          if (newData[row.round]) {\r\n            newData[row.round].factor =\r\n              row.factor > 1 ? row.factor / 2 : row.factor;\r\n          }\r\n\r\n          for (let i = 0; i < 4; i++) {\r\n            this.calculatePlayerScore(row, i, newData, index, stateToUpdate);\r\n          }\r\n        }\r\n\r\n        // calculate round summary stats\r\n        summaryToUpdate = this.calculateSummary(newData, index);\r\n\r\n        if (row.round === 13 && !row.fell) {\r\n          stateToUpdate.status = GAME_STATUS.FINISHED;\r\n          this.updateGameStatus(GAME_STATUS.FINISHED);\r\n\r\n          // round summary league scores\r\n          const {\r\n            totalScore0,\r\n            totalScore1,\r\n            totalScore2,\r\n            totalScore3,\r\n          } = this.state.gameData;\r\n          const scores: TotalScoreTypeMap = {\r\n            totalScore0,\r\n            totalScore1,\r\n            totalScore2,\r\n            totalScore3,\r\n          };\r\n          const totalScore: TotalScoreType = `totalScore${player}` as TotalScoreType;\r\n          scores[totalScore] = stateToUpdate[totalScore];\r\n          summaryToUpdate = this.calculateLeagueScores(scores, summaryToUpdate);\r\n        }\r\n\r\n        this.gameSummaryRef?.update(this.mapToPlayersObj(summaryToUpdate));\r\n      }\r\n    }\r\n\r\n    if (this.state.gameData.gameMode === 'remote') {\r\n      // prev round inputMode === BID\r\n      // round inputMode === WON\r\n      // set players with won === 0;\r\n      const prevRound = prevRounds[index];\r\n\r\n      if (\r\n        prevRound.inputMode === INPUT_MODE.BID &&\r\n        row.inputMode === INPUT_MODE.WON\r\n      ) {\r\n        [0, 1, 2, 3].forEach((player) => {\r\n          row[`won${player}`] = 0;\r\n        });\r\n      }\r\n    }\r\n\r\n    stateToUpdate.rounds = newData;\r\n\r\n    // this.setState(stateToUpdate);\r\n    this.gameRef?.update(stateToUpdate);\r\n  };\r\n\r\n  private handleCardThrown = (\r\n    card: string,\r\n    player: number,\r\n    currentRound: number,\r\n    currentHand: number\r\n  ) => {\r\n    const roundData = this.getRoundData(currentRound);\r\n    const thrownCards =\r\n      (roundData &&\r\n        roundData.handsState &&\r\n        roundData.handsState[currentHand].thrownCards) ||\r\n      [];\r\n    const newThrownCards = [...thrownCards, { player, card }];\r\n\r\n    const {\r\n      gameData: { ownCardsState },\r\n    } = this.state;\r\n\r\n    this.gameRef\r\n      ?.child(`rounds/${currentRound - 1}/handsState/${currentHand}`)\r\n      .update({\r\n        status: 'ACTIVE',\r\n        turnOf: newThrownCards.length !== 4 ? nextPlayerIndex(player) : null,\r\n        thrownCards: newThrownCards,\r\n      })\r\n      .then(() => this.updateOwnCardState(card, currentRound, ownCardsState));\r\n  };\r\n\r\n  private calculatePlayerScore = (\r\n    round: IRoundData,\r\n    player: number,\r\n    roundsData: IRoundData[],\r\n    currentRound: number,\r\n    stateToUpdate: Partial<IGameData>\r\n  ) => {\r\n    let rowScore;\r\n\r\n    const bid = round[`bid${player}`];\r\n    const won = round[`won${player}`];\r\n\r\n    if (won !== '' && bid !== '') {\r\n      if (won === bid) {\r\n        if (won * 1 === 0) {\r\n          rowScore = (round.segment as number) > 0 ? 25 : 50;\r\n        } else {\r\n          rowScore = Math.pow(won, 2) + 10;\r\n        }\r\n      } else {\r\n        const diff = Math.abs(won - bid);\r\n\r\n        if (bid * 1 === 0) {\r\n          rowScore =\r\n            -((round.segment as number) > 0 ? 25 : 50) + (diff - 1) * 10;\r\n        } else {\r\n          rowScore = diff * -10;\r\n        }\r\n      }\r\n\r\n      rowScore *= round.factor;\r\n\r\n      round[`score${player}`] = rowScore;\r\n\r\n      //calculate aggregate score\r\n      let aggregateScore = 0;\r\n      for (let i = 0; i <= currentRound; i++) {\r\n        const round = roundsData[i];\r\n\r\n        if (typeof round[`score${player}`] === 'number' && !round.fell) {\r\n          aggregateScore += round[`score${player}`];\r\n        }\r\n      }\r\n      round[`aggregateScore${player}`] = aggregateScore;\r\n      stateToUpdate[`totalScore${player}`] = round[`aggregateScore${player}`];\r\n    }\r\n  };\r\n\r\n  private calculateLeagueScores = (\r\n    scores: TotalScoreTypeMap,\r\n    summaryToUpdate: IGamePlayersSummary\r\n  ): IGamePlayersSummary => {\r\n    const sortedScores: TotalScoreType[] = (Object.keys(\r\n      scores\r\n    ) as TotalScoreType[]).sort(\r\n      (a: TotalScoreType, b: TotalScoreType) =>\r\n        (scores[b] || 0) - (scores[a] || 0)\r\n    );\r\n\r\n    sortedScores.forEach((scoreIndex: TotalScoreType, i) => {\r\n      const score = scores[scoreIndex] as number;\r\n      let leagueScore = GAME_DEFAULT_SCORES[i];\r\n\r\n      // score < 0 => -1\r\n      if (score < 0) {\r\n        leagueScore--;\r\n      }\r\n\r\n      // score reminder from 100 == 0 => leagueScore + 1\r\n      if (score % 100 === 0) {\r\n        leagueScore++;\r\n      }\r\n\r\n      // score > 300 => +3\r\n      if (score > 300) {\r\n        leagueScore += 3;\r\n      }\r\n\r\n      // score < -100 => -3\r\n      if (score < -100) {\r\n        leagueScore -= 3;\r\n      }\r\n\r\n      summaryToUpdate[`${scoreIndex.slice(-1)}`].leagueScore = leagueScore;\r\n    });\r\n\r\n    return summaryToUpdate;\r\n  };\r\n\r\n  private calculateSummary = (\r\n    roundsData: IRoundData[],\r\n    currentRoundIndex: number\r\n  ): IGamePlayersSummary => {\r\n    const currentRound = currentRoundIndex + 1;\r\n    const playersSummary: IGamePlayersSummary = {};\r\n\r\n    for (let pIndex = 0; pIndex < 4; pIndex++) {\r\n      // playersSummary[pIndex] = {};\r\n      let stood = 0;\r\n      let totalRounds = 0;\r\n      let totalHBrounds = 0;\r\n      let stoodWhileHB = 0;\r\n      let stoodInOver = 0;\r\n      let totalOverRounds = 0;\r\n      let stoodInUnder = 0;\r\n      let totalNTrounds = 0;\r\n      let stoodInNT = 0;\r\n      let stoodWhenLastBidder = 0;\r\n      let totalStoodWhenLastBidder = 0;\r\n\r\n      for (let rIndex = 0; rIndex < currentRound; rIndex++) {\r\n        const round = roundsData[rIndex];\r\n        if (!round.fell) {\r\n          totalRounds++;\r\n          const highestBidder = round.highestBidder === pIndex;\r\n          const lastBidder =\r\n            !highestBidder &&\r\n            (pIndex + 1 > 3 ? 0 : pIndex + 1) === round.highestBidder;\r\n\r\n          if (highestBidder) {\r\n            totalHBrounds++;\r\n          } else if (lastBidder) {\r\n            totalStoodWhenLastBidder++;\r\n          }\r\n\r\n          if (round.segment && round.segment > 0) {\r\n            totalOverRounds++;\r\n          }\r\n\r\n          if (round.trump === 'NT') {\r\n            totalNTrounds++;\r\n          }\r\n\r\n          if (round[`bid${pIndex}`] === round[`won${pIndex}`]) {\r\n            stood++;\r\n\r\n            if (highestBidder) {\r\n              stoodWhileHB++;\r\n            } else if (lastBidder) {\r\n              stoodWhenLastBidder++;\r\n            }\r\n\r\n            if (round.trump === 'NT') {\r\n              stoodInNT++;\r\n            }\r\n\r\n            round.segment && round.segment > 0 ? stoodInOver++ : stoodInUnder++;\r\n          }\r\n        }\r\n      }\r\n\r\n      const successRate = { wins: stood, total: totalRounds };\r\n      const successRateHB = { wins: stoodWhileHB, total: totalHBrounds };\r\n      const successRateOver = { wins: stoodInOver, total: totalOverRounds };\r\n      const successRateUnder = {\r\n        wins: stoodInUnder,\r\n        total: totalRounds - totalOverRounds,\r\n      };\r\n      const successRateNT = { wins: stoodInNT, total: totalNTrounds };\r\n      const successRateLastBidder = {\r\n        wins: stoodWhenLastBidder,\r\n        total: totalStoodWhenLastBidder,\r\n      };\r\n\r\n      playersSummary[pIndex] = {\r\n        // successRate: Number.isNaN(successRate) ? '' : successRate,\r\n        leagueScore: 0,\r\n        successRate,\r\n        successRateHB,\r\n        successRateOver,\r\n        successRateUnder,\r\n        successRateNT,\r\n        successRateLastBidder,\r\n      };\r\n    }\r\n\r\n    return playersSummary;\r\n  };\r\n\r\n  private mapToPlayersObj = (\r\n    summaryToUpdate: IGamePlayersSummary\r\n  ): IGamePlayersSummary => {\r\n    const { players, gameSummary } = this.state;\r\n\r\n    return players.reduce((obj: IGamePlayersSummary, player, index) => {\r\n      obj[player.key] = {\r\n        ...gameSummary[player.key],\r\n        ...summaryToUpdate[index],\r\n      };\r\n\r\n      return obj;\r\n    }, {});\r\n  };\r\n\r\n  private updateGameStatus = (status: GAME_STATUS) => {\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { leagueID } = params;\r\n\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${this.gameKey}`)\r\n      .update({ status });\r\n  };\r\n\r\n  private toggleSlide = () => {\r\n    const currentView = this.state.currentView === 'panel' ? 'table' : 'panel';\r\n    this.setCurrentViewState(currentView);\r\n  };\r\n\r\n  private setCurrentViewState(currentView: GameViewType) {\r\n    this.setState({ currentView });\r\n  }\r\n\r\n  private selectActiveRound(newRound: number) {\r\n    const { gameData, currentView } = this.state;\r\n    const { rounds, currentRound, gameMode, dealer } = gameData;\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    if (\r\n      Number(newRound) < Number(currentRound) ||\r\n      (rounds && rounds[(currentRound as number) - 1].check)\r\n    ) {\r\n      this.gameRef?.update({\r\n        currentRound: Number(newRound),\r\n      });\r\n\r\n      if (currentView === 'table') {\r\n        this.toggleSlide();\r\n      }\r\n\r\n      if (\r\n        gameMode === 'remote' &&\r\n        dealer === userId &&\r\n        !(rounds as IRoundData[])[newRound - 1].handsState\r\n      ) {\r\n        // deal cards\r\n        const { players } = this.state;\r\n        const cardsByPlayer = dealCards(players);\r\n\r\n        // *** if cards already exist for this round firebase will block the update\r\n        GameService.setCardsToPlayers(this.gameKey, newRound, cardsByPlayer);\r\n      }\r\n    } else {\r\n      message.warning('Current round is not completed');\r\n    }\r\n  }\r\n\r\n  private handleReorderPlayers(newOrder: IPlayer[]) {\r\n    this.setState({\r\n      players: newOrder,\r\n      devicePlayerIndex: getDevicePlayerIndex(newOrder),\r\n      columns: this.initColumns(newOrder),\r\n    });\r\n\r\n    const { params } = this.props.match;\r\n    const { leagueID } = params;\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${this.gameKey}`)\r\n      .update({ playersOrder: newOrder });\r\n  }\r\n\r\n  private getLeagueScores = (): LeagueScoreTypeMap => {\r\n    const { gameSummary, players } = this.state;\r\n\r\n    if (Object.keys(gameSummary).length === 0) {\r\n      return {\r\n        leagueScore0: 0,\r\n        leagueScore1: 0,\r\n        leagueScore2: 0,\r\n        leagueScore3: 0,\r\n      };\r\n    }\r\n\r\n    return players.reduce((summaryObj: LeagueScoreTypeMap, player, i) => {\r\n      summaryObj[`leagueScore${i}` as LeagueScoreType] =\r\n        gameSummary[player.key].leagueScore;\r\n      return summaryObj;\r\n    }, {});\r\n  };\r\n\r\n  public render() {\r\n    const {\r\n      columns,\r\n      currentView,\r\n      gameData,\r\n      players,\r\n      devicePlayerIndex,\r\n    } = this.state;\r\n    const { rounds, currentRound, gameMode, ownCardsState } = gameData;\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { gameID } = params;\r\n    const playersColumns = columns.slice(0, 4);\r\n\r\n    return (\r\n      <PlayersContext.Provider\r\n        value={{ players, reorderPlayers: this.handleReorderPlayers }}\r\n      >\r\n        {createPortal(\r\n          <Button\r\n            className=\"toggle-view-btn\"\r\n            type=\"link\"\r\n            onClick={this.toggleSlide}\r\n            icon={\r\n              currentView === 'table' ? (\r\n                <BorderOuterOutlined />\r\n              ) : (\r\n                <TableOutlined />\r\n              )\r\n            }\r\n          />,\r\n          document.querySelector('#app-header') || document.body\r\n        )}\r\n\r\n        <GameMobileView\r\n          gameID={gameID}\r\n          gameMode={gameMode}\r\n          currentView={currentView}\r\n          rounds={rounds}\r\n          ownCardsState={ownCardsState}\r\n          handleCardThrown={this.handleCardThrown}\r\n          // handState={}\r\n          playersColumns={playersColumns}\r\n          devicePlayerIndex={devicePlayerIndex}\r\n          currentRound={currentRound}\r\n          handleSave={this.handleSave}\r\n          onCurrentViewChange={this.setCurrentViewState}\r\n          goToRound={this.selectActiveRound}\r\n          leagueScores={this.getLeagueScores()}\r\n        />\r\n      </PlayersContext.Provider>\r\n    );\r\n  }\r\n\r\n  private initColumns = (players: IPlayer[]): IGameColumn[] => {\r\n    return players.map(({ nickname }, i) => {\r\n      return {\r\n        playerName: nickname,\r\n        index: i,\r\n      };\r\n    });\r\n  };\r\n\r\n  private getRoundData(roundIndex: number) {\r\n    return (this.state.gameData.rounds || []).find(\r\n      (round) => round.round === roundIndex\r\n    );\r\n  }\r\n\r\n  private handleGameModeChange() {\r\n    const { gameData, players } = this.state;\r\n    const { gameMode } = gameData;\r\n\r\n    if (gameMode === 'remote') {\r\n      const { currentRound, dealer } = gameData;\r\n      const userId = fire.auth().currentUser?.uid;\r\n\r\n      this.ownCardsStateRef = fire\r\n        .database()\r\n        .ref(\r\n          `cardsByGame/${this.gameKey}/round${currentRound}/cardsState/${userId}`\r\n        );\r\n\r\n      this.ownCardsStateRef.on('value', (snap) => {\r\n        console.log(snap.val());\r\n        this.setState((state) => {\r\n          return {\r\n            gameData: {\r\n              ...state.gameData,\r\n              ownCardsState: snap.val() || [],\r\n            },\r\n          };\r\n        });\r\n\r\n        const {\r\n          gameData: { currentRound },\r\n        } = this.state;\r\n        const roundData = this.getRoundData(currentRound as number);\r\n\r\n        // if current round === 1 and no handsState and gameMode === remote then deal cards\r\n        if (\r\n          !snap.val() &&\r\n          currentRound === 1 &&\r\n          !roundData?.handsState &&\r\n          dealer === userId\r\n        ) {\r\n          const cardsByPlayer = dealCards(players);\r\n          GameService.setCardsToPlayers(\r\n            this.gameKey,\r\n            currentRound,\r\n            cardsByPlayer\r\n          );\r\n        }\r\n      });\r\n    } else if (gameData.ownCardsState) {\r\n      this.setState({\r\n        gameData: {\r\n          ...gameData,\r\n          ownCardsState: undefined,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private handleHandFinished(roundData: IRoundData) {\r\n    const winner = calculateHandWinner(roundData);\r\n    const { round, handsState, currentHand } = roundData;\r\n\r\n    this.gameRef\r\n      ?.child(`rounds/${round - 1}`)\r\n      .update({\r\n        [`won${winner.player}`]: roundData[`won${winner.player}`]\r\n          ? roundData[`won${winner.player}`] + 1\r\n          : 1,\r\n        handsState: {\r\n          ...handsState,\r\n          [currentHand as number]: {\r\n            ...(handsState || {})[currentHand as number],\r\n            status: 'FINISHED',\r\n            handWinner: winner.player,\r\n          },\r\n          [(currentHand as number) + 1]: {\r\n            status: 'ACTIVE',\r\n            turnOf: winner.player,\r\n            thrownCards: [],\r\n          },\r\n        },\r\n      })\r\n      .then(() =>\r\n        setTimeout(\r\n          () => currentHand !== 13 && this.goToNextHand(roundData, winner),\r\n          200\r\n        )\r\n      );\r\n  }\r\n\r\n  private goToNextHand(roundData: IRoundData, winner: IThrownCard) {\r\n    const { round, currentHand } = roundData;\r\n\r\n    this.gameRef?.child(`rounds/${round - 1}`).update({\r\n      // [`won${winner.player}`]: roundData[`won${winner.player}`]\r\n      //   ? roundData[`won${winner.player}`] + 1\r\n      //   : 1,\r\n      currentHand: (currentHand as number) + 1,\r\n      // handsState: {\r\n      //   // ...handsState,\r\n      //   [currentHand + 1]: {\r\n      //     status: 'ACTIVE',\r\n      //     turnOf: winner.player,\r\n      //     thrownCards: [],\r\n      //   },\r\n      // },\r\n    });\r\n  }\r\n\r\n  private calculateHandScore(roundData: IRoundData) {\r\n    const gameData = { ...this.state.gameData };\r\n    const { rounds: allRounds, currentRound } = gameData;\r\n    const newRound = { ...roundData };\r\n    const gameToUpdate: Partial<IGameData> = {};\r\n\r\n    [0, 1, 2, 3].forEach((player) =>\r\n      this.calculatePlayerScore(\r\n        newRound,\r\n        player,\r\n        allRounds as IRoundData[],\r\n        (currentRound as number) - 1,\r\n        gameToUpdate\r\n      )\r\n    );\r\n\r\n    // calc if round check\r\n    // update O/U\r\n    const { currentTotalWon } = getTotalRemoteWonBid(newRound);\r\n\r\n    newRound.check = currentTotalWon === 13;\r\n\r\n    // calculate if round fell - change next round factor\r\n    if (newRound.check && allRounds) {\r\n      const didRoundFell = calcIfRoundFell(newRound);\r\n\r\n      if (didRoundFell) {\r\n        newRound.fell = true;\r\n\r\n        if (newRound.round < 12) {\r\n          // because metaData index is zero based row.round value is next round index\r\n          allRounds[newRound.round].factor = newRound.factor * 2;\r\n        } else if (newRound.factor > 1) {\r\n          allRounds[newRound.round].factor = newRound.factor;\r\n        }\r\n      } else if (newRound.fell) {\r\n        newRound.fell = false;\r\n        if (allRounds[newRound.round]) {\r\n          allRounds[newRound.round].factor =\r\n            newRound.factor > 1 ? newRound.factor / 2 : newRound.factor;\r\n        }\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n          this.calculatePlayerScore(\r\n            newRound,\r\n            i,\r\n            allRounds,\r\n            (currentRound as number) - 1,\r\n            gameToUpdate\r\n          );\r\n        }\r\n      }\r\n\r\n      // calculate round summary stats\r\n      let summaryToUpdate = this.calculateSummary(\r\n        allRounds,\r\n        (currentRound as number) - 1\r\n      );\r\n\r\n      if (newRound.round === 13 && !newRound.fell) {\r\n        gameToUpdate.status = GAME_STATUS.FINISHED;\r\n        this.updateGameStatus(GAME_STATUS.FINISHED);\r\n\r\n        // round summary league scores\r\n        const {\r\n          totalScore0,\r\n          totalScore1,\r\n          totalScore2,\r\n          totalScore3,\r\n        } = gameToUpdate;\r\n        const scores = { totalScore0, totalScore1, totalScore2, totalScore3 };\r\n        // scores[`totalScore${player}`] = gameToUpdate[`totalScore${player}`];\r\n        summaryToUpdate = this.calculateLeagueScores(scores, summaryToUpdate);\r\n      }\r\n\r\n      this.gameSummaryRef?.update(this.mapToPlayersObj(summaryToUpdate));\r\n    }\r\n\r\n    allRounds?.splice((currentRound as number) - 1, 1, newRound);\r\n\r\n    gameToUpdate.rounds = allRounds;\r\n\r\n    this.gameRef?.update(gameToUpdate);\r\n  }\r\n\r\n  private updateOwnCardState(\r\n    thrownCard: string,\r\n    currentRound: number,\r\n    ownCardsState: string[] = []\r\n  ) {\r\n    const cardIndex = Object.keys(ownCardsState).find(\r\n      (index) => ownCardsState[+index] === thrownCard\r\n    );\r\n    GameService.updateHandCardsState(this.gameKey, currentRound, cardIndex);\r\n  }\r\n}\r\n\r\nexport default GameTab;\r\n","import React from 'react';\nimport { Spin } from 'antd';\n\ninterface ILoaderProps {\n  className?: string;\n}\n\nconst Loader = (props: ILoaderProps) => (\n  <div className={`full-view loader ${props.className ? props.className : ''}`}>\n    <Spin\n      size=\"large\"\n      style={{ width: '100%', position: 'relative', top: '50%' }}\n    />\n  </div>\n);\n\nexport default Loader;\n","import React, { Component } from 'react';\nimport { fire } from '../firebase';\nimport './LeagueSummary.css';\nimport { Row, Col } from 'antd';\n\nconst statsObj = {\n  successRate: 'Succes Win Rates',\n  successRateHB: 'Highest Bidding Win Rates',\n  successRateOver: 'Over Win Rate',\n  successRateUnder: 'Under Win Rate',\n  successRateNT: 'NT Win Rates',\n  successRateLastBidder: 'Last Bidder Win Rate',\n};\n\nexport default class LeagueSummary extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      players: props.league.players,\n    };\n  }\n\n  componentDidMount() {\n    this.fetch();\n  }\n\n  componentWillUnmount() {\n    this.gameSummaryRef.off('value');\n  }\n\n  fetch() {\n    const {\n      league: { leagueID },\n    } = this.props;\n    const { players } = this.state;\n\n    const dbRef = fire.database().ref();\n    this.gameSummaryRef = dbRef.child(`leagueGamesSummary/_${leagueID}`);\n    this.leagueGamesRef = dbRef\n      .child(`leagueGames/_${leagueID}`)\n      .orderByChild('status')\n      .equalTo('FINISHED');\n\n    this.leagueGamesRef.on('value', (snap) => {\n      if (snap.val()) {\n        const gameKeys = Object.keys(snap.val());\n        const lastKey = gameKeys[gameKeys.length - 1];\n\n        this.gameSummaryRef\n          .orderByKey()\n          .endAt(lastKey)\n          .on('value', (snap) => {\n            const gameSummary = Object.values(snap.val());\n            this.setState({\n              players: players.map((player) => {\n                const playerKey = player.key;\n\n                return {\n                  ...player,\n                  games: gameSummary.map((game, i) => game.players[playerKey]),\n                };\n              }),\n            });\n          });\n      }\n    });\n  }\n\n  render() {\n    const { league } = this.props;\n    const { title } = league;\n    const { players } = this.state;\n\n    return (\n      <div className=\"game-summery\">\n        <h3>{title}</h3>\n\n        <h3>League Score:</h3>\n        <Row gutter={1} className=\"table-header\" style={{ marginBottom: 1 }}>\n          {this.getTableHeaders(players)}\n        </Row>\n        <Row gutter={1}>{this.getScoreRow(players)}</Row>\n        {Object.keys(statsObj).map(this.getStatsRow)}\n      </div>\n    );\n  }\n\n  getTableHeaders = (players) =>\n    players.map(({ key, nickname }) => (\n      <Col key={key} span={6}>\n        <div className=\"table-cell\">{nickname}</div>\n      </Col>\n    ));\n\n  getScoreRow = (players) =>\n    players.map((player) => (\n      <Col span={6} key={player.key}>\n        <div className=\"table-cell\">\n          {player.games && this.scoreReducer(player.games, 'leagueScore')}\n        </div>\n      </Col>\n    ));\n\n  getStatsRow = (statsKey) => {\n    const { players } = this.state;\n\n    return (\n      <div className=\"stats-row\" key={statsKey}>\n        <h4>{statsObj[statsKey]}</h4>\n        <Row gutter={1}>{this.getWinRateRow(players, statsKey)}</Row>\n      </div>\n    );\n  };\n\n  getWinRateRow = (players, statsKey) =>\n    players.map((player) => (\n      <Col span={6} key={player.key}>\n        <div className=\"table-cell\">\n          {player.games && this.calculateRate(player.games, statsKey)}%\n        </div>\n      </Col>\n    ));\n\n  scoreReducer = (games, prop) =>\n    games.reduce((sum, game) => sum + Number(game[prop]), 0);\n\n  calculateRate = (games, prop) =>\n    this.toPercentage(this.preCalculateRate(games, prop));\n\n  toPercentage = ({ wins, total }) =>\n    Number.parseFloat((wins / total) * 100).toFixed(0);\n\n  preCalculateRate = (games, prop) =>\n    games.reduce(\n      (sumObj, game) => {\n        const category = game[prop];\n        sumObj.wins += category.wins;\n        sumObj.total += category.total;\n        return sumObj;\n      },\n      { wins: 0, total: 0 }\n    );\n}\n","import { fire } from '../firebase';\r\nimport { ILeagueModel } from '../models/ILeagueModel';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\ninterface IInvited {\r\n  [userID: string]: string;\r\n}\r\n\r\nexport interface IGameInvite {\r\n  inviteKey: string;\r\n  leagueID: number;\r\n  leagueTitle: string;\r\n  newGameId: number;\r\n  inviter: IPlayer;\r\n}\r\n\r\ninterface IInviteObj {\r\n  invited: IInvited;\r\n  invite: IGameInvite;\r\n}\r\n\r\nexport default class LeagueService {\r\n  public static invitePlayers(\r\n    league: Partial<ILeagueModel>,\r\n    newGameId: number\r\n  ): Promise<boolean> {\r\n    // TODO: add reject when after a xxx seconds with not enough joined players\r\n    // TODO: upgrade the promise to allow cancel\r\n    return new Promise<boolean>((resolve) => {\r\n      // create firebase ref to notification/gameInvites\r\n      const gameInvitesRef = fire\r\n        .database()\r\n        .ref()\r\n        .child('notifications/gameInvites');\r\n\r\n      // generate new key\r\n      const inviteKey = gameInvitesRef.push().key;\r\n      const { invited, invite } = LeagueService.setInviteObj(\r\n        league,\r\n        inviteKey as string,\r\n        newGameId\r\n      );\r\n\r\n      // update the invantation and invited list\r\n      const update = {\r\n        [`${inviteKey}`]: invite,\r\n      };\r\n\r\n      gameInvitesRef\r\n        .update(update)\r\n        .then(() => LeagueService.setAllInvited(invited, gameInvitesRef))\r\n        .then((invitedRefs) => {\r\n          // setTimeout(() => {\r\n          //   gameInvitesRef\r\n          //     .child(`${inviteKey}/joinedPlayers`)\r\n          //     .push('QVU5a8IMtPZkqo76vgRAvErZ3pm2');\r\n          // }, 2000);\r\n          // setTimeout(() => {\r\n          //   gameInvitesRef\r\n          //     .child(`${inviteKey}/joinedPlayers`)\r\n          //     .push('6fosZWZDV5g0yB7Js8IQhk3ADHh2');\r\n          // }, 2500);\r\n\r\n          const playersKeys = Object.keys(invited);\r\n\r\n          // listen to changes in the invantation (joinedPlayers)\r\n          gameInvitesRef\r\n            .child(`${inviteKey}/joinedPlayers`)\r\n            .on('child_added', (player: firebase.database.DataSnapshot) => {\r\n              console.log(player.val());\r\n              // resolve when all players joined\r\n              const index = playersKeys.indexOf(player.val());\r\n\r\n              if (index > -1) {\r\n                playersKeys.splice(index, 1);\r\n              }\r\n\r\n              console.log(playersKeys);\r\n\r\n              if (!playersKeys.length) {\r\n                gameInvitesRef\r\n                  .child(`${inviteKey}/joinedPlayers`)\r\n                  .off('child_added');\r\n\r\n                LeagueService.removeAllInvited(invitedRefs);\r\n                resolve();\r\n              }\r\n            });\r\n        });\r\n    });\r\n  }\r\n\r\n  public static setInviteObj(\r\n    league: Partial<ILeagueModel>,\r\n    inviteKey: string,\r\n    newGameId: number\r\n  ): IInviteObj {\r\n    const { players, leagueID, title } = league;\r\n    const userId = fire.auth().currentUser?.uid;\r\n    const inviter = players?.find((player) => player.key === userId) as IPlayer;\r\n    const invited = (players as IPlayer[])\r\n      .filter((player) => player.key !== userId)\r\n      .reduce((invited, player) => {\r\n        invited[player.key] = inviteKey;\r\n\r\n        return invited;\r\n      }, {} as IInvited);\r\n\r\n    return {\r\n      invited,\r\n      invite: {\r\n        inviter,\r\n        inviteKey,\r\n        leagueID: leagueID as number,\r\n        leagueTitle: title as string,\r\n        newGameId,\r\n      },\r\n    };\r\n  }\r\n\r\n  public static setAllInvited(\r\n    invited: IInvited,\r\n    gameInvitesRef: firebase.database.Reference\r\n  ): Promise<firebase.database.Reference[]> {\r\n    const sets: Promise<firebase.database.Reference>[] = [];\r\n\r\n    Object.keys(invited).forEach((playerKey) => {\r\n      const promise = gameInvitesRef\r\n        .child(`invitedPlayers/${playerKey}`)\r\n        .push(invited[playerKey]);\r\n\r\n      sets.push(promise);\r\n    });\r\n\r\n    return Promise.all(sets);\r\n  }\r\n\r\n  public static removeAllInvited(invitedRefs: firebase.database.Reference[]) {\r\n    invitedRefs.forEach((ref: firebase.database.Reference) => {\r\n      ref.set(null);\r\n    });\r\n  }\r\n\r\n  public static acceptGameInvite(invite: IGameInvite): Promise<any> {\r\n    const { inviteKey } = invite;\r\n    const gameInviteRef = fire\r\n      .database()\r\n      .ref()\r\n      .child(`notifications/gameInvites/${inviteKey}/joinedPlayers`);\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    // TODO: listen also if game was added before resolve,\r\n    // otherwise the navigation to the new game is before the game is actually created\r\n    return new Promise((resolve) => {\r\n      gameInviteRef.push(userId).then(() => {\r\n        gameInviteRef.on('value', (snap) => {\r\n          if (Object.values(snap.val()).length === 3) {\r\n            gameInviteRef.off('value');\r\n            resolve();\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { fire } from '../firebase';\r\nimport { Route, Link, RouteComponentProps } from 'react-router-dom';\r\nimport withAuthorization from '../authentication/withAuthorization';\r\nimport { Menu, Layout, message } from 'antd';\r\nimport {\r\n  DashboardOutlined,\r\n  GoldOutlined,\r\n  ExportOutlined,\r\n  PlusOutlined,\r\n} from '@ant-design/icons';\r\nimport './League.scss';\r\nimport GameTab from '../game/GameTab';\r\nimport * as routes from '../constants/routes';\r\nimport gameDataTpl from '../dataTemplates/gameTpl';\r\nimport RcDrawer from 'rc-drawer';\r\nimport 'rc-drawer/assets/index.css';\r\nimport Loader from '../common/loader/Loader';\r\nimport LeagueSummary from '../leagueSummary/LeagueSummary';\r\nimport Dialog from '../dialogs/Dialog';\r\nimport { Dialogs } from '../constants/dialogs';\r\nimport { ILeagueModel } from '../models/ILeagueModel';\r\nimport { MenuInfo } from 'rc-menu/lib/interface';\r\nimport { GameMode, GAME_STATUS } from '../models/IGameModel';\r\nimport { UserContext } from '../authentication/AuthUserContext';\r\nimport LeagueService from '../services/LeagueSrv';\r\nimport { shufflePlayers } from '../utils/game-utils';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nconst { Content } = Layout;\r\nconst SubMenu = Menu.SubMenu;\r\n\r\nexport interface ILeagueState {\r\n  loading: boolean;\r\n  menuSelected: string | 'dashboard';\r\n  league: Partial<ILeagueModel>;\r\n  leagueGames: Array<any>;\r\n  drawerVisible: boolean;\r\n  newGameDialog: boolean;\r\n}\r\n\r\ntype TParams = { leagueID?: string };\r\n\r\nexport interface ILeagueProps extends RouteComponentProps<TParams> {}\r\n\r\nclass League extends React.Component<ILeagueProps, ILeagueState> {\r\n  private leagueRef: firebase.database.Reference;\r\n  private leagueGamesRef: firebase.database.Reference;\r\n\r\n  constructor(props: ILeagueProps) {\r\n    super(props);\r\n\r\n    const { location, match } = props;\r\n    const { leagueID } = match.params;\r\n\r\n    const matchGame = location.pathname.match(/game\\/[1-9]/g) || [];\r\n    const gameID = matchGame.length ? matchGame[0].split('/')[1] : false;\r\n\r\n    this.state = {\r\n      loading: false,\r\n      menuSelected: gameID || 'dashboard',\r\n      league: { title: '', players: [] },\r\n      leagueGames: [],\r\n      drawerVisible: false,\r\n      newGameDialog: false,\r\n      // activeGame: `0`\r\n    };\r\n\r\n    /* Create reference to messages in Firebase Database */\r\n    const dbRef = fire.database().ref();\r\n    this.leagueRef = dbRef.child(`leagues/list/_${leagueID}`);\r\n    this.leagueGamesRef = dbRef.child(`leagueGames/_${leagueID}`);\r\n\r\n    this.handleMenuItemClick = this.handleMenuItemClick.bind(this);\r\n    this.newGameDialogHandler = this.newGameDialogHandler.bind(this);\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.leagueRef.off('value');\r\n  }\r\n\r\n  private fetch() {\r\n    this.setState({ loading: true });\r\n    this.leagueRef.on('value', (snapshot) => {\r\n      const leagueData: ILeagueModel = snapshot.val();\r\n      console.log(leagueData);\r\n      if (leagueData) {\r\n        this.setState({\r\n          league: {\r\n            ...this.state.league,\r\n            ...leagueData,\r\n          },\r\n          loading: false,\r\n        });\r\n      }\r\n    });\r\n\r\n    this.leagueGamesRef.on('child_added', (snapshot) => {\r\n      this.setState((prevState) => {\r\n        return { leagueGames: [...prevState.leagueGames, snapshot.val()] };\r\n      });\r\n    });\r\n\r\n    this.leagueGamesRef.on('child_changed', (snapshot) => {\r\n      console.log('child_changed', snapshot.val());\r\n      this.setState((prevState) => {\r\n        const leagueGames = prevState.leagueGames;\r\n        const changedIndex = leagueGames.findIndex(\r\n          (game) => game.gameID === snapshot.val().gameID\r\n        );\r\n\r\n        return {\r\n          leagueGames: [\r\n            ...leagueGames.slice(0, changedIndex),\r\n            {\r\n              ...snapshot.val(),\r\n            },\r\n            ...leagueGames.slice(changedIndex + 1),\r\n          ],\r\n        };\r\n      });\r\n    });\r\n  }\r\n\r\n  public render() {\r\n    const { match } = this.props;\r\n    const { league, loading, drawerVisible } = this.state;\r\n    const { leagueID, players } = league;\r\n\r\n    return (\r\n      <Layout className=\"league-container\">\r\n        <RcDrawer\r\n          getContainer=\".app\"\r\n          width=\"250px\"\r\n          open={drawerVisible}\r\n          onHandleClick={this.toggleDrawer}\r\n          onClose={this.toggleDrawer}\r\n        >\r\n          <div className=\"drawer-title\">{league.title}</div>\r\n          {this.getMenu()}\r\n        </RcDrawer>\r\n        {loading && <Loader className=\"with-mask\" />}\r\n        <Layout>\r\n          <Content>\r\n            <Route\r\n              path={`${routes.LEAGUE}/:leagueID/game/:gameID`}\r\n              render={(props) =>\r\n                !!leagueID ? (\r\n                  <GameTab\r\n                    {...props}\r\n                    players={players as IPlayer[]}\r\n                    // loading={loading}\r\n                    loaderStateCb={this.setLoaderState}\r\n                  />\r\n                ) : (\r\n                  <Loader />\r\n                )\r\n              }\r\n            />\r\n            <Route\r\n              exact\r\n              path={match.url}\r\n              render={(props) =>\r\n                !!leagueID ? (\r\n                  <LeagueSummary {...props} league={league} />\r\n                ) : (\r\n                  <Loader />\r\n                )\r\n              }\r\n            />\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  private getMenu() {\r\n    const { match } = this.props;\r\n    const { leagueGames, menuSelected, newGameDialog } = this.state;\r\n\r\n    return (\r\n      <Menu\r\n        mode=\"inline\"\r\n        selectedKeys={[menuSelected]}\r\n        defaultOpenKeys={['gamesSub']}\r\n        onClick={this.handleMenuItemClick}\r\n        className=\"league-menu\"\r\n      >\r\n        <Menu.Item key=\"dashboard\">\r\n          <DashboardOutlined />\r\n          <Link to={`${match.url}`}>League Summary</Link>\r\n        </Menu.Item>\r\n        <SubMenu\r\n          key=\"gamesSub\"\r\n          title={\r\n            <span>\r\n              <GoldOutlined />\r\n              <span>Games</span>\r\n            </span>\r\n          }\r\n        >\r\n          {leagueGames.map((game, i) => (\r\n            <Menu.Item key={game.gameID.toString()}>\r\n              <Link to={`${match.url}${routes.GAME}/${game.gameID}`}>\r\n                Game {game.gameID}\r\n              </Link>\r\n            </Menu.Item>\r\n          ))}\r\n\r\n          <Menu.Item key=\"new_game\">\r\n            <PlusOutlined />\r\n            <span>New Game</span>\r\n          </Menu.Item>\r\n        </SubMenu>\r\n        {newGameDialog && (\r\n          <Dialog\r\n            dialog={Dialogs.NEW_GAME}\r\n            dialogProps={{\r\n              visible: true,\r\n              onAfterClose: this.newGameDialogHandler,\r\n            }}\r\n          />\r\n        )}\r\n        <Menu.Item key=\"main_menu\">\r\n          <ExportOutlined className={'rotate-180'} />\r\n          <Link to={`/`}>To Main Menu</Link>\r\n        </Menu.Item>\r\n      </Menu>\r\n    );\r\n  }\r\n\r\n  private toggleDrawer = () => {\r\n    this.setState({\r\n      drawerVisible: !this.state.drawerVisible,\r\n    });\r\n  };\r\n\r\n  private setLoaderState = (loading: boolean) => {\r\n    this.setState({ loading });\r\n  };\r\n\r\n  private handleMenuItemClick(item: MenuInfo): void {\r\n    const key = item.key;\r\n\r\n    if (key === 'new_game') {\r\n      if (this.isAddGameOk()) {\r\n        // trying to block the leauge database by adding to the league blockedBy attribute value with the user Id\r\n        // together with the database rules preventing other user from updating the league data\r\n        this.blockLeague().then(\r\n          () => {\r\n            this.setNewGameDialogState(true);\r\n          },\r\n          (error: Error | null) => {\r\n            console.error(error);\r\n            message.warning('One of the players is blocking!!');\r\n          }\r\n        );\r\n      } else {\r\n        message.warning('Last Game is not finished yet!!');\r\n      }\r\n    } else if (key !== 'main_menu' && key !== this.state.menuSelected) {\r\n      this.setState({ menuSelected: key });\r\n    }\r\n\r\n    setTimeout(this.toggleDrawer, 200);\r\n  }\r\n\r\n  private blockLeague() {\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    return this.leagueRef.child('blockedBy').set(userId);\r\n  }\r\n\r\n  private unblockLeague() {\r\n    this.leagueRef.update({\r\n      blockedBy: null,\r\n    });\r\n  }\r\n\r\n  private setNewGameDialogState = (show: boolean) => {\r\n    this.setState({\r\n      newGameDialog: show,\r\n    });\r\n  };\r\n\r\n  private newGameDialogHandler(gameMode: GameMode) {\r\n    this.setState({\r\n      newGameDialog: false,\r\n    });\r\n\r\n    if (gameMode === 'local') {\r\n      this.unblockLeague();\r\n      this.addGame(gameMode);\r\n    } else if (gameMode === 'remote') {\r\n      this.setState({ loading: true });\r\n      // ask other players to join the game\r\n      const { league, leagueGames } = this.state;\r\n      const newGameId = leagueGames.length + 1;\r\n\r\n      LeagueService.invitePlayers({ ...league }, newGameId).then(() => {\r\n        console.log('inventation resolved- ok to add game');\r\n        this.addGame('remote');\r\n        this.setState({ loading: false });\r\n      });\r\n    }\r\n  }\r\n\r\n  private addGame = (gameMode: GameMode) => {\r\n    const { league, leagueGames } = this.state;\r\n    const { leagueID, players, blockedBy } = league;\r\n\r\n    const { history, match } = this.props;\r\n    const newGameId = leagueGames.length + 1;\r\n\r\n    const newGameKey = fire.database().ref().child('games').push().key;\r\n\r\n    const gameTpl = gameDataTpl(players as IPlayer[], gameMode);\r\n    const updates: { [key: string]: any } = {};\r\n\r\n    updates[`/games/${newGameKey}`] = {\r\n      gameID: newGameId,\r\n      dealer: gameMode === 'remote' && blockedBy ? blockedBy : '',\r\n      ...gameTpl.gameData,\r\n    };\r\n    updates[`/leagueGames/_${leagueID}/${newGameKey}`] = {\r\n      gameID: newGameId,\r\n      gameMode,\r\n      playersOrder: this.addGamePlayers(gameMode, players),\r\n      status: GAME_STATUS.ACTIVE,\r\n    };\r\n    updates[`/leagueGamesSummary/_${leagueID}/${newGameKey}`] = {\r\n      ...gameTpl.gameSummary,\r\n    };\r\n\r\n    fire\r\n      .database()\r\n      .ref()\r\n      .update(updates, (error) => {\r\n        if (!error) {\r\n          this.setState({ menuSelected: `${newGameId}` });\r\n          history.push(`${match.url}${routes.GAME}/${newGameId}`);\r\n        }\r\n      });\r\n  };\r\n\r\n  private addGamePlayers(gameMode: GameMode, players?: IPlayer[]) {\r\n    return players && gameMode === 'remote' ? shufflePlayers(players) : null;\r\n  }\r\n\r\n  private isAddGameOk() {\r\n    const { leagueGames } = this.state;\r\n    const lastGame = leagueGames[leagueGames.length - 1];\r\n\r\n    return !lastGame || lastGame.status === GAME_STATUS.FINISHED;\r\n  }\r\n}\r\n\r\nconst authCondition = (authUser: UserContext) => !!authUser;\r\n\r\nexport default withAuthorization<ILeagueProps>(authCondition)(League);\r\n","import { INPUT_MODE } from '../constants/states';\r\nimport {\r\n  GameMode,\r\n  GAME_STATUS,\r\n  IRoundData,\r\n  IBaseRoundData,\r\n  IGamePlayersSummary,\r\n} from '../models/IGameModel';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\nimport { IGameDataTpl } from '../models/ILeagueModel';\r\n\r\nexport default function gameDataTpl(\r\n  players: IPlayer[],\r\n  gameMode: GameMode\r\n): IGameDataTpl {\r\n  const rounds: IRoundData[] = [];\r\n  const initRoundData: IBaseRoundData = {\r\n    segment: '',\r\n    totalBids: '',\r\n    trump: '',\r\n    check: false,\r\n    factor: 1,\r\n    fell: false,\r\n    highestBidder: '',\r\n    inputMode: INPUT_MODE.BID,\r\n    score0: '',\r\n    aggregateScore0: '',\r\n    bid0: '',\r\n    won0: '',\r\n    score1: '',\r\n    aggregateScore1: '',\r\n    bid1: '',\r\n    won1: '',\r\n    score2: '',\r\n    aggregateScore2: '',\r\n    bid2: '',\r\n    won2: '',\r\n    score3: '',\r\n    aggregateScore3: '',\r\n    bid3: '',\r\n    won3: '',\r\n  };\r\n\r\n  if (gameMode === 'remote') {\r\n    initRoundData.currentHand = 1;\r\n  }\r\n\r\n  for (let i = 0; i < 13; i++) {\r\n    rounds.push({ round: i + 1, ...initRoundData });\r\n  }\r\n\r\n  const rateInit = {\r\n    wins: 0,\r\n    total: 0,\r\n  };\r\n\r\n  return {\r\n    gameData: {\r\n      rounds,\r\n      currentRound: 1,\r\n      totalScore0: 0,\r\n      totalScore1: 0,\r\n      totalScore2: 0,\r\n      totalScore3: 0,\r\n      status: GAME_STATUS.ACTIVE,\r\n    },\r\n    gameSummary: {\r\n      players: players.reduce((summaryObj: IGamePlayersSummary, player) => {\r\n        summaryObj[player.key] = {\r\n          leagueScore: 0,\r\n          successRate: rateInit,\r\n          successRateHB: rateInit,\r\n          successRateOver: rateInit,\r\n          successRateUnder: rateInit,\r\n          successRateNT: rateInit,\r\n          successRateLastBidder: rateInit,\r\n        };\r\n\r\n        return summaryObj;\r\n      }, {}),\r\n    },\r\n  };\r\n}\r\n","import React, { Component } from 'react';\nimport { withRouter, Route } from 'react-router-dom';\nimport NotificationService from './services/NotificationSrv';\nimport { fire } from './firebase';\nimport cards from './cards.png';\nimport phoneImg from './images/phone.png';\nimport * as routes from './constants/routes';\nimport withAuthentication from './authentication/withAuthentication';\nimport './App.scss';\nimport 'antd/dist/antd.css';\nimport Login from './authentication/Login';\nimport SignUp from './authentication/SignUp';\nimport Main from './main/Main';\nimport League from './league/League.tsx';\nimport { addListener, isMobileBrowser } from './utils/Utils';\nimport { Dialogs } from './constants/dialogs';\nimport Dialog from './dialogs/Dialog';\nimport LeagueService from './services/LeagueSrv';\nimport Loader from './common/loader/Loader';\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      inlineHeader: false,\n      showGameInvite: false,\n      loader: false,\n    };\n\n    this.toggleHeaderInline = this.toggleHeaderInline.bind(this);\n    this.handleWindowSizeChange = this.handleWindowSizeChange.bind(this);\n  }\n\n  // set main header state by router value\n  // if in main menu page header is bigger\n  toggleHeaderInline(inline = true) {\n    this.setState({\n      inlineHeader: inline,\n    });\n  }\n\n  // set if view is mobile size\n  handleWindowSizeChange() {\n    this.setState({\n      // isMobile: window.innerWidth < 1095,\n    });\n  }\n\n  // init window resize listener\n  listenToWinResize(callback) {\n    return addListener(window, 'resize', callback);\n  }\n\n  componentWillMount() {\n    const { pathname } = this.props.location;\n    // set initial header state\n    this.toggleHeaderInline(pathname !== '/');\n\n    // listen to routing changes\n    this.unlistenHistory = this.props.history.listen((location, action) => {\n      const { pathname } = location;\n      this.toggleHeaderInline(pathname !== '/' && pathname !== '/login');\n    });\n\n    this.unlistenWinResize = this.listenToWinResize(\n      this.handleWindowSizeChange\n    );\n  }\n\n  componentWillUnmount() {\n    this.unlistenHistory();\n    this.unlistenWinResize();\n  }\n\n  componentDidMount() {\n    fire.auth().onAuthStateChanged((authUser) => {\n      if (authUser) {\n        NotificationService.registerGameInvite(this.onGameInvite);\n      }\n    });\n  }\n\n  render() {\n    const { inlineHeader, showGameInvite, invite, loader } = this.state;\n\n    return (\n      <div\n        className={`app-wrapper ${\n          isMobileBrowser() ? 'mobile-mode' : 'desktop-mode'\n        }`}\n      >\n        <img src={phoneImg} />\n        <div className={`app ${inlineHeader ? 'inline-header' : ''}`}>\n          <header id=\"app-header\">\n            <img src={cards} className=\"app-logo\" alt=\"logo\" />\n            <h1 className=\"app-title\">Sub Whist</h1>\n          </header>\n          {loader && <Loader className=\"with-mask\" />}\n          <div className=\"app-content\">\n            <Route exact path=\"/\" component={Main} />\n            <Route exact path={routes.SIGN_IN} component={Login} />\n            <Route exact path={routes.SIGN_UP} component={SignUp} />\n            <Route\n              path={`${routes.LEAGUE}/:leagueID`}\n              render={(props) => <League {...props} screenSize={442} />}\n            />\n          </div>\n        </div>\n        {showGameInvite && (\n          <Dialog\n            dialog={Dialogs.GAME_INVITE}\n            dialogProps={{\n              visible: true,\n              invite,\n              onAfterClose: this.closeGameInvite,\n              onOk: this.acceptGameInvite,\n            }}\n          />\n        )}\n      </div>\n    );\n  }\n\n  onGameInvite = (invite) => {\n    this.setState({\n      showGameInvite: true,\n      invite,\n    });\n  };\n\n  acceptGameInvite = () => {\n    const { invite } = this.state;\n\n    this.setState({ loader: true });\n    LeagueService.acceptGameInvite(invite).then(\n      () => {\n        this.setState({ loader: false });\n        const { history } = this.props;\n        const { leagueID, newGameId } = invite;\n\n        setTimeout(\n          () => history.push(`${routes.LEAGUE}/${leagueID}/game/${newGameId}`),\n          500\n        );\n      },\n      () => {\n        this.setState({ loader: false });\n      }\n    );\n  };\n\n  closeGameInvite = () => {\n    this.setState({\n      showGameInvite: false,\n    });\n  };\n}\n\nexport default withRouter(withAuthentication(App));\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"pure-swipe\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport \"./index.scss\";\n\nReactDOM.render(\n  <Router basename={process.env.PUBLIC_URL}>\n    <App />\n  </Router>,\n  document.getElementById(\"root\")\n);\nregisterServiceWorker();\n"],"sourceRoot":""}