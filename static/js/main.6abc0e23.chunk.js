(this.webpackJsonpwhist=this.webpackJsonpwhist||[]).push([[0],{134:function(e,t,a){e.exports=a.p+"static/media/2-C.8a51f4b1.svg"},166:function(e,t,a){e.exports=a.p+"static/media/2-D.dd5bdb07.svg"},167:function(e,t,a){e.exports=a.p+"static/media/2-H.15c2e192.svg"},168:function(e,t,a){e.exports=a.p+"static/media/2-J.2efb9493.svg"},169:function(e,t,a){e.exports=a.p+"static/media/2-S.bce46c7b.svg"},170:function(e,t,a){e.exports=a.p+"static/media/3-C.6f681593.svg"},171:function(e,t,a){e.exports=a.p+"static/media/3-D.15244443.svg"},172:function(e,t,a){e.exports=a.p+"static/media/3-H.5d6c501c.svg"},173:function(e,t,a){e.exports=a.p+"static/media/3-S.56340b99.svg"},174:function(e,t,a){e.exports=a.p+"static/media/4-C.b4c5fedb.svg"},175:function(e,t,a){e.exports=a.p+"static/media/4-D.c1449960.svg"},176:function(e,t,a){e.exports=a.p+"static/media/4-H.a23231b3.svg"},177:function(e,t,a){e.exports=a.p+"static/media/4-S.10c84208.svg"},178:function(e,t,a){e.exports=a.p+"static/media/5-C.0eb86f9c.svg"},179:function(e,t,a){e.exports=a.p+"static/media/5-D.152f12ae.svg"},180:function(e,t,a){e.exports=a.p+"static/media/5-H.8196387a.svg"},181:function(e,t,a){e.exports=a.p+"static/media/5-S.143b7322.svg"},182:function(e,t,a){e.exports=a.p+"static/media/6-C.4cb8bdad.svg"},183:function(e,t,a){e.exports=a.p+"static/media/6-D.bd92854e.svg"},184:function(e,t,a){e.exports=a.p+"static/media/6-H.19f2ecf2.svg"},185:function(e,t,a){e.exports=a.p+"static/media/6-S.ade7c7e4.svg"},186:function(e,t,a){e.exports=a.p+"static/media/7-C.d8d8520b.svg"},187:function(e,t,a){e.exports=a.p+"static/media/7-D.204f8d6f.svg"},188:function(e,t,a){e.exports=a.p+"static/media/7-H.f0681bb0.svg"},189:function(e,t,a){e.exports=a.p+"static/media/7-S.f6bb3b39.svg"},190:function(e,t,a){e.exports=a.p+"static/media/8-C.fe3de886.svg"},191:function(e,t,a){e.exports=a.p+"static/media/8-D.b6635e40.svg"},192:function(e,t,a){e.exports=a.p+"static/media/8-H.eac2a810.svg"},193:function(e,t,a){e.exports=a.p+"static/media/8-S.6e2329eb.svg"},194:function(e,t,a){e.exports=a.p+"static/media/9-C.a91a0922.svg"},195:function(e,t,a){e.exports=a.p+"static/media/9-D.2c4bfcfc.svg"},196:function(e,t,a){e.exports=a.p+"static/media/9-H.75cb4cf1.svg"},197:function(e,t,a){e.exports=a.p+"static/media/9-S.30d03378.svg"},198:function(e,t,a){e.exports=a.p+"static/media/10-C.90a1d2da.svg"},199:function(e,t,a){e.exports=a.p+"static/media/10-D.1e7ceb93.svg"},200:function(e,t,a){e.exports=a.p+"static/media/10-H.a99c411d.svg"},201:function(e,t,a){e.exports=a.p+"static/media/10-S.8b991ebd.svg"},202:function(e,t,a){e.exports=a.p+"static/media/11-C.e4d58ae7.svg"},203:function(e,t,a){e.exports=a.p+"static/media/11-D.b2cc7b26.svg"},204:function(e,t,a){e.exports=a.p+"static/media/11-H.c357eab3.svg"},205:function(e,t,a){e.exports=a.p+"static/media/11-S.e9f02fbd.svg"},206:function(e,t,a){e.exports=a.p+"static/media/12-C.483c9a18.svg"},207:function(e,t,a){e.exports=a.p+"static/media/12-D.e34fab0b.svg"},208:function(e,t,a){e.exports=a.p+"static/media/12-H.ddc0d874.svg"},209:function(e,t,a){e.exports=a.p+"static/media/12-S.84f4e7a8.svg"},210:function(e,t,a){e.exports=a.p+"static/media/13-C.f612b546.svg"},211:function(e,t,a){e.exports=a.p+"static/media/13-D.0ff22a04.svg"},212:function(e,t,a){e.exports=a.p+"static/media/13-H.60e7d399.svg"},213:function(e,t,a){e.exports=a.p+"static/media/13-S.22bb59a1.svg"},214:function(e,t,a){e.exports=a.p+"static/media/14-C.49a458de.svg"},215:function(e,t,a){e.exports=a.p+"static/media/14-D.3fde324e.svg"},216:function(e,t,a){e.exports=a.p+"static/media/14-H.e892e743.svg"},217:function(e,t,a){e.exports=a.p+"static/media/14-S.78374225.svg"},225:function(e,t,a){},239:function(e,t,a){e.exports=a.p+"static/media/cards.03003d3d.png"},240:function(e,t,a){e.exports=a.p+"static/media/phone.b4836590.png"},246:function(e,t,a){e.exports=a.p+"static/media/playerTurn.303a9497.mp3"},251:function(e,t,a){e.exports=a(389)},261:function(e,t,a){},355:function(e,t,a){},363:function(e,t,a){},364:function(e,t,a){},370:function(e,t,a){},371:function(e,t,a){},378:function(e,t,a){},379:function(e,t,a){},380:function(e,t,a){},381:function(e,t,a){},382:function(e,t,a){},383:function(e,t,a){},384:function(e,t,a){var n={"./10-C.svg":198,"./10-D.svg":199,"./10-H.svg":200,"./10-S.svg":201,"./11-C.svg":202,"./11-D.svg":203,"./11-H.svg":204,"./11-S.svg":205,"./12-C.svg":206,"./12-D.svg":207,"./12-H.svg":208,"./12-S.svg":209,"./13-C.svg":210,"./13-D.svg":211,"./13-H.svg":212,"./13-S.svg":213,"./14-C.svg":214,"./14-D.svg":215,"./14-H.svg":216,"./14-S.svg":217,"./2-C.svg":134,"./2-D.svg":166,"./2-H.svg":167,"./2-J.svg":168,"./2-S.svg":169,"./3-C.svg":170,"./3-D.svg":171,"./3-H.svg":172,"./3-S.svg":173,"./4-C.svg":174,"./4-D.svg":175,"./4-H.svg":176,"./4-S.svg":177,"./5-C.svg":178,"./5-D.svg":179,"./5-H.svg":180,"./5-S.svg":181,"./6-C.svg":182,"./6-D.svg":183,"./6-H.svg":184,"./6-S.svg":185,"./7-C.svg":186,"./7-D.svg":187,"./7-H.svg":188,"./7-S.svg":189,"./8-C.svg":190,"./8-D.svg":191,"./8-H.svg":192,"./8-S.svg":193,"./9-C.svg":194,"./9-D.svg":195,"./9-H.svg":196,"./9-S.svg":197};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=384},385:function(e,t,a){},387:function(e,t,a){},388:function(e,t,a){},389:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"createUser",(function(){return E})),a.d(n,"signInUser",(function(){return S})),a.d(n,"signOut",(function(){return w}));var r={};a.r(r),a.d(r,"usersRef",(function(){return C})),a.d(r,"leaguesRef",(function(){return O})),a.d(r,"doCreateUser",(function(){return k})),a.d(r,"onceGetUsers",(function(){return D})),a.d(r,"onceGetLeagues",(function(){return j}));var o=a(0),c=a.n(o),i=a(34),s=a.n(i),l=(a(256),a(16)),u=a(17),d=a(29),m=a(24),f=a(23),h=a(32),g=a(146),p=a.n(g),v=(a(257),a(259),p.a.initializeApp({apiKey:"AIzaSyCBrRBBfQTCAF5rqj_A8fXN4jMZlZ310RM",authDomain:"whist-d4d9b.firebaseapp.com",databaseURL:"https://whist-d4d9b.firebaseio.com",projectId:"whist-d4d9b",storageBucket:"whist-d4d9b.appspot.com",messagingSenderId:"630677405872"})),b=p.a.auth(),y=p.a.database(),E=function(e,t){return b.createUserWithEmailAndPassword(e,t)},S=function(e,t){return b.signInWithEmailAndPassword(e,t)},w=function(){return b.signOut()},C=y.ref("users"),O=y.ref("leagues"),k=function(e,t){return y.ref("users/".concat(e)).set(t)},D=function(){return C.once("value")},j=function(){return O.once("value")},R=function(){function e(){Object(l.a)(this,e),this.handlers=[]}return Object(u.a)(e,[{key:"on",value:function(e){this.handlers.push(e)}},{key:"off",value:function(e){this.handlers=this.handlers.filter((function(t){return t!==e}))}},{key:"trigger",value:function(e){this.handlers.slice(0).forEach((function(t){return t(e)}))}}]),e}(),N=new(function(){function e(){Object(l.a)(this,e),this.gameInviteEventEmitter=new R}return Object(u.a)(e,[{key:"registerGameInvite",value:function(e){var t,a=this;this.gameInviteEventEmitter.on(e);var n=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid,r=v.database().ref().child("notifications/gameInvites");r.child("/invitedPlayers/".concat(n)).on("child_added",(function(e){r.child(e.val()).once("value",(function(e){console.log(e.val()),a.gameInviteEventEmitter.trigger(e.val())}))}))}}]),e}()),x=a(239),I=a.n(x),M=a(240),P=a.n(M),T=c.a.createContext(null),L=function(e){return function(t){Object(m.a)(n,t);var a=Object(f.a)(n);function n(){var e;Object(l.a)(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={authUser:null},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;v.auth().onAuthStateChanged((function(t){t?e.setState({authUser:t}):e.setState({authUser:null})}))}},{key:"render",value:function(){var t=this.state.authUser;return c.a.createElement(T.Provider,{value:t},c.a.createElement(e,this.props))}}]),n}(c.a.Component)},B=(a(261),a(262),a(61),a(27)),A=(a(153),a(55)),H=(a(154),a(69)),G=a(49),U=a(392),W=a(393),_=a(394),V=(a(225),H.a.Item),F=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(l.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={isLoading:!1},e.handleSubmit=function(t){e.setState({isLoading:!0});var a=e.props.history,r=t.email,o=t.password;n.signInUser(r,o).then((function(e){console.log(e),a.push("/")})).catch((function(t){alert(t.message),e.setState({isLoading:!1})}))},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.history,a=this.state.isLoading;return c.a.createElement(T.Consumer,null,(function(n){return n?c.a.createElement("div",{style:{textAlign:"center",marginTop:"50px"}},c.a.createElement("p",null,"You are already logged in,"),c.a.createElement(B.a,{type:"primary",size:"small",onClick:function(){return t.goBack()},icon:c.a.createElement(_.a,null)},"Go back")," ","or ",c.a.createElement(G.b,{to:"/"},"Go Home")):c.a.createElement(H.a,{onFinish:e.handleSubmit,className:"login-form"},c.a.createElement(V,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your email!"}]},c.a.createElement(A.a,{prefix:c.a.createElement(U.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"email",size:"large"})),c.a.createElement(V,{name:"password",rules:[{required:!0,message:"Please input your Password!"}]},c.a.createElement(A.a,{prefix:c.a.createElement(W.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"password",size:"large"})),c.a.createElement(V,null,c.a.createElement(B.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button",loading:a},"Log in"),"Or ",c.a.createElement(G.b,{to:"/signup"},"register now!")))}))}}]),a}(c.a.Component),z=Object(h.e)(F),q=a(395),K=a(396),Y=H.a.Item,X=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var o;return Object(l.a)(this,a),(o=t.call(this,e)).formRef=c.a.createRef(),o.handleConfirmBlur=function(e){var t=e.target.value;o.setState({confirmDirty:o.state.confirmDirty||!!t})},o.compareToFirstPassword=function(e,t,a){var n=o.formRef.current;n&&t&&t!==n.getFieldValue("password")?a("Two passwords that you enter is inconsistent!"):a()},o.validateToNextPassword=function(e,t,a){var n=o.formRef.current;t&&o.state.confirmDirty&&n&&n.validateFields(["confirm"]),a()},o.handleSubmit=function(e){o.setState({isLoading:!0});var t=e.name,a=e.nickname,c=e.email,i=e.password;n.createUser(c,i).then((function(e){e&&e.user&&r.doCreateUser(e.user.uid,{name:t,nickname:a,email:c}).then((function(){o.props.history.push("/")})).catch((function(e){alert(e.message),o.setState({isLoading:!1})}))})).catch((function(e){alert(e.message),o.setState({isLoading:!1})}))},o.state={confirmDirty:!1,isLoading:!1},o}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.isLoading;return c.a.createElement(H.a,{onFinish:this.handleSubmit,ref:this.formRef,className:"login-form"},c.a.createElement(Y,{name:"name",rules:[{required:!0,message:"Please input your name!"}]},c.a.createElement(A.a,{prefix:c.a.createElement(q.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Name",size:"large"})),c.a.createElement(Y,{name:"nickname",rules:[{required:!0,message:"Please input your Nickname!"}]},c.a.createElement(A.a,{prefix:c.a.createElement(K.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Nickname",size:"large"})),c.a.createElement(Y,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your email!"}]},c.a.createElement(A.a,{prefix:c.a.createElement(U.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email",size:"large"})),c.a.createElement(Y,{name:"password",rules:[{required:!0,message:"Please input your Password!"},{validator:this.validateToNextPassword}]},c.a.createElement(A.a,{prefix:c.a.createElement(W.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",size:"large"})),c.a.createElement(Y,{name:"confirm",rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]},c.a.createElement(A.a,{prefix:c.a.createElement(W.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Confirm password",onBlur:this.handleConfirmBlur,size:"large"})),c.a.createElement(Y,null,c.a.createElement(B.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button",loading:e},"Sign Up")))}}]),a}(c.a.Component),J=Object(h.e)(X),Q=(a(116),a(73)),Z=function(e){return function(t){var a=function(a){Object(m.a)(r,a);var n=Object(f.a)(r);function r(){return Object(l.a)(this,r),n.apply(this,arguments)}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var t=this;v.auth().onAuthStateChanged((function(a){e(a)||t.props.history.push("/login")}))}},{key:"render",value:function(){var e=this;return c.a.createElement(T.Consumer,null,(function(a){return a?c.a.createElement(t,e.props):c.a.createElement("div",{className:"full-view loader"},c.a.createElement(Q.a,{size:"large",style:{width:"100%",position:"relative",top:"50%"}}))}))}}]),r}(c.a.Component);return Object(h.e)(a)}},$=a(25),ee=(a(80),a(47)),te=a(15),ae=(a(236),a(78)),ne=H.a.Item,re=ae.a.Option,oe=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).leagueID=void 0,n.formRef=c.a.createRef(),n.onCreateLeague=function(){var e=n.formRef.current,t=n.state.users;e&&e.validateFields(["title","description","players"]).then((function(e){var a=e.description;n.setState({savingLeagueLoader:!0});var r=e.players.map((function(e){return{key:e,nickname:t[e].nickname}}));j().then((function(t){var o=t.val()&&t.val().lastID,c=o?o+1:1;v.database().ref("leagues/list/_"+c).set(Object(te.a)(Object(te.a)({},e),{},{players:r,description:a||"",leagueID:c,active:!0})).then((function(){return n.setNewLeagueID(c)})),v.database().ref("leagues/lastID").set(c)}))}))},n.setNewLeagueID=function(e){n.leagueID=e,n.closeModal()},n.closeModal=function(){n.setState({showDialog:!1})},n.afterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&e(n.leagueID)},n.state={showDialog:n.props.visible,users:{},count:0,loading:!0,savingLeagueLoader:!1},n}return Object(u.a)(a,[{key:"fetchPlayers",value:function(){var e=this;D().then((function(t){t.val()?e.setState({users:t.val(),loading:!1}):e.setState({loading:!1})}))}},{key:"componentDidMount",value:function(){this.fetchPlayers()}},{key:"render",value:function(){var e=this.state,t=e.showDialog,a=e.users,n=e.loading,r=e.savingLeagueLoader;return c.a.createElement(ee.a,{title:"Create League",visible:t,destroyOnClose:!0,maskClosable:!1,confirmLoading:r,onOk:this.onCreateLeague,onCancel:this.closeModal,afterClose:this.afterClose,okText:"Save & Play",getContainer:".app"},c.a.createElement(H.a,{ref:this.formRef,layout:"vertical"},c.a.createElement(ne,{label:"Title",name:"title",rules:[{required:!0,message:"Please input the league title!"}]},c.a.createElement(A.a,null)),c.a.createElement(ne,{label:"Description",name:"description"},c.a.createElement(A.a,{type:"textarea"})),c.a.createElement(ne,{label:"Players",name:"players",rules:[{required:!0,len:4,type:"array"}]},c.a.createElement(ae.a,{mode:"multiple",notFoundContent:n?c.a.createElement(Q.a,{size:"small"}):null},Object.keys(a).map((function(e){return c.a.createElement(re,{key:e,value:e},a[e].nickname)}))))))}}]),a}(o.Component),ce=(a(390),a(148)),ie=(a(355),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showDialog:e.props.visible},e}return Object(u.a)(a,[{key:"closeModal",value:function(e){this.leagueID=e,this.setState({showDialog:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.afterClose,n=t.activeLeagues,r=this.state.showDialog;return c.a.createElement(ee.a,{title:"Resume League",visible:r,destroyOnClose:!0,maskClosable:!1,width:"600px",footer:null,onCancel:function(){return e.closeModal()},afterClose:function(){return a(e.leagueID)}},c.a.createElement("p",null,"List of open leagues"),c.a.createElement(ce.b,{itemLayout:"horizontal",dataSource:n,renderItem:function(t){return c.a.createElement(ce.b.Item,null,c.a.createElement(ce.b.Item.Meta,{title:c.a.createElement("a",{onClick:function(){return e.closeModal(t.leagueID)}},t.title)}))}}))}}]),a}(o.Component)),se=Object(h.e)(ie),le=a(59),ue=a(43),de=a(79),me=function(){return!!window.navigator.maxTouchPoints||"ontouchstart"in document.documentElement};function fe(e,t,a){return e.addEventListener(t,a),function(){e.removeEventListener(t,a)}}var he=function(e){for(var t=Object(ue.a)(e),a=t.length-1;a>0;a--){var n=Math.floor(Math.random()*(a+1)),r=[t[n],t[a]];t[a]=r[0],t[n]=r[1]}return t},ge=(a(363),{stiffness:180,damping:10}),pe={stiffness:120,damping:17};function ve(e,t,a){return Math.max(Math.min(e,a),t)}var be,ye,Ee=["#EF767A","#9acaff","#49BEAA","#49DCB1"],Se=[[80,0],[160,80],[80,160],[0,80]],we=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleTouchStart=function(e,t,a){n.handleMouseDown(e,t,a.touches[0])},n.handleTouchMove=function(e){e.preventDefault(),n.handleMouseMove(e.touches[0])},n.handleMouseMove=function(e){var t=e.pageX,a=e.pageY,r=n.state,o=r.order,c=r.lastPress,i=r.isPressed,s=Object(le.a)(r.mouseCircleDelta,2),l=s[0],u=s[1];if(i){var d=[t-l,a-u],m=ve(Math.round(d[0]/80),0,2),f=ve(Math.round(d[1]/80),0,Math.floor(2)),h=null;1===m&&0===f?h=0:2===m&&1===f?h=1:1===m&&2===f?h=2:0===m&&1===f&&(h=3);var g=o.findIndex((function(e){return e.key===c})),p="number"===typeof h&&h!==g&&function(e,t,a){var n=Object(ue.a)(e);if(Math.abs(t-a)===e.length-1){var r=[n[t],n[a]];n[a]=r[0],n[t]=r[1]}else if(t<a&&a-t>1){var o=n[t];n.splice(t,1),n.unshift(n.pop()),n.splice(a,0,o)}else{var c=n[t];n.splice(t,1),n.splice(a,0,c)}return n}(o,g,h);n.setState({mouseXY:d,order:p||Object(ue.a)(o),from:p?g:n.state.from,to:p?h:n.state.to})}},n.handleMouseDown=function(e,t,a){var r=Object(le.a)(t,2),o=r[0],c=r[1],i=a.pageX,s=a.pageY;n.setState({lastPress:e,isPressed:!0,mouseCircleDelta:[i-o,s-c],mouseXY:[o,c]})},n.handleMouseUp=function(){if(n.setState({isPressed:!1,mouseCircleDelta:[0,0]}),"function"===typeof n.props.onChange){var e=n.state,t=e.order,a=e.from,r=e.to;n.props.onChange(t,a,r)}},n.state={mouseXY:[0,0],mouseCircleDelta:[0,0],lastPress:null,isPressed:!1,order:e.players,from:null,to:null},n.colors=e.players.reduce((function(e,t,a){return e[t.key]=Ee[a],e}),{}),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.unListenTouchmove=fe(window,"touchmove",this.handleTouchMove),this.unListenTouchend=fe(window,"touchend",this.handleMouseUp),this.unListenMousemove=fe(window,"mousemove",this.handleMouseMove),this.unListenMouseup=fe(window,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.unListenTouchmove(),this.unListenTouchend(),this.unListenMousemove(),this.unListenMouseup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.order,n=t.lastPress,r=t.isPressed,o=t.mouseXY;return c.a.createElement("div",{className:"drag-pad"},c.a.createElement("div",{className:"drag-pad-content"},a.map((function(t,i){var s,l,u,d=a.findIndex((function(e){return e.key===t.key}));if(t.key===n&&r){var m=Object(le.a)(o,2);l=m[0],u=m[1],s={translateX:l,translateY:u,scale:Object(de.spring)(1.2,ge),boxShadow:Object(de.spring)((l-95)/15,ge)}}else{var f=Object(le.a)(Se[d],2);l=f[0],u=f[1],s={translateX:Object(de.spring)(l,pe),translateY:Object(de.spring)(u,pe),scale:Object(de.spring)(1,ge),boxShadow:Object(de.spring)((l-95)/15,ge)}}return c.a.createElement(de.Motion,{key:t.key,style:s},(function(a){var r=a.translateX,o=a.translateY,i=a.scale,s=a.boxShadow;return c.a.createElement("div",{onMouseDown:e.handleMouseDown.bind(null,t.key,[l,u]),onTouchStart:e.handleTouchStart.bind(null,t.key,[l,u]),className:"player-icon",style:{backgroundColor:e.colors[t.key],WebkitTransform:"translate3d(".concat(r,"px, ").concat(o,"px, 0) scale(").concat(i,")"),transform:"translate3d(".concat(r,"px, ").concat(o,"px, 0) scale(").concat(i,")"),zIndex:t.key===n?99:d,boxShadow:"".concat(s,"px 5px 5px rgba(0,0,0,0.5)")}},c.a.createElement(q.a,null),c.a.createElement("span",null,t.nickname))}))}))))}}]),a}(c.a.Component),Ce=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={showDialog:e.visible,order:e.players},n.handleOnCancel=n.handleOnCancel.bind(Object(d.a)(n)),n.handleOnOk=n.handleOnOk.bind(Object(d.a)(n)),n.afterClose=n.afterClose.bind(Object(d.a)(n)),n.handleDragChange=n.handleDragChange.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.players,t=this.state.showDialog;return c.a.createElement(ee.a,{title:"Reorder Players",visible:t,destroyOnClose:!0,maskClosable:!1,width:"600px",onOk:this.handleOnOk,onCancel:this.handleOnCancel,afterClose:this.afterClose},c.a.createElement(we,{players:e,onChange:this.handleDragChange}))}},{key:"handleOnCancel",value:function(){this.setState({showDialog:!1})}},{key:"handleOnOk",value:function(){this.setState({showDialog:!1});var e=this.props.onOk;"function"===typeof e&&e(this.state.order)}},{key:"afterClose",value:function(){var e=this.props.onAfterClose;"function"===typeof e&&e()}},{key:"handleDragChange",value:function(e){this.setState({order:e})}}]),a}(o.Component),Oe=(a(364),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).setGameMode=function(e){return function(){n.setState({showDialog:!1,modeSelected:e})}},n.handleAfterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&n.state.modeSelected&&e(n.state.modeSelected)},n.state={showDialog:e.visible},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.showDialog;return c.a.createElement(ee.a,{wrapClassName:"remote-local-dialog",visible:e,destroyOnClose:!0,closable:!1,maskClosable:!1,centered:!0,width:"300px",okText:"Frontal",cancelText:"OnLine",onOk:this.setGameMode("local"),onCancel:this.setGameMode("remote"),afterClose:this.handleAfterClose,bodyStyle:{display:"none"}})}}]),a}(c.a.Component)),ke=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleOk=function(){n.setState({showDialog:!1});var e=n.props.onOk;"function"===typeof e&&e()},n.handleCancel=function(){n.setState({showDialog:!1})},n.handleAfterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&e()},n.state={showDialog:e.visible},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.showDialog,t=this.props.invite,a=t.leagueTitle,n=t.newGameId,r=t.inviter;return c.a.createElement(ee.a,{title:"Game Invite",visible:e,destroyOnClose:!0,closable:!0,maskClosable:!1,centered:!0,width:"300px",okText:"Join",cancelText:"Cancel",onOk:this.handleOk,onCancel:this.handleCancel,afterClose:this.handleAfterClose},c.a.createElement("div",null,"".concat(r.nickname," from ").concat(a," invites you to join game ").concat(n)))}}]),a}(c.a.Component);!function(e){e.NEW_LEAGUE="NEW_LEAGUE",e.RESUME_LEAGUE="RESUME_LEAGUE",e.REORDER_PLAYERS="REORDER_PLAYERS",e.NEW_GAME="NEW_GAME",e.GAME_INVITE="GAME_INVITE"}(ye||(ye={}));var De,je,Re,Ne=(be={},Object($.a)(be,ye.NEW_LEAGUE,oe),Object($.a)(be,ye.RESUME_LEAGUE,se),Object($.a)(be,ye.REORDER_PLAYERS,Ce),Object($.a)(be,ye.NEW_GAME,Oe),Object($.a)(be,ye.GAME_INVITE,ke),be),xe=function(e){var t=e.dialog,a=e.dialogProps,n=Ne[t];return c.a.createElement(n,a)},Ie=function(e){return c.a.createElement("ul",{className:"app-menu"},e.items.map((function(e,t){var a=e.onClick,n=e.text,r=e.dialog,o=e.dialogProps,i=e.disabled;return c.a.createElement("li",{key:t},c.a.createElement(B.a,{onClick:a,size:"large",disabled:i,block:!0},n),r&&o.visible?c.a.createElement(xe,{dialog:r,dialogProps:o}):"")})))},Me=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={activeLeagues:[],newLeague:!1,resumeLeague:!1},e.activeLeagues=v.database().ref("leagues/list").orderByChild("active").equalTo(!0),e}return Object(u.a)(a,[{key:"fetch",value:function(){var e=this;this.activeLeagues.on("value",(function(t){if(t.val()){var a=v.auth().currentUser.uid;e.setState({activeLeagues:Object.values(t.val()).filter((function(e){var t=e.players;return Object.values(t).some((function(e){return e.key===a}))})),loading:!1})}}))}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.activeLeagues.off("value")}},{key:"showResumeLeagueDialog",value:function(){this.setState({resumeLeague:!0})}},{key:"closeResumeLeagueDialog",value:function(e){this.setState({resumeLeague:!1}),this.navigateToLeague(e)}},{key:"showNewLeagueDialog",value:function(){this.setState({newLeague:!0})}},{key:"closeNewLeagueDialog",value:function(e){this.setState({newLeague:!1}),this.navigateToLeague(e)}},{key:"navigateToLeague",value:function(e){e&&this.props.history.push("".concat("/league","/")+e)}},{key:"render",value:function(){return c.a.createElement("div",{className:"app-main"},c.a.createElement(Ie,{items:[{text:"Resume League",onClick:this.showResumeLeagueDialog.bind(this),dialog:ye.RESUME_LEAGUE,disabled:0===this.state.activeLeagues.length,dialogProps:{afterClose:this.closeResumeLeagueDialog.bind(this),visible:this.state.resumeLeague,activeLeagues:this.state.activeLeagues}},{text:"Create League",onClick:this.showNewLeagueDialog.bind(this),dialog:ye.NEW_LEAGUE,dialogProps:{onAfterClose:this.closeNewLeagueDialog.bind(this),visible:this.state.newLeague}},{text:"Settings"},{text:"Scores"},{text:"Sign Out",onClick:n.signOut}]}))}}]),a}(o.Component),Pe=Z((function(e){return!!e}))(Me),Te=(a(163),a(41)),Le=(a(366),a(84)),Be=(a(368),a(147)),Ae=a(402),He=a(403),Ge=a(404),Ue=a(405),We=(a(370),a(400)),_e=a(401),Ve=a(133);!function(e){e.SPADE="SPADE",e.HART="HART",e.DIAMOND="DIAMOND",e.CLUB="CLUB",e.NT="NT"}(je||(je={})),function(e){e.C="C",e.D="D",e.H="H",e.S="S"}(Re||(Re={}));var Fe,ze,qe=(De={},Object($.a)(De,je.CLUB,Re.C),Object($.a)(De,je.DIAMOND,Re.D),Object($.a)(De,je.HART,Re.H),Object($.a)(De,je.SPADE,Re.S),Object($.a)(De,je.NT,"NT"),De),Ke=function(e){for(var t=!0,a=0;a<4;a++){var n="bid".concat(a),r="won".concat(a);if("number"!==typeof e[n]||"number"!==typeof e[r]){t=!1;break}if(e[n]===e[r]){t=!1;break}}return t},Ye=function(){for(var e=[],t=0,a=Object.values(qe);t<a.length;t++)for(var n=a[t],r=2;r<15;r++)e.push("".concat(r,"-").concat(n));return e}(),Xe=(Fe={},Object($.a)(Fe,qe.CLUB,1),Object($.a)(Fe,qe.DIAMOND,0),Object($.a)(Fe,qe.HART,2),Object($.a)(Fe,qe.SPADE,3),Fe),Je=function(e){return e.findIndex((function(e){var t;return e.key===(null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid)}))},Qe=function(e){return e+1>3?e+1-4:e+1},Ze=function(e){for(var t=$e(Ye),a=[[],[],[],[]],n=0;n<52;n+=4)for(var r=0;r<a.length;r++)a[r].push(t[n+r]);return tt(a),et(e,a)},$e=function(e){return he(e)},et=function(e,t){return e.reduce((function(e,a,n){return e[a.key]=t[n],e}),{})},tt=function(e){e.forEach((function(e){return at(e)}))},at=function(e){return e.sort((function(e,t){var a=e.split("-"),n=Object(le.a)(a,2),r=n[0],o=n[1],c=t.split("-"),i=Object(le.a)(c,2),s=i[0],l=i[1];return Xe[o]<Xe[l]?1:Xe[o]>Xe[l]?-1:+s-+r}))};a(371);!function(e){e.BID="BID",e.WON="WON"}(ze||(ze={}));var nt=a(106),rt=a(107),ot=(a(164),a(54)),ct=(a(165),a(39)),it=a(397),st=a(391),lt=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 511.96 511.96",style:{enableBackground:"new 0 0 511.96 511.96"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{d:"M302.728,390.351c16.49,15.934,26.368,25.759,55.905,24.541c43.494-1.783,83.871-25.459,106.364-62.729 c38.78-64.247,17.576-128.53-23.702-166.824L272.705,6.528c-9.507-8.704-24.082-8.704-33.589,0L68.073,185.34 c-40.13,37.226-57.256,99.037-23.729,161.483c21.283,39.645,61.767,66.357,106.726,68.087c29.281,1.121,40.801-8.66,57.759-24.488 c4.458-4.167,11.767-1.033,11.767,5.076l0.009,29.987c0,16.172-4.228,32.071-12.253,46.115l-15.519,27.154 c-3.354,5.888,0.892,13.206,7.671,13.206h110.813c6.78,0,11.034-7.318,7.671-13.206l-15.519-27.154 c-8.024-14.045-12.244-29.943-12.244-46.115v-30.296C291.226,389.213,298.429,386.202,302.728,390.351"}),c.a.createElement("path",{style:{fill:"#2A2D33"},d:"M427.21,329.362c-8.701,14.419-21.869,26.091-37.482,33.362c-10.397,4.841-21.597,7.606-32.91,8.072 c-4.871,0.201-8.657,4.312-8.457,9.184c0.201,4.871,4.312,8.657,9.184,8.457c13.661-0.563,27.144-3.891,39.635-9.707 c18.759-8.735,34.611-22.785,45.145-40.244c19.021-31.51,20.189-64.061,7.087-94.822c-1.911-4.485-7.096-6.573-11.581-4.662 c-4.485,1.911-6.573,7.096-4.662,11.581C444.131,276.316,443.177,302.911,427.21,329.362z"})))},ut=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 510.977 510.977",style:{enableBackground:"new 0 0 510.977 510.977"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{style:{fill:"#D71E00"},d:"M255.22,105.177c19.535-49.77,61.325-87.79,113.231-87.79c43.705,0,79.625,23.111,108.871,54.44 c38.859,41.622,56.17,137.216-15.863,209.24c-36.546,36.546-205.815,212.524-205.815,212.524S86.384,317.613,49.838,281.066 c-72.033-72.024-55.578-167.618-15.863-209.24c29.581-31.002,65.165-54.44,108.871-54.44 C194.751,17.386,235.685,55.407,255.22,105.177"}),c.a.createElement("path",{style:{fill:"#B21606"},d:"M429.848,94.824c26.006,21.865,39.538,63.103,31.858,97.341c-0.675,2.978-1.395,6.021-2.154,9.091 c-1.17,4.733,1.718,9.518,6.45,10.689c4.733,1.17,9.518-1.718,10.689-6.45c0.787-3.183,1.534-6.339,2.238-9.446 c9.114-40.635-6.622-88.592-37.718-114.736c-16.942-14.251-37.574-20.273-68.03-20.273c-4.875,0-8.828,3.952-8.828,8.828 s3.952,8.828,8.828,8.828C399.8,78.694,416.45,83.554,429.848,94.824z"})))},dt=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("polygon",{style:{fill:"#D71E00"},points:"256,0 45.714,256 256,512 466.286,256 \t"}),c.a.createElement("path",{style:{fill:"#B21606"},d:"M248.872,448.656c-3.162,3.937-2.533,9.692,1.404,12.853c3.937,3.162,9.692,2.533,12.853-1.404 l64-79.698c3.162-3.937,2.533-9.692-1.404-12.853c-3.937-3.162-9.692-2.533-12.853,1.404L248.872,448.656z"})))},mt=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 511.998 511.998",style:{enableBackground:"new 0 0 511.998 511.998"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{d:"M419.381,199.229c-26.651-12.378-51.541-12.674-74.177-7.186c18.441-21.827,29.058-50.472,27.396-81.642 C369.438,51,320.017,2.36,260.58,0.087c-66.578-2.542-121.353,50.67-121.353,116.682c0,28.699,10.393,54.937,27.567,75.273 c-22.636-5.488-47.526-5.192-74.177,7.186c-41.023,19.061-69.569,59.401-70.153,104.628 c-0.835,65.204,51.757,118.317,116.763,118.317c31.412,0,59.859-12.459,80.842-32.633v34.403c0,16.501-4.303,32.714-12.495,47.041 l-15.755,27.576c-3.422,5.991,0.907,13.438,7.797,13.438h112.766c6.899,0,11.219-7.446,7.797-13.438l-15.755-27.576 c-8.183-14.327-12.495-30.54-12.495-47.041V389.54c20.992,20.175,49.439,32.633,80.842,32.633 c65.006,0,117.607-53.113,116.763-118.317C488.95,258.629,460.403,218.289,419.381,199.229"}),c.a.createElement("path",{style:{fill:"#2A2D33"},d:"M423.915,355.877c-13.621,13.805-31.752,21.385-51.142,21.385c-4.961,0-8.982,4.022-8.982,8.982 c0,4.961,4.022,8.982,8.982,8.982c24.196,0,46.934-9.506,63.927-26.729c16.991-17.2,26.197-40.066,25.888-64.288 c-0.063-4.96-4.136-8.93-9.096-8.867c-4.96,0.063-8.93,4.136-8.867,9.096C444.872,323.859,437.529,342.095,423.915,355.877z"})))},ft=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("path",{d:"M170.256,403.875c10.65-12.234,17.122-28.196,17.122-45.652c0-38.393-31.234-69.627-69.627-69.627 c-14.451,0-27.886,4.428-39.024,11.994c-1.632-10.049-2.463-20.254-2.463-30.537c0-49.249,18.842-95.868,53.054-131.273 c25.408-26.294,57.27-44.329,92.103-52.568l-23.142,27.868l23.133,19.21l59.366-71.49L201.539,17.43l-14.69,26.236l24.912,13.95 c-39.327,9.833-75.273,30.476-104.065,60.27c-39.659,41.041-61.5,95.081-61.5,152.168c0,20.2,2.752,40.155,8.17,59.414 c-3.996,8.772-6.241,18.504-6.241,28.756c0,17.491,6.497,33.483,17.185,45.726c-37.719,14.016-64.668,50.375-64.668,92.914v15.034 h234.473v-15.034C235.117,454.25,208.078,417.838,170.256,403.875z M117.752,318.665c21.813,0,39.558,17.746,39.558,39.558 s-17.746,39.558-39.559,39.558c-21.812,0-39.557-17.746-39.557-39.558S95.94,318.665,117.752,318.665z M32.362,481.828 c6.879-30.85,34.471-53.977,67.363-53.977h36.311c32.892,0,60.484,23.128,67.363,53.977H32.362z"}))),c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("path",{d:"M511.357,208.266c0-42.611-27.04-79.025-64.86-92.988c10.65-12.233,17.122-28.196,17.122-45.652 C463.619,31.234,432.385,0,393.992,0c-38.393,0-69.627,31.234-69.627,69.626c0,17.491,6.497,33.483,17.186,45.726 c-37.719,14.016-64.667,50.375-64.667,92.915v15.034h171.669c3.701,14.892,5.576,30.234,5.576,45.751 c0,45.405-16.341,89.291-46.014,123.576c-21.289,24.598-48.406,43.143-78.51,54.073l19.818-31.008l-25.335-16.193l-50.044,78.3 L358.173,512l11.325-27.855l-25.967-10.556c33.429-12.822,63.523-33.788,87.321-61.284 c34.401-39.748,53.347-90.623,53.347-143.254c0-15.46-1.611-30.777-4.793-45.751h31.952V208.266z M393.992,30.069 c21.813,0,39.558,17.746,39.558,39.557c0,21.813-17.746,39.558-39.558,39.558s-39.558-17.746-39.558-39.558 C354.434,47.814,372.179,30.069,393.992,30.069z M308.603,193.232c6.879-30.851,34.471-53.978,67.363-53.978h36.311 c32.892,0,60.484,23.128,67.363,53.978H308.603z"}))),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null))},ht=function(e){var t=e.dataSource,a=e.players,n=e.currentRound,r=e.leagueScores,o=e.gameID;return c.a.createElement("div",{className:"game-table"},c.a.createElement("h3",{className:"game-header"},"Game ",o),c.a.createElement(ot.a,{gutter:1,className:"table-header",style:{marginBottom:1}},c.a.createElement(ct.a,{span:4},c.a.createElement("div",{className:"table-cell"},"round")),gt(a)),t.map((function(e,t){return c.a.createElement(ot.a,{gutter:1,className:"table-row ".concat(n-1===t?"current-round":""," ").concat(e.fell?"round-fell":""),key:t},c.a.createElement(ct.a,{span:4},c.a.createElement("div",{className:"table-cell"},t+1," ",e.factor>1&&c.a.createElement("span",{className:"round-factor"},"x".concat(e.factor)))),pt(a,e))})),c.a.createElement(ot.a,{gutter:1,className:"table-row"},c.a.createElement(ct.a,{span:4},c.a.createElement("div",{className:"table-cell"},c.a.createElement(it.a,{twoToneColor:"#52c41a"}))),vt(a,r)))},gt=function(e){return e.map((function(e){var t=e.index,a=e.playerName;return c.a.createElement(ct.a,{key:t,span:5},c.a.createElement("div",{className:"table-cell"},a))}))},pt=function(e,t){return e.map((function(e){var a=e.index;return c.a.createElement(ct.a,{span:5,key:a},c.a.createElement("div",{className:"table-cell score-cell ".concat(t["bid".concat(a)]!==t["won".concat(a)]?"fell":""," ").concat(a===t.highestBidder?"highest-bidder":"")},t["aggregateScore".concat(a)],a===t.highestBidder&&c.a.createElement("span",{className:"trump"},function(e){switch(e){case je.SPADE:return c.a.createElement(st.a,{component:lt});case je.HART:return c.a.createElement(st.a,{component:ut});case je.DIAMOND:return c.a.createElement(st.a,{component:dt});case je.CLUB:return c.a.createElement(st.a,{component:mt});case je.NT:return"NT"}}(t.trump))))}))},vt=function(e,t){return e.map((function(e){var a=e.index;return c.a.createElement(ct.a,{span:5,key:a},c.a.createElement("div",{className:"table-cell"},""!==t["leagueScore".concat(a)]?t["leagueScore".concat(a)]:"-"))}))},bt=(a(372),a(249)),yt=(a(374),a(247)),Et=(a(376),a(219)),St=a(399),wt=a(398),Ct=(a(378),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1},e.showModal=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e.trumpIconMap={SPADE:lt,HART:ut,DIAMOND:dt,CLUB:mt,NT:"NT"},e}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e){e.visible!==this.props.visible&&this.props.visible!==this.state.visible&&this.setState({visible:this.props.visible})}},{key:"onTrumpSelect",value:function(e){this.props.onChange(e),this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.trump,a=e.disabled;return c.a.createElement("div",{className:"cards-modal"},"trump",c.a.createElement(B.a,{ghost:!0,className:"card-btn",onClick:this.showModal,disabled:a},t?"NT"===t?"NT":c.a.createElement(st.a,{component:this.trumpIconMap[t]}):c.a.createElement(wt.a,null)),c.a.createElement(ee.a,{footer:null,visible:this.state.visible,onCancel:this.handleCancel,className:"cards-modal-dialog"},c.a.createElement(B.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"SPADE")},c.a.createElement(st.a,{component:lt})),c.a.createElement(B.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"HART")},c.a.createElement(st.a,{component:ut})),c.a.createElement(B.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"DIAMOND")},c.a.createElement(st.a,{component:dt})),c.a.createElement(B.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"CLUB")},c.a.createElement(st.a,{component:mt})),c.a.createElement(B.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"NT")},"NT")))}}]),a}(o.Component)),Ot=(a(379),function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getButtons=function(e,t){var a=n.props,r=a.disabled,o=a.disabledNumber;return Array(t).fill(e).map((function(e,t){return c.a.createElement(B.a,{key:t,onClick:n.onBtnClick,size:"default",disabled:r||o===t+e},t+e)}))},n.state={showMore:!1},n.toggleMore=n.toggleMore.bind(Object(d.a)(n)),n.onBtnClick=n.onBtnClick.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"toggleMore",value:function(){this.setState({showMore:!this.state.showMore})}},{key:"onBtnClick",value:function(e){this.props.onSelect(1*e.target.textContent)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state.showMore;return c.a.createElement("div",null,c.a.createElement("div",{className:"dial-pad"},t?this.getButtons(10,4):this.getButtons(0,10),c.a.createElement(B.a,{size:"default",onClick:this.toggleMore,className:"more-less-btn",disabled:e},t?"Less...":"More...")))}}]),a}(o.Component)),kt=(a(380),"fade-in"),Dt="slide-up",jt=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.type;this.div.classList.add(t),setTimeout((function(){return e.div.classList.remove(t)}),400)}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.children!==this.props.children){var a=this.props.type;this.div.classList.add(a),setTimeout((function(){return t.div.classList.remove(a)}),400)}}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"",ref:function(t){return e.div=t}},this.props.children)}}]),a}(o.Component),Rt=function(e){var t=e.name,a=e.bid,n=e.won,r=e.score;return c.a.createElement("div",{className:"player-pad"},c.a.createElement("div",{className:"pad-name"},t,"\xa0",void 0!==r&&c.a.createElement("span",{className:"pad-score"},"[",c.a.createElement(jt,{type:Dt},r),"]")),c.a.createElement("div",{className:"pad-bid-won"},"Bid: ","number"===typeof a?a:" "," Won: ",n))},Nt=(a(381),"top"),xt="bottom",It=function(e){return c.a.createElement("div",{className:"arrow-indicator ".concat(e.direction||"")},c.a.createElement("span",null,c.a.createElement("i",null),c.a.createElement("i",null)),c.a.createElement("i",null),c.a.createElement("span",null,c.a.createElement("i",null),c.a.createElement("i",null)))},Mt=a(134),Pt=a.n(Mt),Tt=a(166),Lt=a.n(Tt),Bt=a(167),At=a.n(Bt),Ht=a(168),Gt=a.n(Ht),Ut=a(169),Wt=a.n(Ut),_t=a(170),Vt=a.n(_t),Ft=a(171),zt=a.n(Ft),qt=a(172),Kt=a.n(qt),Yt=a(173),Xt=a.n(Yt),Jt=a(174),Qt=a.n(Jt),Zt=a(175),$t=a.n(Zt),ea=a(176),ta=a.n(ea),aa=a(177),na=a.n(aa),ra=a(178),oa=a.n(ra),ca=a(179),ia=a.n(ca),sa=a(180),la=a.n(sa),ua=a(181),da=a.n(ua),ma=a(182),fa=a.n(ma),ha=a(183),ga=a.n(ha),pa=a(184),va=a.n(pa),ba=a(185),ya=a.n(ba),Ea=a(186),Sa=a.n(Ea),wa=a(187),Ca=a.n(wa),Oa=a(188),ka=a.n(Oa),Da=a(189),ja=a.n(Da),Ra=a(190),Na=a.n(Ra),xa=a(191),Ia=a.n(xa),Ma=a(192),Pa=a.n(Ma),Ta=a(193),La=a.n(Ta),Ba=a(194),Aa=a.n(Ba),Ha=a(195),Ga=a.n(Ha),Ua=a(196),Wa=a.n(Ua),_a=a(197),Va=a.n(_a),Fa=a(198),za=a.n(Fa),qa=a(199),Ka=a.n(qa),Ya=a(200),Xa=a.n(Ya),Ja=a(201),Qa=a.n(Ja),Za=a(202),$a=a.n(Za),en=a(203),tn=a.n(en),an=a(204),nn=a.n(an),rn=a(205),on=a.n(rn),cn=a(206),sn=a.n(cn),ln=a(207),un=a.n(ln),dn=a(208),mn=a.n(dn),fn=a(209),hn=a.n(fn),gn=a(210),pn=a.n(gn),vn=a(211),bn=a.n(vn),yn=a(212),En=a.n(yn),Sn=a(213),wn=a.n(Sn),Cn=a(214),On=a.n(Cn),kn=a(215),Dn=a.n(kn),jn=a(216),Rn=a.n(jn),Nn=a(217),xn=a.n(Nn),In=(a(382),function(e){var t=e.card,a=e.preSelected,n=e.thrown,r=e.onCardClick,i=e.disabled,s=Object(o.useCallback)((function(e){i||r(e)}),[r,i]);console.log("card",Pt.a);return c.a.createElement("div",{className:"play-card ".concat(a?"pre-selected":""," ").concat(n?"thrown":""," ").concat(i?"disabled":""),onClick:s},c.a.createElement("img",{src:function(e){switch(e){case"2-C":return Pt.a;case"2-D":return Lt.a;case"2-H":return At.a;case"2-J":return Gt.a;case"2-S":return Wt.a;case"3-C":return Vt.a;case"3-D":return zt.a;case"3-H":return Kt.a;case"3-S":return Xt.a;case"4-C":return Qt.a;case"4-D":return $t.a;case"4-H":return ta.a;case"4-S":return na.a;case"5-C":return oa.a;case"5-D":return ia.a;case"5-H":return la.a;case"5-S":return da.a;case"6-C":return fa.a;case"6-D":return ga.a;case"6-H":return va.a;case"6-S":return ya.a;case"7-C":return Sa.a;case"7-D":return Ca.a;case"7-H":return ka.a;case"7-S":return ja.a;case"8-C":return Na.a;case"8-D":return Ia.a;case"8-H":return Pa.a;case"8-S":return La.a;case"9-C":return Aa.a;case"9-D":return Ga.a;case"9-H":return Wa.a;case"9-S":return Va.a;case"10-C":return za.a;case"10-D":return Ka.a;case"10-H":return Xa.a;case"10-S":return Qa.a;case"11-C":return $a.a;case"11-D":return tn.a;case"11-H":return nn.a;case"11-S":return on.a;case"12-C":return sn.a;case"12-D":return un.a;case"12-H":return mn.a;case"12-S":return hn.a;case"13-C":return pn.a;case"13-D":return bn.a;case"13-H":return En.a;case"13-S":return wn.a;case"14-C":return On.a;case"14-D":return Dn.a;case"14-H":return Rn.a;case"14-S":return xn.a}}(t)}))}),Mn=(a(383),function(e){var t=e.card,n=e.thrownType,r=e.from,i=e.to,s=e.hasWinner,l=Object(o.useState)(r||i),u=Object(le.a)(l,2),d=u[0],m=u[1];return Object(o.useEffect)((function(){m(i)}),[i]),c.a.createElement("div",{className:"thrown-card ".concat(n," ").concat(s?"has-winner":""),style:Object(te.a)({},d)},t&&c.a.createElement("img",{src:a(384)("./".concat(t,".svg")),style:{width:"90px"}}))}),Pn=a(246),Tn=a.n(Pn),Ln=(a(385),ee.a.confirm);Te.b.config({top:100,maxCount:3});var Bn,An=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).audio=new Audio(Tn.a),n.getNextPlayer=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t[a+1>3?a+1-4:a+1].index},n.getBeforePlayer=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t[a-1>-1?a-1:a-1+4].index},n.getBeforePlayerBid=function(e,t){return n.getRoundData()["bid".concat(n.getBeforePlayer(e,t))]},n.getBeforePlayers=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t.filter((function(e){return a!==e.index})).map((function(e){return e.index}))},n.getPlayerAggregateScore=function(e,t,a){var r=e[t];if(!r)return 0;var o=r["aggregateScore".concat(a)];return"number"!==typeof o||r.fell?n.getPlayerAggregateScore(e,t-1,a):o},n.getPlayersButtons=function(){var e=n.props,t=e.allRounds,a=e.currentRound,r=e.players,o=t.length&&t[a-1],i=o.highestBidder;return r.map((function(e,r){var s=e.index,l=e.playerName;return c.a.createElement(yt.a,{key:s,dot:i===s},c.a.createElement(Et.a.Button,{value:s},c.a.createElement(Rt,{name:l,bid:o["bid".concat(s)],won:o["won".concat(s)],score:n.getPlayerAggregateScore(t,a-1,s)})))}))},n.handleCardClick=function(e){return function(t){var a=n.state,r=a.preSelectedCard,o=a.selectedPlayer,c=n.props,i=c.currentRound,s=c.devicePlayerIndex,l=c.onCardThrown,u=n.getRoundData();if(u.inputMode===ze.WON&&o===s)if(r===e){var d=t.currentTarget.offsetParent.offsetTop-15,m=t.currentTarget.offsetLeft;n.ownThrownCardInitPos={top:d,left:m},n.setState({thrownCards:[].concat(Object(ue.a)(n.state.thrownCards),[{player:o,card:e}])}),l(e,o,i,u.currentHand),n.setState({thrownCard:e})}else n.setState({preSelectedCard:e})}},n.isAllBids=function(e){return Array(4).fill(1).every((function(t,a){return"number"===typeof e["bid".concat(a)]}))},n.toggleMute=function(){n.setState({isMute:!n.state.isMute})},n.state={selectedPlayer:void 0,reorderPlayersDialogVisible:!1,trumpModalVisible:!1,preSelectedCard:void 0,thrownCard:void 0,thrownCards:[],handCardType:void 0,isMute:!1},n.handleSwitchMode=n.handleSwitchMode.bind(Object(d.a)(n)),n.handleCardsPadChange=n.handleCardsPadChange.bind(Object(d.a)(n)),n.handleNumberSelect=n.handleNumberSelect.bind(Object(d.a)(n)),n.setSelectedPlayer=n.setSelectedPlayer.bind(Object(d.a)(n)),n.showChangeHighestBidderConfirm=n.showChangeHighestBidderConfirm.bind(Object(d.a)(n)),n.showChangePlayerDialog=n.showChangePlayerDialog.bind(Object(d.a)(n)),n.handleReorderPlayersAfterClose=n.handleReorderPlayersAfterClose.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e){if("remote"===this.props.gameMode){var t=this.props,a=t.devicePlayerIndex,n=t.ownCardsState,r=this.getRoundData(),o=r.handsState,c=r.currentHand,i=r.inputMode,s=e.allRounds,l=e.currentRound,u=s.length&&s[l-1];if(u.inputMode!==i&&i===ze.WON&&(this.setState({selectedPlayer:r.highestBidder}),r.highestBidder===a&&this.playAudio()),u.currentBidder!==r.currentBidder&&i===ze.BID&&this.setState({selectedPlayer:r.currentBidder}),u.handsState!==o){var d={},m=o&&o[c]&&(o[c].thrownCards||[]).find((function(e){return e.player===a}));if(m&&m.card&&(n||[]).length>1?d.thrownCard=m.card:d.thrownCard=void 0,o){var f=o[c].thrownCards?function(e){var t,a=[],n=new Map,r=Object(Ve.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.has(o.player)||(n.set(o.player,!0),a.push(o))}}catch(c){r.e(c)}finally{r.f()}return a}([].concat(Object(ue.a)(this.state.thrownCards),Object(ue.a)(o[c].thrownCards))):[];d.thrownCards=f,d.selectedPlayer=o[c].turnOf,d.handCardType=f[0]&&f[0].card.split("-")[1]}else d.thrownCards=[],d.selectedPlayer=r.highestBidder,d.handCardType=void 0;i===ze.WON&&d.selectedPlayer===a&&this.playAudio(),this.setState(d)}}}},{key:"handleSwitchMode",value:function(e){var t=this.props.onChange,a=this.getRoundData(),n=a.trump,r=a.segment,o=a.handsState;if(0===r)return Te.b.warning("Total Bids are 13?!?!");if(this.state.thrownCard||o)return Te.b.warning("Can`t change bids after a card was thrown");var c=this.isAllBids(a);n&&c?(this.setState({selectedPlayer:void 0}),t(Object(te.a)(Object(te.a)({},a),{},{inputMode:e?ze.WON:ze.BID}))):Te.b.warning("Bids are not completed")}},{key:"setSelectedPlayer",value:function(e){this.isAllowedToSelectPlayer()&&"radio"===e.target.type&&this.setState({selectedPlayer:e.target.value})}},{key:"isAllowedToSelectPlayer",value:function(){var e=this.props.gameMode,t=this.getRoundData();if("remote"===e){var a=t.inputMode,n=t.highestBidder;return a!==ze.WON&&"number"!==typeof n}return!0}},{key:"handleCardsPadChange",value:function(e){var t=this.props.onChange,a=this.getRoundData(),n=a.inputMode;this.setState({trumpModalVisible:!1}),n!==ze.WON&&t(Object(te.a)(Object(te.a)({},a),{},{trump:e}))}},{key:"handleNumberSelect",value:function(e){var t=this.props,a=t.players,n=t.currentRound,r=t.onChange,o=this.getRoundData(),c=o.inputMode,i=o.highestBidder;if(c===ze.BID&&"remote"===this.props.gameMode)return this.handleRemoteBidFlow(e);var s=this.state.selectedPlayer,l=(c===ze.BID?"bid":"won")+s,u={};if(c===ze.BID)if(13===n)(e>=5&&!o["bid".concat(i)]||o["bid".concat(i)]<e)&&(u.highestBidder=s);else{var d=this.getNextPlayer(s,a),m=o["bid".concat(d)],f=this.getBeforePlayerBid(s,a);if(void 0!==m&&""!==m&&d!==i)return Te.b.warning("The Next Player already Bid, Can not change bid");if(!i&&0!==i||i===s){if(e<5)return Te.b.warning("First Bid should be more then 5");u.highestBidder=s}else if(e>=5)this.showChangeHighestBidderConfirm(r,o,l,e,s,a);else if(!f&&0!==f)return Te.b.warning("The Bids are not in the right order!!")}u[l]=e,r(Object(te.a)(Object(te.a)({},o),u),s)}},{key:"calculateDisableNum",value:function(){var e=this.props.players,t=this.getRoundData(),a=t.highestBidder,n=t.inputMode,r=this.state.selectedPlayer;if("number"===typeof r&&n===ze.BID&&this.getNextPlayer(r,e)===a){var o,c=this.getBeforePlayers(r,e),i=0,s=Object(Ve.a)(c);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=t["bid".concat(l)];if(null===u)return;i+=u}}catch(d){s.e(d)}finally{s.f()}return 13-i}}},{key:"showChangeHighestBidderConfirm",value:function(e,t,a,n,r,o){var c=this;Ln({title:"Change Highest Bidder?",content:"(will reset the rest of the bids)",okType:"danger",onOk:function(){var o;e(Object(te.a)(Object(te.a)({},t),{},(o={bid0:"",bid1:"",bid2:"",bid3:""},Object($.a)(o,a,n),Object($.a)(o,"highestBidder",r),o)),r)},onCancel:function(){var i=c.getBeforePlayerBid(r,o);i||0===i?e(Object(te.a)(Object(te.a)({},t),{},Object($.a)({},a,n)),r):(Te.b.warning("The Bids are not in the right order!!"),e(Object(te.a)({},t),r))}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.devicePlayerIndex,n=t.gameMode,r=this.getRoundData(),o=r.round,i=r.check,s=r.trump,l=r.segment,u=r.inputMode,d=r.fell,m=r.factor,f=this.state,h=f.selectedPlayer,g=f.reorderPlayersDialogVisible,p=f.trumpModalVisible,v=f.isMute,b=this.isAllBids(r),y=this.getPlayersButtons(),E="remote"===n;return c.a.createElement(Et.a.Group,{buttonStyle:"solid",className:"game-pad-container ".concat(d?"round-fell":""),onChange:this.setSelectedPlayer,value:h},c.a.createElement("h3",null,"Round: ",o),c.a.createElement(ot.a,{type:"flex",justify:"space-around"},c.a.createElement(ct.a,null,c.a.createElement(bt.a,{onChange:this.handleSwitchMode,checkedChildren:E?" Play ":" Won ",unCheckedChildren:" Bid ",checked:u===ze.WON}),c.a.createElement("div",{className:"segment"},"Bids:"," ",c.a.createElement(jt,{type:kt},b?l:"".concat(l&&13+l)),c.a.createElement(It,{direction:b&&(l>0?Nt:xt)})),c.a.createElement("div",null,"Check: ",i?"yes":"no"),c.a.createElement(jt,{type:kt},d?c.a.createElement("div",{className:"fell-indicator"},"round fell"):""),!d&&m>1&&c.a.createElement("div",{className:"factor-indicator"},"x".concat(m)),E&&c.a.createElement(B.a,{className:"toggle-sound-btn ".concat(v?"is-mute":""),type:"link",icon:c.a.createElement(St.a,null),onClick:this.toggleMute})),c.a.createElement(ct.a,{className:"item item2"},y[Qe(a+1)]),c.a.createElement(ct.a,null,c.a.createElement(Ct,{trump:s,onChange:this.handleCardsPadChange,disabled:u===ze.WON,visible:p}))),c.a.createElement("div",{className:"thrown-cards-marker",ref:function(t){return e.cardsMarkerRef=t}}),c.a.createElement(ot.a,{type:"flex",justify:"space-around"},c.a.createElement(ct.a,{className:"item item4"},y[Qe(a)]),c.a.createElement(ct.a,{style:{zIndex:1}},E&&u===ze.WON?c.a.createElement("div",{className:"number-pad-placement"}):c.a.createElement(Ot,{disabledNumber:this.calculateDisableNum(),onSelect:this.handleNumberSelect,disabled:this.isNumberPadDisabled()})),c.a.createElement(ct.a,{className:"item item6"},y[Qe(a+2)])),c.a.createElement(ot.a,{type:"flex",justify:"center",style:{position:"relative"}},c.a.createElement(ct.a,{className:"item item8"},y[a]),!E&&1===o&&u===ze.BID&&c.a.createElement("div",null,c.a.createElement(B.a,{type:"dashed",shape:"circle",className:"change-players-btn",onClick:this.showChangePlayerDialog},c.a.createElement(st.a,{component:ft})),g&&c.a.createElement(Wn.Consumer,null,(function(t){var a=t.players,n=t.reorderPlayers;return c.a.createElement(xe,{dialog:ye.REORDER_PLAYERS,dialogProps:{onOk:n,onAfterClose:e.handleReorderPlayersAfterClose,visible:g,players:a}})})))),E&&this.getThrownCardsPlacement(),this.getCards())}},{key:"showChangePlayerDialog",value:function(){this.setState({reorderPlayersDialogVisible:!0})}},{key:"handleReorderPlayersAfterClose",value:function(){this.setState({reorderPlayersDialogVisible:!1})}},{key:"handleRemoteBidFlow",value:function(e){var t=this,a=this.props,n=a.devicePlayerIndex,r=a.onChange,o=this.getRoundData(),c=o.highestBidder,i=this.state.selectedPlayer,s={};if("number"!==typeof c){if(e<5)return Te.b.warning("First Bid should be more then 5");s.highestBidder=i,s["bid".concat(i)]=e,s.currentBidder=Qe(i),o.trump||setTimeout((function(){return t.setState({trumpModalVisible:!0})}),300)}else if(n===i){s["bid".concat(i)]=e,Qe(i)===c?(s.currentBidder="",setTimeout((function(){return t.handleSwitchMode(!0)}),1500)):s.currentBidder=Qe(i)}Object.keys(s).length&&r(Object(te.a)(Object(te.a)({},o),s),i)}},{key:"getCards",value:function(){var e=this,t=this.props,a=t.ownCardsState,n=t.devicePlayerIndex,r=this.state,o=r.preSelectedCard,i=r.thrownCard,s=r.handCardType,l=r.selectedPlayer;if(a){var u=Object.values(a).some((function(e){return e.split("-")[1]===s})),d=n===l;return c.a.createElement("div",{className:"cards-container"},Object.values(a).map((function(t){return c.a.createElement(In,{key:t,card:t,preSelected:o===t,thrown:i===t,onCardClick:e.handleCardClick(t),disabled:d&&u&&t.split("-")[1]!==s})})))}return""}},{key:"getThrownCardsPlacement",value:function(){var e,t=this;if(!this.cardsMarkerRef)return"";var a=this.getRoundData(),n=a.handsState,r=a.currentHand,o=n&&n[r].handWinner,i=this.state.thrownCards,s=this.props.devicePlayerIndex,l=Qe,u=(e={},Object($.a)(e,s,"bottom"),Object($.a)(e,l(s),"left"),Object($.a)(e,l(s+1),"top"),Object($.a)(e,l(s+2),"right"),e),d=void 0!==o&&this.getFromTo(u[o],!0);return c.a.createElement("div",{className:"hand-cards-container"},i.map((function(e){var a=d||t.getFromTo(u[e.player]),n=a.from,r=a.to;return c.a.createElement(Mn,{key:e.player,thrownType:u[e.player],card:e.card,from:n,to:r,hasWinner:void 0!==o})})))}},{key:"getFromTo",value:function(e,t){var a=this.cardsMarkerRef&&this.cardsMarkerRef.offsetTop,n=this.cardsMarkerRef&&this.cardsMarkerRef.offsetWidth;return t?function(e,t,a){switch(e){case"right":return{to:{top:94+t-63,left:a+90}};case"left":return{to:{top:94+t-63,left:-90}};case"top":return{to:{top:0,left:a/2-45}};case"bottom":return{to:{top:566,left:a/2-45}}}}(e,a,n):function(e,t,a,n){switch(e){case"right":return{from:{top:94+t-63,left:a+90},to:{top:94+t-63,left:a/2}};case"left":return{from:{top:94+t-63,left:-90},to:{top:94+t-63,left:a/2-90}};case"top":return{from:{top:63,left:a/2-45},to:{top:94+t-126*.8,left:a/2-45}};case"bottom":var r=void 0,o=void 0;return n&&(r=n.top,o=n.left),{from:"number"===typeof r&&"number"===typeof o?{top:r,left:o}:void 0,to:{top:94+t-126*.2,left:a/2-45}};default:return{to:{top:94+t,left:a/2}}}}(e,a,n,this.ownThrownCardInitPos)}},{key:"getRoundData",value:function(){var e=this.props,t=e.allRounds,a=e.currentRound;return t.length&&t[a-1]}},{key:"playAudio",value:function(){!this.state.isMute&&this.audio.play()}},{key:"isNumberPadDisabled",value:function(){var e=this.props,t=e.devicePlayerIndex,a=e.gameMode,n=this.state.selectedPlayer;return"number"!==typeof n||"remote"===a&&t!==n}}]),a}(o.Component),Hn=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).carouselSwipedLeft=function(){var e=n.props,t=e.currentView,a=e.onCurrentViewChange;"panel"!==t?a("panel"):(n.carouselEl.classList.add("bounce-left"),setTimeout((function(){return n.carouselEl.classList.remove("bounce-left")}),400))},n.nextRound=function(){var e=n.props,t=e.goToRound,a=e.currentRound,r=Number(a);r<13&&t&&t(r+1)},n.toRoundBefore=function(){var e=n.props,t=e.goToRound,a=e.currentRound,r=Number(a);1!==r&&t&&t(r-1)},n.carouselEl=c.a.createRef(),n.carouselSwipedRight=n.carouselSwipedRight.bind(Object(d.a)(n)),n.carouselSwipedLeft=n.carouselSwipedLeft.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){me()&&(this.unListenSwipedLeft=fe(this.carouselEl,"swiped-left",this.carouselSwipedLeft),this.unListenSwipedRight=fe(this.carouselEl,"swiped-right",this.carouselSwipedRight))}},{key:"componentWillUnmount",value:function(){me()&&(this.unListenSwipedLeft(),this.unListenSwipedRight())}},{key:"carouselSwipedRight",value:function(){var e=this,t=this.props,a=t.currentView,n=t.onCurrentViewChange;"table"!==a?n("table"):(this.carouselEl.classList.add("bounce-right"),setTimeout((function(){return e.carouselEl.classList.remove("bounce-right")}),400))}},{key:"render",value:function(){var e=this,t=this.props,a=t.gameID,n=t.gameMode,r=t.ownCardsState,o=t.currentView,i=t.rounds,s=t.playersColumns,l=t.currentRound,u=t.handleSave,d=t.leagueScores,m=t.devicePlayerIndex,f=t.handleCardThrown;return c.a.createElement("div",{className:"game-mobile-view ".concat("remote"===n?"mode-remote":"")},c.a.createElement("div",{className:"my-carousel",ref:function(t){return e.carouselEl=t}},c.a.createElement("div",{className:"my-carousel-slides-container ".concat(o)},c.a.createElement("div",{className:"my-carousel-slide"},c.a.createElement(ht,{dataSource:i,leagueScores:d,players:s,currentRound:l,gameID:a})),c.a.createElement("div",{className:"my-carousel-slide"},c.a.createElement(An,{gameMode:n,ownCardsState:r,onCardThrown:f,currentRound:l,allRounds:i,players:s,devicePlayerIndex:m,onChange:u})))),this.showNavigation()&&c.a.createElement("div",{className:"round-navigation"},1!==l&&c.a.createElement(B.a,{type:"primary",className:"left",ghost:!0,onClick:this.toRoundBefore},c.a.createElement(nt.a,null),"Round ".concat(l-1)),13!==l&&c.a.createElement(B.a,{type:"primary",ghost:!0,onClick:this.nextRound},"Round ".concat(Number(l)+1),c.a.createElement(rt.a,null))))}},{key:"showNavigation",value:function(){var e=this.props,t=e.gameMode,a=e.ownCardsState,n=e.currentView;return"remote"!==t||0===(a||[]).length||"table"===n}}]),a}(o.Component),Gn=[10,7,3,1],Un=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"setCardsToPlayers",value:function(e,t,a){v.database().ref().child("cardsByGame/".concat(e,"/round").concat(t)).update({cardsState:a},(function(e){e&&console.error("cards state probably already exists")}))}},{key:"updateHandCardsState",value:function(e,t,a){var n,r=null===(n=v.auth().currentUser)||void 0===n?void 0:n.uid;r&&v.database().ref().child("cardsByGame/".concat(e,"/round").concat(t,"/cardsState/").concat(r)).update(Object($.a)({},"".concat(a),null))}},{key:"savePlayersOrder",value:function(e,t,a){v.database().ref("leagueGames/_".concat(e,"/").concat(t)).update({playersOrder:a})}}]),e}();!function(e){e.ACTIVE="ACTIVE",e.FINISHED="FINISHED"}(Bn||(Bn={}));var Wn=c.a.createContext({players:[]}),_n=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).gameRef=void 0,n.leagueGamesRef=void 0,n.gameSummaryRef=void 0,n.ownCardsStateRef=void 0,n.gameKey="",n.handleSave=function(e,t){var a,r,o={},c=n.state.gameData.rounds||[],i=Object(ue.a)(c),s=i.findIndex((function(t){return e.round===t.round})),l=i[s];if(i.splice(s,1,Object(te.a)(Object(te.a)({},l),e)),e=i[s],"number"===typeof t){n.calculatePlayerScore(e,t,i,s,o);var u=function(e){for(var t=0,a=0,n=!0,r=0,o=Object.entries(e);r<o.length;r++){var c=Object(le.a)(o[r],2),i=c[0],s=c[1];i.indexOf("bid")>-1&&null!==s&&""!==s&&(t+=1*s),i.indexOf("won")>-1&&(null!==s&&""!==s?a+=1*s:n=!1)}return{currentTotalBid:t,currentTotalWon:a,allHasWonInput:n}}(e),d=u.currentTotalBid,m=u.currentTotalWon,f=u.allHasWonInput;if(e.segment=null!==d?d-13:"",e.check=f&&13===m,e.check){var h;if(Ke(e))e.fell=!0,e.round<12?i[e.round].factor=2*e.factor:e.factor>1&&(i[e.round].factor=e.factor);else if(e.fell){e.fell=!1,i[e.round]&&(i[e.round].factor=e.factor>1?e.factor/2:e.factor);for(var g=0;g<4;g++)n.calculatePlayerScore(e,g,i,s,o)}if(r=n.calculateSummary(i,s),13===e.round&&!e.fell){o.status=Bn.FINISHED,n.updateGameStatus(Bn.FINISHED);var p=n.state.gameData,v={totalScore0:p.totalScore0,totalScore1:p.totalScore1,totalScore2:p.totalScore2,totalScore3:p.totalScore3},b="totalScore".concat(t);v[b]=o[b],r=n.calculateLeagueScores(v,r)}null===(h=n.gameSummaryRef)||void 0===h||h.update(n.mapToPlayersObj(r))}}"remote"===n.state.gameData.gameMode&&(c[s].inputMode===ze.BID&&e.inputMode===ze.WON&&[0,1,2,3].forEach((function(t){e["won".concat(t)]=0})));o.rounds=i,null===(a=n.gameRef)||void 0===a||a.update(o)},n.handleCardThrown=function(e,t,a,r){var o,c=n.getRoundData(a),i=c&&c.handsState&&c.handsState[r].thrownCards||[],s=[].concat(Object(ue.a)(i),[{player:t,card:e}]),l=n.state.gameData.ownCardsState;null===(o=n.gameRef)||void 0===o||o.child("rounds/".concat(a-1,"/handsState/").concat(r)).update({status:"ACTIVE",turnOf:4!==s.length?Qe(t):null,thrownCards:s}).then((function(){return n.updateOwnCardState(e,a,l)}))},n.calculatePlayerScore=function(e,t,a,n,r){var o,c=e["bid".concat(t)],i=e["won".concat(t)];if(""!==i&&""!==c){if(i===c)o=1*i===0?e.segment>0?25:50:Math.pow(i,2)+10;else{var s=Math.abs(i-c);o=1*c===0?-(e.segment>0?25:50)+10*(s-1):-10*s}o*=e.factor,e["score".concat(t)]=o;for(var l=0,u=0;u<=n;u++){var d=a[u];"number"!==typeof d["score".concat(t)]||d.fell||(l+=d["score".concat(t)])}e["aggregateScore".concat(t)]=l,r["totalScore".concat(t)]=e["aggregateScore".concat(t)]}},n.calculateLeagueScores=function(e,t){return Object.keys(e).sort((function(t,a){return(e[a]||0)-(e[t]||0)})).forEach((function(a,n){var r=e[a],o=Gn[n];r<0&&o--,r%100===0&&o++,r>300&&(o+=3),r<-100&&(o-=3),t["".concat(a.slice(-1))].leagueScore=o})),t},n.calculateSummary=function(e,t){for(var a=t+1,n={},r=0;r<4;r++){for(var o=0,c=0,i=0,s=0,l=0,u=0,d=0,m=0,f=0,h=0,g=0,p=0;p<a;p++){var v=e[p];if(!v.fell){c++;var b=v.highestBidder===r,y=!b&&(r+1>3?0:r+1)===v.highestBidder;b?i++:y&&g++,v.segment&&v.segment>0&&u++,"NT"===v.trump&&m++,v["bid".concat(r)]===v["won".concat(r)]&&(o++,b?s++:y&&h++,"NT"===v.trump&&f++,v.segment&&v.segment>0?l++:d++)}}var E={wins:o,total:c},S={wins:s,total:i},w={wins:l,total:u},C={wins:d,total:c-u},O={wins:f,total:m},k={wins:h,total:g};n[r]={leagueScore:0,successRate:E,successRateHB:S,successRateOver:w,successRateUnder:C,successRateNT:O,successRateLastBidder:k}}return n},n.mapToPlayersObj=function(e){var t=n.state,a=t.players,r=t.gameSummary;return a.reduce((function(t,a,n){return t[a.key]=Object(te.a)(Object(te.a)({},r[a.key]),e[n]),t}),{})},n.updateGameStatus=function(e){var t=n.props.match.params.leagueID;v.database().ref("leagueGames/_".concat(t,"/").concat(n.gameKey)).update({status:e})},n.toggleSlide=function(){var e="panel"===n.state.currentView?"table":"panel";n.setCurrentViewState(e)},n.getLeagueScores=function(){var e=n.state,t=e.gameSummary,a=e.players;return 0===Object.keys(t).length?{leagueScore0:0,leagueScore1:0,leagueScore2:0,leagueScore3:0}:a.reduce((function(e,a,n){return e["leagueScore".concat(n)]=t[a.key].leagueScore,e}),{})},n.initColumns=function(e){return e.map((function(e,t){return{playerName:e.nickname,index:t}}))},n.state={players:e.players,devicePlayerIndex:null,columns:[],currentView:"table",gameData:{currentRound:1,dealer:void 0,rounds:[],totalScore0:void 0,totalScore1:void 0,totalScore2:void 0,totalScore3:void 0},gameSummary:{}},n.selectActiveRound=n.selectActiveRound.bind(Object(d.a)(n)),n.setCurrentViewState=n.setCurrentViewState.bind(Object(d.a)(n)),n.handleReorderPlayers=n.handleReorderPlayers.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"fetch",value:function(){var e=this,t=this.props.match.params,a=t.leagueID,n=t.gameID,r=v.database();this.gameRef&&this.gameRef.off("value"),this.leagueGamesRef=r.ref("leagueGames/_".concat(a)).orderByChild("gameID").equalTo(Number(n)),this.leagueGamesRef.once("value",(function(t){var n=Object.values(t.val())[0],o=Object.keys(t.val())[0];e.gameKey=o,e.gameRef=r.ref("games/".concat(o)),e.gameSummaryRef=r.ref("leagueGamesSummary/_".concat(a,"/").concat(o,"/players"));var c=n.gameMode,i=n.playersOrder||e.props.players;e.setState({players:i,columns:e.initColumns(i),devicePlayerIndex:Je(i)}),e.gameRef.on("value",(function(t){var a=t.val();e.setState({gameData:Object(te.a)(Object(te.a)({},e.state.gameData),{},{gameMode:c},a)}),e.props.loaderStateCb(!1)})),e.gameSummaryRef.on("value",(function(t){e.setState({gameSummary:Object(te.a)({},t.val())})}))}))}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){var e,t;null===(e=this.gameRef)||void 0===e||e.off("value"),null===(t=this.gameSummaryRef)||void 0===t||t.off("value"),this.ownCardsStateRef&&this.ownCardsStateRef.off("value")}},{key:"componentDidUpdate",value:function(e,t){var a=this;e.match.params.gameID!==this.props.match.params.gameID&&this.fetch();var n=this.state.gameData;if(t.gameData.gameMode===n.gameMode&&t.gameData.currentRound===n.currentRound||this.handleGameModeChange(),t.gameData!==n){var r=n.currentRound,o=n.dealer,c=n.gameMode,i=this.getRoundData(r);if("remote"===c&&i){var s,l=i.handsState,u=i.currentHand,d=l&&l[u],m=null===(s=v.auth().currentUser)||void 0===s?void 0:s.uid;d&&4===(d.thrownCards||[]).length&&"ACTIVE"===d.status&&setTimeout((function(){o===m&&a.handleHandFinished(i)}),2500),13===u&&"FINISHED"===(l||{})[u].status&&o===m&&this.calculateHandScore(i)}}}},{key:"setCurrentViewState",value:function(e){this.setState({currentView:e})}},{key:"selectActiveRound",value:function(e){var t,a,n=this.state,r=n.gameData,o=n.currentView,c=r.rounds,i=r.currentRound,s=r.gameMode,l=r.dealer,u=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid;if(Number(e)<Number(i)||c&&c[i-1].check){if(null===(a=this.gameRef)||void 0===a||a.update({currentRound:Number(e)}),"table"===o&&this.toggleSlide(),"remote"===s&&l===u&&!c[e-1].handsState){var d=this.state.players,m=Ze(d);Un.setCardsToPlayers(this.gameKey,e,m)}}else Te.b.warning("Current round is not completed")}},{key:"handleReorderPlayers",value:function(e){this.setState({players:e,devicePlayerIndex:Je(e),columns:this.initColumns(e)});var t=this.props.match.params.leagueID;v.database().ref("leagueGames/_".concat(t,"/").concat(this.gameKey)).update({playersOrder:e})}},{key:"render",value:function(){var e=this.state,t=e.columns,a=e.currentView,n=e.gameData,r=e.players,o=e.devicePlayerIndex,s=n.rounds,l=n.currentRound,u=n.gameMode,d=n.ownCardsState,m=this.props.match.params.gameID,f=t.slice(0,4);return c.a.createElement(Wn.Provider,{value:{players:r,reorderPlayers:this.handleReorderPlayers}},Object(i.createPortal)(c.a.createElement(B.a,{className:"toggle-view-btn",type:"link",onClick:this.toggleSlide,icon:"table"===a?c.a.createElement(We.a,null):c.a.createElement(_e.a,null)}),document.querySelector("#app-header")||document.body),c.a.createElement(Hn,{gameID:m,gameMode:u,currentView:a,rounds:s,ownCardsState:d,handleCardThrown:this.handleCardThrown,playersColumns:f,devicePlayerIndex:o,currentRound:l,handleSave:this.handleSave,onCurrentViewChange:this.setCurrentViewState,goToRound:this.selectActiveRound,leagueScores:this.getLeagueScores()}))}},{key:"getRoundData",value:function(e){return(this.state.gameData.rounds||[]).find((function(t){return t.round===e}))}},{key:"handleGameModeChange",value:function(){var e=this,t=this.state,a=t.gameData,n=t.players;if("remote"===a.gameMode){var r,o=a.currentRound,c=a.dealer,i=null===(r=v.auth().currentUser)||void 0===r?void 0:r.uid;this.ownCardsStateRef=v.database().ref("cardsByGame/".concat(this.gameKey,"/round").concat(o,"/cardsState/").concat(i)),this.ownCardsStateRef.on("value",(function(t){console.log(t.val()),e.setState((function(e){return{gameData:Object(te.a)(Object(te.a)({},e.gameData),{},{ownCardsState:t.val()||[]})}}));var a=e.state.gameData.currentRound,r=e.getRoundData(a);if(!t.val()&&1===a&&!(null===r||void 0===r?void 0:r.handsState)&&c===i){var o=Ze(n);Un.setCardsToPlayers(e.gameKey,a,o)}}))}else a.ownCardsState&&this.setState({gameData:Object(te.a)(Object(te.a)({},a),{},{ownCardsState:void 0})})}},{key:"handleHandFinished",value:function(e){var t,a,n,r=this,o=function(e){var t=e.trump,a=e.handsState,n=e.currentHand,r=(a&&a[n]).thrownCards,o=r.filter((function(e){return e.card.split("-")[1]===qe[t]}));if(o.length)return o.sort((function(e,t){return+t.card.split("-")[0]-+e.card.split("-")[0]}))[0];var c=r[0].card.split("-")[1];return r.filter((function(e){return e.card.split("-")[1]===c})).sort((function(e,t){return+t.card.split("-")[0]-+e.card.split("-")[0]}))[0]}(e),c=e.round,i=e.handsState,s=e.currentHand;null===(t=this.gameRef)||void 0===t||t.child("rounds/".concat(c-1)).update((n={},Object($.a)(n,"won".concat(o.player),e["won".concat(o.player)]?e["won".concat(o.player)]+1:1),Object($.a)(n,"handsState",Object(te.a)(Object(te.a)({},i),{},(a={},Object($.a)(a,s,Object(te.a)(Object(te.a)({},(i||{})[s]),{},{status:"FINISHED",handWinner:o.player})),Object($.a)(a,s+1,{status:"ACTIVE",turnOf:o.player,thrownCards:[]}),a))),n)).then((function(){return setTimeout((function(){return 13!==s&&r.goToNextHand(e,o)}),200)}))}},{key:"goToNextHand",value:function(e,t){var a,n=e.round,r=e.currentHand;null===(a=this.gameRef)||void 0===a||a.child("rounds/".concat(n-1)).update({currentHand:r+1})}},{key:"calculateHandScore",value:function(e){var t,a=this,n=Object(te.a)({},this.state.gameData),r=n.rounds,o=n.currentRound,c=Object(te.a)({},e),i={};[0,1,2,3].forEach((function(e){return a.calculatePlayerScore(c,e,r,o-1,i)}));var s=function(e){var t=0,a=0;return[0,1,2,3].forEach((function(n){t+=+e["bid".concat(n)],a+=+e["won".concat(n)]})),{currentTotalBid:t,currentTotalWon:a}}(c).currentTotalWon;if(c.check=13===s,c.check&&r){var l;if(Ke(c))c.fell=!0,c.round<12?r[c.round].factor=2*c.factor:c.factor>1&&(r[c.round].factor=c.factor);else if(c.fell){c.fell=!1,r[c.round]&&(r[c.round].factor=c.factor>1?c.factor/2:c.factor);for(var u=0;u<4;u++)this.calculatePlayerScore(c,u,r,o-1,i)}var d=this.calculateSummary(r,o-1);if(13===c.round&&!c.fell){i.status=Bn.FINISHED,this.updateGameStatus(Bn.FINISHED);var m={totalScore0:i.totalScore0,totalScore1:i.totalScore1,totalScore2:i.totalScore2,totalScore3:i.totalScore3};d=this.calculateLeagueScores(m,d)}null===(l=this.gameSummaryRef)||void 0===l||l.update(this.mapToPlayersObj(d))}null===r||void 0===r||r.splice(o-1,1,c),i.rounds=r,null===(t=this.gameRef)||void 0===t||t.update(i)}},{key:"updateOwnCardState",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=Object.keys(a).find((function(t){return a[+t]===e}));Un.updateHandCardsState(this.gameKey,t,n)}}]),a}(o.Component);var Vn=a(248),Fn=(a(386),function(e){return c.a.createElement("div",{className:"full-view loader ".concat(e.className?e.className:"")},c.a.createElement(Q.a,{size:"large",style:{width:"100%",position:"relative",top:"50%"}}))}),zn=(a(387),{successRate:"Succes Win Rates",successRateHB:"Highest Bidding Win Rates",successRateOver:"Over Win Rate",successRateUnder:"Under Win Rate",successRateNT:"NT Win Rates",successRateLastBidder:"Last Bidder Win Rate"}),qn=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getTableHeaders=function(e){return e.map((function(e){var t=e.key,a=e.nickname;return c.a.createElement(ct.a,{key:t,span:6},c.a.createElement("div",{className:"table-cell"},a))}))},n.getScoreRow=function(e){return e.map((function(e){return c.a.createElement(ct.a,{span:6,key:e.key},c.a.createElement("div",{className:"table-cell"},e.games&&n.scoreReducer(e.games,"leagueScore")))}))},n.getStatsRow=function(e){var t=n.state.players;return c.a.createElement("div",{className:"stats-row",key:e},c.a.createElement("h4",null,zn[e]),c.a.createElement(ot.a,{gutter:1},n.getWinRateRow(t,e)))},n.getWinRateRow=function(e,t){return e.map((function(e){return c.a.createElement(ct.a,{span:6,key:e.key},c.a.createElement("div",{className:"table-cell"},e.games&&n.calculateRate(e.games,t),"%"))}))},n.scoreReducer=function(e,t){return e.reduce((function(e,a){return e+Number(a[t])}),0)},n.calculateRate=function(e,t){return n.toPercentage(n.preCalculateRate(e,t))},n.toPercentage=function(e){var t=e.wins,a=e.total;return Number.parseFloat(t/a*100).toFixed(0)},n.preCalculateRate=function(e,t){return e.reduce((function(e,a){var n=a[t];return e.wins+=n.wins,e.total+=n.total,e}),{wins:0,total:0})},n.state={players:e.league.players},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.gameSummaryRef.off("value")}},{key:"fetch",value:function(){var e=this,t=this.props.league.leagueID,a=this.state.players,n=v.database().ref();this.gameSummaryRef=n.child("leagueGamesSummary/_".concat(t)),this.leagueGamesRef=n.child("leagueGames/_".concat(t)).orderByChild("status").equalTo("FINISHED"),this.leagueGamesRef.on("value",(function(t){if(t.val()){var n=Object.keys(t.val()),r=n[n.length-1];e.gameSummaryRef.orderByKey().endAt(r).on("value",(function(t){var n=Object.values(t.val());e.setState({players:a.map((function(e){var t=e.key;return Object(te.a)(Object(te.a)({},e),{},{games:n.map((function(e,a){return e.players[t]}))})}))})}))}}))}},{key:"render",value:function(){var e=this.props.league.title,t=this.state.players;return c.a.createElement("div",{className:"game-summery"},c.a.createElement("h3",null,e),c.a.createElement("h3",null,"League Score:"),c.a.createElement(ot.a,{gutter:1,className:"table-header",style:{marginBottom:1}},this.getTableHeaders(t)),c.a.createElement(ot.a,{gutter:1},this.getScoreRow(t)),Object.keys(zn).map(this.getStatsRow))}}]),a}(o.Component),Kn=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"invitePlayers",value:function(t,a){return new Promise((function(n){var r=v.database().ref().child("notifications/gameInvites"),o=r.push().key,c=e.setInviteObj(t,o,a),i=c.invited,s=c.invite,l=Object($.a)({},"".concat(o),s);r.update(l).then((function(){return e.setAllInvited(i,r)})).then((function(t){var a=Object.keys(i);r.child("".concat(o,"/joinedPlayers")).on("child_added",(function(c){console.log(c.val());var i=a.indexOf(c.val());i>-1&&a.splice(i,1),console.log(a),a.length||(r.child("".concat(o,"/joinedPlayers")).off("child_added"),e.removeAllInvited(t),n())}))}))}))}},{key:"setInviteObj",value:function(e,t,a){var n,r=e.players,o=e.leagueID,c=e.title,i=null===(n=v.auth().currentUser)||void 0===n?void 0:n.uid,s=null===r||void 0===r?void 0:r.find((function(e){return e.key===i}));return{invited:r.filter((function(e){return e.key!==i})).reduce((function(e,a){return e[a.key]=t,e}),{}),invite:{inviter:s,inviteKey:t,leagueID:o,leagueTitle:c,newGameId:a}}}},{key:"setAllInvited",value:function(e,t){var a=[];return Object.keys(e).forEach((function(n){var r=t.child("invitedPlayers/".concat(n)).push(e[n]);a.push(r)})),Promise.all(a)}},{key:"removeAllInvited",value:function(e){e.forEach((function(e){e.set(null)}))}},{key:"acceptGameInvite",value:function(e){var t,a=e.inviteKey,n=v.database().ref().child("notifications/gameInvites/".concat(a,"/joinedPlayers")),r=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid;return new Promise((function(e){n.push(r).then((function(){n.on("value",(function(t){3===Object.values(t.val()).length&&(n.off("value"),e())}))}))}))}}]),e}(),Yn=Be.a.Content,Xn=Le.a.SubMenu,Jn=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).leagueRef=void 0,n.leagueGamesRef=void 0,n.toggleDrawer=function(){n.setState({drawerVisible:!n.state.drawerVisible})},n.setLoaderState=function(e){n.setState({loading:e})},n.setNewGameDialogState=function(e){n.setState({newGameDialog:e})},n.addGame=function(e){var t=n.state,a=t.league,r=t.leagueGames,o=a.leagueID,c=a.players,i=a.blockedBy,s=n.props,l=s.history,u=s.match,d=r.length+1,m=v.database().ref().child("games").push().key,f=function(e,t){var a=[],n={segment:"",totalBids:"",trump:"",check:!1,factor:1,fell:!1,highestBidder:"",inputMode:ze.BID,score0:"",aggregateScore0:"",bid0:"",won0:"",score1:"",aggregateScore1:"",bid1:"",won1:"",score2:"",aggregateScore2:"",bid2:"",won2:"",score3:"",aggregateScore3:"",bid3:"",won3:""};"remote"===t&&(n.currentHand=1);for(var r=0;r<13;r++)a.push(Object(te.a)({round:r+1},n));var o={wins:0,total:0};return{gameData:{rounds:a,currentRound:1,totalScore0:0,totalScore1:0,totalScore2:0,totalScore3:0,status:Bn.ACTIVE},gameSummary:{players:e.reduce((function(e,t){return e[t.key]={leagueScore:0,successRate:o,successRateHB:o,successRateOver:o,successRateUnder:o,successRateNT:o,successRateLastBidder:o},e}),{})}}}(c,e),h={};h["/games/".concat(m)]=Object(te.a)({gameID:d,dealer:"remote"===e&&i?i:""},f.gameData),h["/leagueGames/_".concat(o,"/").concat(m)]={gameID:d,gameMode:e,playersOrder:n.addGamePlayers(e,c),status:Bn.ACTIVE},h["/leagueGamesSummary/_".concat(o,"/").concat(m)]=Object(te.a)({},f.gameSummary),v.database().ref().update(h,(function(e){e||(n.setState({menuSelected:"".concat(d)}),l.push("".concat(u.url).concat("/game","/").concat(d)))}))};var r=e.location,o=e.match.params.leagueID,c=r.pathname.match(/game\/[1-9]/g)||[],i=!!c.length&&c[0].split("/")[1];n.state={loading:!1,menuSelected:i||"dashboard",league:{title:"",players:[]},leagueGames:[],drawerVisible:!1,newGameDialog:!1};var s=v.database().ref();return n.leagueRef=s.child("leagues/list/_".concat(o)),n.leagueGamesRef=s.child("leagueGames/_".concat(o)),n.handleMenuItemClick=n.handleMenuItemClick.bind(Object(d.a)(n)),n.newGameDialogHandler=n.newGameDialogHandler.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.leagueRef.off("value")}},{key:"fetch",value:function(){var e=this;this.setState({loading:!0}),this.leagueRef.on("value",(function(t){var a=t.val();console.log(a),a&&e.setState({league:Object(te.a)(Object(te.a)({},e.state.league),a),loading:!1})})),this.leagueGamesRef.on("child_added",(function(t){e.setState((function(e){return{leagueGames:[].concat(Object(ue.a)(e.leagueGames),[t.val()])}}))})),this.leagueGamesRef.on("child_changed",(function(t){console.log("child_changed",t.val()),e.setState((function(e){var a=e.leagueGames,n=a.findIndex((function(e){return e.gameID===t.val().gameID}));return{leagueGames:[].concat(Object(ue.a)(a.slice(0,n)),[Object(te.a)({},t.val())],Object(ue.a)(a.slice(n+1)))}}))}))}},{key:"render",value:function(){var e=this,t=this.props.match,a=this.state,n=a.league,r=a.loading,o=a.drawerVisible,i=n.leagueID,s=n.players;return c.a.createElement(Be.a,{className:"league-container"},c.a.createElement(Vn.a,{getContainer:".app",width:"250px",open:o,onHandleClick:this.toggleDrawer,onClose:this.toggleDrawer},c.a.createElement("div",{className:"drawer-title"},n.title),this.getMenu()),r&&c.a.createElement(Fn,{className:"with-mask"}),c.a.createElement(Be.a,null,c.a.createElement(Yn,null,c.a.createElement(h.a,{path:"".concat("/league","/:leagueID/game/:gameID"),render:function(t){return i?c.a.createElement(_n,Object.assign({},t,{players:s,loaderStateCb:e.setLoaderState})):c.a.createElement(Fn,null)}}),c.a.createElement(h.a,{exact:!0,path:t.url,render:function(e){return i?c.a.createElement(qn,Object.assign({},e,{league:n})):c.a.createElement(Fn,null)}}))))}},{key:"getMenu",value:function(){var e=this.props.match,t=this.state,a=t.leagueGames,n=t.menuSelected,r=t.newGameDialog;return c.a.createElement(Le.a,{mode:"inline",selectedKeys:[n],defaultOpenKeys:["gamesSub"],onClick:this.handleMenuItemClick,className:"league-menu"},c.a.createElement(Le.a.Item,{key:"dashboard"},c.a.createElement(Ae.a,null),c.a.createElement(G.b,{to:"".concat(e.url)},"League Summary")),c.a.createElement(Xn,{key:"gamesSub",title:c.a.createElement("span",null,c.a.createElement(He.a,null),c.a.createElement("span",null,"Games"))},a.map((function(t,a){return c.a.createElement(Le.a.Item,{key:t.gameID.toString()},c.a.createElement(G.b,{to:"".concat(e.url).concat("/game","/").concat(t.gameID)},"Game ",t.gameID))})),c.a.createElement(Le.a.Item,{key:"new_game"},c.a.createElement(Ge.a,null),c.a.createElement("span",null,"New Game"))),r&&c.a.createElement(xe,{dialog:ye.NEW_GAME,dialogProps:{visible:!0,onAfterClose:this.newGameDialogHandler}}),c.a.createElement(Le.a.Item,{key:"main_menu"},c.a.createElement(Ue.a,{className:"rotate-180"}),c.a.createElement(G.b,{to:"/"},"To Main Menu")))}},{key:"handleMenuItemClick",value:function(e){var t=this,a=e.key;"new_game"===a?this.isAddGameOk()?this.blockLeague().then((function(){t.setNewGameDialogState(!0)}),(function(e){console.error(e),Te.b.warning("One of the players is blocking!!")})):Te.b.warning("Last Game is not finished yet!!"):"main_menu"!==a&&a!==this.state.menuSelected&&this.setState({menuSelected:a}),setTimeout(this.toggleDrawer,200)}},{key:"blockLeague",value:function(){var e,t=null===(e=v.auth().currentUser)||void 0===e?void 0:e.uid;return this.leagueRef.child("blockedBy").set(t)}},{key:"unblockLeague",value:function(){this.leagueRef.update({blockedBy:null})}},{key:"newGameDialogHandler",value:function(e){var t=this;if(this.setState({newGameDialog:!1}),"local"===e)this.unblockLeague(),this.addGame(e);else if("remote"===e){this.setState({loading:!0});var a=this.state,n=a.league,r=a.leagueGames.length+1;Kn.invitePlayers(Object(te.a)({},n),r).then((function(){console.log("inventation resolved- ok to add game"),t.addGame("remote"),t.setState({loading:!1})}))}}},{key:"addGamePlayers",value:function(e,t){return t&&"remote"===e?function(e){return he(e)}(t):null}},{key:"isAddGameOk",value:function(){var e=this.state.leagueGames,t=e[e.length-1];return!t||t.status===Bn.FINISHED}}]),a}(c.a.Component),Qn=Z((function(e){return!!e}))(Jn),Zn=function(e){Object(m.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).unlistenHistory=void 0,n.onGameInvite=function(e){n.setState({showGameInvite:!0,invite:e})},n.acceptGameInvite=function(){var e=n.state.invite;n.setState({loader:!0}),e&&Kn.acceptGameInvite(e).then((function(){n.setState({loader:!1});var t=n.props.history,a=e.leagueID,r=e.newGameId;setTimeout((function(){return t.push("".concat("/league","/").concat(a,"/game/").concat(r))}),500)}),(function(){n.setState({loader:!1})}))},n.closeGameInvite=function(){n.setState({showGameInvite:!1})},n.state={inlineHeader:!1,showGameInvite:!1,loader:!1},n.toggleHeaderInline=n.toggleHeaderInline.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"toggleHeaderInline",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({inlineHeader:e})}},{key:"componentWillMount",value:function(){var e=this,t=this.props.location.pathname;this.toggleHeaderInline("/"!==t),this.unlistenHistory=this.props.history.listen((function(t,a){var n=t.pathname;e.toggleHeaderInline("/"!==n&&"/login"!==n)}))}},{key:"componentWillUnmount",value:function(){this.unlistenHistory()}},{key:"componentDidMount",value:function(){var e=this;v.auth().onAuthStateChanged((function(t){t&&N.registerGameInvite(e.onGameInvite)}))}},{key:"render",value:function(){var e=this.state,t=e.inlineHeader,a=e.showGameInvite,n=e.invite,r=e.loader;return c.a.createElement("div",{className:"app-wrapper ".concat("undefined"!==typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")?"mobile-mode":"desktop-mode")},c.a.createElement("img",{src:P.a,alt:""}),c.a.createElement("div",{className:"app ".concat(t?"inline-header":"")},c.a.createElement("header",{id:"app-header"},c.a.createElement("img",{src:I.a,className:"app-logo",alt:"logo"}),c.a.createElement("h1",{className:"app-title"},"Sub Whist")),r&&c.a.createElement(Fn,{className:"with-mask"}),c.a.createElement("div",{className:"app-content"},c.a.createElement(h.a,{exact:!0,path:"/",component:Pe}),c.a.createElement(h.a,{exact:!0,path:"/login",component:z}),c.a.createElement(h.a,{exact:!0,path:"/signup",component:J}),c.a.createElement(h.a,{path:"".concat("/league","/:leagueID"),render:function(e){return c.a.createElement(Qn,e)}}))),a&&c.a.createElement(xe,{dialog:ye.GAME_INVITE,dialogProps:{visible:!0,invite:n,onAfterClose:this.closeGameInvite,onOk:this.acceptGameInvite}}))}}]),a}(o.Component),$n=Object(h.e)(L(Zn)),er=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function tr(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(388);s.a.render(c.a.createElement(G.a,{basename:"/whist"},c.a.createElement($n,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/whist",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/whist","/service-worker.js");er?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):tr(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):tr(e)}))}}()}},[[251,1,2]]]);
//# sourceMappingURL=main.6abc0e23.chunk.js.map