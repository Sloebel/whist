{"version":3,"sources":["images/playCards/2-C.svg","images/playCards/2-D.svg","images/playCards/2-H.svg","images/playCards/2-J.svg","images/playCards/2-S.svg","images/playCards/3-C.svg","images/playCards/3-D.svg","images/playCards/3-H.svg","images/playCards/3-S.svg","images/playCards/4-C.svg","images/playCards/4-D.svg","images/playCards/4-H.svg","images/playCards/4-S.svg","images/playCards/5-C.svg","images/playCards/5-D.svg","images/playCards/5-H.svg","images/playCards/5-S.svg","images/playCards/6-C.svg","images/playCards/6-D.svg","images/playCards/6-H.svg","images/playCards/6-S.svg","images/playCards/7-C.svg","images/playCards/7-D.svg","images/playCards/7-H.svg","images/playCards/7-S.svg","images/playCards/8-C.svg","images/playCards/8-D.svg","images/playCards/8-H.svg","images/playCards/8-S.svg","images/playCards/9-C.svg","images/playCards/9-D.svg","images/playCards/9-H.svg","images/playCards/9-S.svg","images/playCards/10-C.svg","images/playCards/10-D.svg","images/playCards/10-H.svg","images/playCards/10-S.svg","images/playCards/11-C.svg","images/playCards/11-D.svg","images/playCards/11-H.svg","images/playCards/11-S.svg","images/playCards/12-C.svg","images/playCards/12-D.svg","images/playCards/12-H.svg","images/playCards/12-S.svg","images/playCards/13-C.svg","images/playCards/13-D.svg","images/playCards/13-H.svg","images/playCards/13-S.svg","images/playCards/14-C.svg","images/playCards/14-D.svg","images/playCards/14-H.svg","images/playCards/14-S.svg","cards.png","images/phone.png","assets/sounds/playerTurn.mp3","images/playCards sync /^/.*/.svg$","firebase/fire.ts","firebase/auth.ts","firebase/db.ts","utils/events/EventEmitter.ts","services/NotificationSrv.ts","authentication/AuthUserContext.ts","authentication/withAuthentication.tsx","authentication/Login.tsx","constants/routes.ts","authentication/SignUp.tsx","authentication/withAuthorization.tsx","dialogs/NewLeague.tsx","dialogs/ResumeLeague.js","utils/Utils.ts","common/dragPad/DragPad.js","constants/dialogs.ts","dialogs/ReorderPlayers.tsx","dialogs/NewGameDialog/NewGameDialog.tsx","dialogs/GameInvite.tsx","constants/cards.ts","dialogs/Dialog.tsx","main/MainMenu.tsx","main/Main.js","constants/states.ts","utils/game-utils.ts","common/cards/Icons.js","common/table/MobileTable.js","common/table/renderers.js","common/cards/Modal.js","common/numbers/Pad.js","common/transition/Css.js","common/player/Pad.js","common/twoWayArrow/TwoWayArrow.jsx","game/PlayCard/PlayCard.tsx","game/ThrownCard/ThrownCard.tsx","game/GamePad/GamePad.js","models/IGameModel.ts","game/GameMobileView.js","constants/scores.ts","services/GameSrv.ts","game/GameTab.tsx","common/loader/Loader.tsx","leagueSummary/LeagueSummary.js","services/LeagueSrv.ts","league/League.tsx","dataTemplates/gameTpl.ts","App.tsx","registerServiceWorker.js","index.tsx"],"names":["module","exports","map","webpackContext","req","id","webpackContextResolve","__webpack_require__","o","e","Error","code","keys","Object","resolve","fire","firebase","initializeApp","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","auth","db","database","createUser","email","password","createUserWithEmailAndPassword","signInUser","signInWithEmailAndPassword","signOut","usersRef","ref","leaguesRef","doCreateUser","userInfo","set","onceGetUsers","once","onceGetLeagues","EventEmitter","handlers","handler","this","push","filter","h","data","slice","forEach","gameInviteEventEmitter","callback","on","userId","currentUser","uid","gameInvitesRef","child","invite","val","snapshot","console","log","trigger","AuthUserContext","React","createContext","withAuthentication","Component","state","authUser","onAuthStateChanged","setState","Provider","value","props","FormItem","Item","Login","isLoading","handleSubmit","values","history","then","catch","error","alert","message","Consumer","style","textAlign","marginTop","type","size","onClick","goBack","icon","ArrowLeftOutlined","to","onFinish","className","name","rules","required","prefix","MailOutlined","color","placeholder","LockOutlined","htmlType","loading","withRouter","SignUp","formRef","createRef","handleConfirmBlur","target","confirmDirty","compareToFirstPassword","rule","form","current","getFieldValue","validateToNextPassword","validateFields","nickname","user","UserOutlined","SmileOutlined","validator","onBlur","withAuthorization","authCondition","WithAuthorization","width","position","top","Option","NewLeague","leagueID","onCreateLeague","users","description","savingLeagueLoader","players","key","lastID","newID","active","setNewLeagueID","closeModal","showDialog","afterClose","onAfterClose","visible","count","fetchPlayers","title","destroyOnClose","maskClosable","confirmLoading","onOk","onCancel","okText","getContainer","layout","label","len","mode","notFoundContent","ResumeLeague","activeLeagues","footer","itemLayout","dataSource","renderItem","item","Meta","hasTouch","window","navigator","maxTouchPoints","document","documentElement","addListener","element","addEventListener","removeEventListener","shuffle","array","arrayCopy","i","length","j","Math","floor","random","springSetting1","stiffness","damping","springSetting2","clamp","n","min","max","Dialogs","allColors","height","DragPad","handleTouchStart","pressLocation","handleMouseDown","touches","handleTouchMove","preventDefault","handleMouseMove","pageX","pageY","order","lastPress","isPressed","mouseCircleDelta","dx","dy","mouseXY","col","round","row","from","findIndex","p","newOrder","arr","_arr","abs","splice","unshift","pop","reorder","pressX","pressY","handleMouseUp","onChange","colors","reduce","colorObj","player","unListenTouchmove","unListenTouchend","unListenMousemove","unListenMouseup","x","y","visualPosition","translateX","translateY","scale","spring","boxShadow","onMouseDown","bind","onTouchStart","backgroundColor","WebkitTransform","transform","zIndex","ReorderPlayers","handleOnCancel","handleOnOk","handleDragChange","NewGameDialog","setGameMode","modeSelected","handleAfterClose","wrapClassName","closable","centered","cancelText","bodyStyle","display","GameInvite","handleOk","handleCancel","leagueTitle","newGameId","inviter","CARDS","CARDS_SHORT","DialogsMapping","NEW_LEAGUE","NewLeagueDialog","RESUME_LEAGUE","ResumeLeagueDialog","REORDER_PLAYERS","NEW_GAME","GAME_INVITE","Dialog","dialog","dialogProps","DialogEl","MainMenu","items","index","text","disabled","block","Main","newLeague","resumeLeague","orderByChild","equalTo","some","fetch","off","navigateToLeague","showResumeLeagueDialog","closeResumeLeagueDialog","showNewLeagueDialog","closeNewLeagueDialog","INPUT_MODE","CardsType","CLUB","C","DIAMOND","D","HART","H","SPADE","S","NT","DrawCardsType","calcIfRoundFell","roundData","didRoundFell","bid","won","cardsList","cardsFamilyScoreMap","getDevicePlayerIndex","nextPlayerIndex","dealCards","shuffledCards","shuffleCards","arrayOf4","sortCardsArrays","setCardsByPlayer","cardsArray","cardsArr","obj","sortCards","cards","sort","cardX","cardY","split","cardXNum","cardXType","cardYNum","cardYType","Spade","viewBox","enableBackground","d","fill","Hart","Diamond","points","Club","ChangePlayers","MobileTable","rounds","currentRound","leagueScores","gameID","gutter","marginBottom","span","getTableHeaders","fell","factor","getRoundCol","TrophyTwoTone","twoToneColor","getLeagueScoresCol","playerIndex","playerName","highestBidder","Icon","component","cardsRenderer","trump","CardsModal","showModal","trumpIconMap","prevProp","ghost","QuestionOutlined","onTrumpSelect","NumbersPad","getButtons","baseNum","amount","disabledNumber","Array","num","onBtnClick","showMore","toggleMore","onSelect","textContent","CSS_TRANSITIONS","Css","div","classList","add","setTimeout","remove","prevProps","children","el","PlayerPad","score","undefined","TWO_WAY_ARROW_DIRECTION","TwoWayArrow","direction","PlayCard","card","preSelected","thrown","onCardClick","clickHandler","useCallback","event","Card2C","src","Card2D","Card2H","Card2J","Card2S","Card3C","Card3D","Card3H","Card3S","Card4C","Card4D","Card4H","Card4S","Card5C","Card5D","Card5H","Card5S","Card6C","Card6D","Card6H","Card6S","Card7C","Card7D","Card7H","Card7S","Card8C","Card8D","Card8H","Card8S","Card9C","Card9D","Card9H","Card9S","Card10C","Card10D","Card10H","Card10S","Card11C","Card11D","Card11H","Card11S","Card12C","Card12D","Card12H","Card12S","Card13C","Card13D","Card13H","Card13S","Card14C","Card14D","Card14H","Card14S","getCard","ThrownCard","thrownType","hasWinner","useState","setStyle","useEffect","require","confirm","config","maxCount","GAME_STATUS","GamePad","audio","Audio","playerTurn","getNextPlayer","selectedPlayer","getBeforePlayer","getBeforePlayerBid","getRoundData","getBeforePlayers","getPlayerAggregateScore","roundsData","roundIndex","aggregateScore","getPlayersButtons","allRounds","currentRoundData","dot","Button","handleCardClick","preSelectedCard","devicePlayerIndex","onCardThrown","inputMode","WON","currentTarget","offsetParent","offsetTop","left","offsetLeft","ownThrownCardInitPos","thrownCards","currentHand","thrownCard","isAllBids","every","_","toggleMute","isMute","reorderPlayersDialogVisible","trumpModalVisible","handCardType","handleSwitchMode","handleCardsPadChange","handleNumberSelect","setSelectedPlayer","showChangeHighestBidderConfirm","showChangePlayerDialog","handleReorderPlayersAfterClose","gameMode","ownCardsState","handsState","prevAllRounds","prevCurrentRound","prevCurrentRoundData","playAudio","currentBidder","BID","stateToUpdate","find","hand","uniqueResult","Map","playerHand","has","uniqueHand","checked","segment","warning","everyoneBid","isAllowedToSelectPlayer","handleRemoteBidFlow","prop","newRoundData","nextPlayer","nextPlayerBid","beforePlayerBid","beforePlayers","bids","aBid","content","okType","bid0","bid1","bid2","bid3","check","playersButtons","isRemote","Group","buttonStyle","justify","checkedChildren","unCheckedChildren","SoundOutlined","cardsMarkerRef","calculateDisableNum","isNumberPadDisabled","shape","PlayersContext","reorderPlayers","getThrownCardsPlacement","getCards","hasCardType","isDevicePlayer","handWinner","fn","playerOnPadMap","toWinner","getFromTo","markerTop","markerWidth","offsetWidth","CARD_MARKER_HEIGHT","CARD_HEIGHT","CARD_WIDTH","getToWinnerCalc","fromTop","fromLeft","getFromToCalc","play","GameMobileView","carouselSwipedLeft","currentView","onCurrentViewChange","carouselEl","nextRound","goToRound","Number","toRoundBefore","carouselSwipedRight","unListenSwipedLeft","unListenSwipedRight","playersColumns","handleSave","handleCardThrown","showNavigation","LeftOutlined","RightOutlined","GAME_DEFAULT_SCORES","GameService","gameKey","cardsByPlayer","update","cardsState","cardIndex","playersOrder","GameTab","gameRef","leagueGamesRef","gameSummaryRef","ownCardsStateRef","summaryToUpdate","prevRounds","gameData","newData","calculatePlayerScore","currentTotalBid","currentTotalWon","allHasWonInput","entries","indexOf","getTotalWonBid","calculateSummary","status","FINISHED","updateGameStatus","scores","totalScore0","totalScore1","totalScore2","totalScore3","totalScore","calculateLeagueScores","mapToPlayersObj","newThrownCards","turnOf","updateOwnCardState","rowScore","pow","diff","a","b","scoreIndex","leagueScore","currentRoundIndex","playersSummary","pIndex","stood","totalRounds","totalHBrounds","stoodWhileHB","stoodInOver","totalOverRounds","stoodInUnder","totalNTrounds","stoodInNT","stoodWhenLastBidder","totalStoodWhenLastBidder","rIndex","lastBidder","successRate","wins","total","successRateHB","successRateOver","successRateUnder","successRateNT","successRateLastBidder","gameSummary","match","params","toggleSlide","setCurrentViewState","getLeagueScores","leagueScore0","leagueScore1","leagueScore2","leagueScore3","summaryObj","initColumns","columns","dealer","selectActiveRound","handleReorderPlayers","snap","gameRefData","loaderStateCb","prevState","handleGameModeChange","currentHandState","handleHandFinished","calculateHandScore","newRound","setCardsToPlayers","createPortal","BorderOuterOutlined","TableOutlined","querySelector","body","winner","trumpCards","calculateHandWinner","goToNextHand","gameToUpdate","getTotalRemoteWonBid","updateHandCardsState","Loader","statsObj","LeagueSummary","getScoreRow","games","scoreReducer","getStatsRow","statsKey","getWinRateRow","calculateRate","sum","game","toPercentage","preCalculateRate","parseFloat","toFixed","sumObj","category","league","dbRef","gameKeys","lastKey","orderByKey","endAt","playerKey","LeagueService","Promise","inviteKey","setInviteObj","invited","setAllInvited","invitedRefs","playersKeys","removeAllInvited","sets","promise","all","gameInviteRef","Content","SubMenu","League","leagueRef","toggleDrawer","drawerVisible","setLoaderState","setNewGameDialogState","show","newGameDialog","addGame","leagueGames","blockedBy","newGameKey","gameTpl","initRoundData","totalBids","score0","aggregateScore0","won0","score1","aggregateScore1","won1","score2","aggregateScore2","won2","score3","aggregateScore3","won3","rateInit","ACTIVE","gameDataTpl","updates","addGamePlayers","menuSelected","url","location","matchGame","pathname","handleMenuItemClick","newGameDialogHandler","leagueData","changedIndex","open","onHandleClick","onClose","getMenu","path","render","exact","selectedKeys","defaultOpenKeys","DashboardOutlined","GoldOutlined","toString","PlusOutlined","ExportOutlined","isAddGameOk","blockLeague","unblockLeague","invitePlayers","shufflePlayers","lastGame","App","unlistenHistory","onGameInvite","showGameInvite","acceptGameInvite","loader","closeGameInvite","inlineHeader","toggleHeaderInline","inline","listen","action","NotificationService","registerGameInvite","orientation","userAgent","phoneImg","alt","isLocalhost","Boolean","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","basename","getElementById","URL","origin","response","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"mFAAAA,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,iC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,kC,oBCA3CD,EAAOC,QAAU,IAA0B,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","file":"static/js/main.dbe44bec.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/2-C.8a51f4b1.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-D.dd5bdb07.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-H.15c2e192.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-J.2efb9493.svg\";","module.exports = __webpack_public_path__ + \"static/media/2-S.bce46c7b.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-C.6f681593.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-D.15244443.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-H.5d6c501c.svg\";","module.exports = __webpack_public_path__ + \"static/media/3-S.56340b99.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-C.b4c5fedb.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-D.c1449960.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-H.a23231b3.svg\";","module.exports = __webpack_public_path__ + \"static/media/4-S.10c84208.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-C.0eb86f9c.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-D.152f12ae.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-H.8196387a.svg\";","module.exports = __webpack_public_path__ + \"static/media/5-S.143b7322.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-C.4cb8bdad.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-D.bd92854e.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-H.19f2ecf2.svg\";","module.exports = __webpack_public_path__ + \"static/media/6-S.ade7c7e4.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-C.d8d8520b.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-D.204f8d6f.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-H.f0681bb0.svg\";","module.exports = __webpack_public_path__ + \"static/media/7-S.f6bb3b39.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-C.fe3de886.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-D.b6635e40.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-H.eac2a810.svg\";","module.exports = __webpack_public_path__ + \"static/media/8-S.6e2329eb.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-C.a91a0922.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-D.2c4bfcfc.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-H.75cb4cf1.svg\";","module.exports = __webpack_public_path__ + \"static/media/9-S.30d03378.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-C.90a1d2da.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-D.1e7ceb93.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-H.a99c411d.svg\";","module.exports = __webpack_public_path__ + \"static/media/10-S.8b991ebd.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-C.e4d58ae7.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-D.b2cc7b26.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-H.c357eab3.svg\";","module.exports = __webpack_public_path__ + \"static/media/11-S.e9f02fbd.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-C.483c9a18.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-D.e34fab0b.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-H.ddc0d874.svg\";","module.exports = __webpack_public_path__ + \"static/media/12-S.84f4e7a8.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-C.f612b546.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-D.0ff22a04.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-H.60e7d399.svg\";","module.exports = __webpack_public_path__ + \"static/media/13-S.22bb59a1.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-C.49a458de.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-D.3fde324e.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-H.e892e743.svg\";","module.exports = __webpack_public_path__ + \"static/media/14-S.78374225.svg\";","module.exports = __webpack_public_path__ + \"static/media/cards.03003d3d.png\";","module.exports = __webpack_public_path__ + \"static/media/phone.b4836590.png\";","module.exports = __webpack_public_path__ + \"static/media/playerTurn.303a9497.mp3\";","var map = {\n\t\"./10-C.svg\": 198,\n\t\"./10-D.svg\": 199,\n\t\"./10-H.svg\": 200,\n\t\"./10-S.svg\": 201,\n\t\"./11-C.svg\": 202,\n\t\"./11-D.svg\": 203,\n\t\"./11-H.svg\": 204,\n\t\"./11-S.svg\": 205,\n\t\"./12-C.svg\": 206,\n\t\"./12-D.svg\": 207,\n\t\"./12-H.svg\": 208,\n\t\"./12-S.svg\": 209,\n\t\"./13-C.svg\": 210,\n\t\"./13-D.svg\": 211,\n\t\"./13-H.svg\": 212,\n\t\"./13-S.svg\": 213,\n\t\"./14-C.svg\": 214,\n\t\"./14-D.svg\": 215,\n\t\"./14-H.svg\": 216,\n\t\"./14-S.svg\": 217,\n\t\"./2-C.svg\": 134,\n\t\"./2-D.svg\": 166,\n\t\"./2-H.svg\": 167,\n\t\"./2-J.svg\": 168,\n\t\"./2-S.svg\": 169,\n\t\"./3-C.svg\": 170,\n\t\"./3-D.svg\": 171,\n\t\"./3-H.svg\": 172,\n\t\"./3-S.svg\": 173,\n\t\"./4-C.svg\": 174,\n\t\"./4-D.svg\": 175,\n\t\"./4-H.svg\": 176,\n\t\"./4-S.svg\": 177,\n\t\"./5-C.svg\": 178,\n\t\"./5-D.svg\": 179,\n\t\"./5-H.svg\": 180,\n\t\"./5-S.svg\": 181,\n\t\"./6-C.svg\": 182,\n\t\"./6-D.svg\": 183,\n\t\"./6-H.svg\": 184,\n\t\"./6-S.svg\": 185,\n\t\"./7-C.svg\": 186,\n\t\"./7-D.svg\": 187,\n\t\"./7-H.svg\": 188,\n\t\"./7-S.svg\": 189,\n\t\"./8-C.svg\": 190,\n\t\"./8-D.svg\": 191,\n\t\"./8-H.svg\": 192,\n\t\"./8-S.svg\": 193,\n\t\"./9-C.svg\": 194,\n\t\"./9-D.svg\": 195,\n\t\"./9-H.svg\": 196,\n\t\"./9-S.svg\": 197\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 384;","import firebase from \"firebase/app\";\nimport \"firebase/database\";\nimport \"firebase/auth\";\n\n// Initialize Firebase\nconst config = {\n  apiKey: process.env.REACT_APP_API_KEY,\n  authDomain: process.env.REACT_APP_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_DATABASE_URL,\n  projectId: process.env.REACT_APP_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_MESSAGING_SENDER_ID\n};\nconst fire = firebase.initializeApp(config);\n\nconst auth = firebase.auth();\nconst db = firebase.database();\n\nexport { fire, db, auth };\n\n// export default fire;\n","import { auth } from './fire';\n\n// Sign Up\nexport const createUser = (email: string, password: string) =>\n  auth.createUserWithEmailAndPassword(email, password);\n\n// Sign In\nexport const signInUser = (email: string, password: string) =>\n  auth.signInWithEmailAndPassword(email, password);\n\n// Sign out\nexport const signOut = () => auth.signOut();\n","import { db } from './fire';\r\n\r\n// database refs\r\nexport const usersRef = db.ref('users');\r\nexport const leaguesRef = db.ref('leagues');\r\n\r\n// User API\r\n\r\nexport const doCreateUser = (id: any, userInfo: any) =>\r\n  db.ref(`users/${id}`).set(userInfo);\r\n\r\nexport const onceGetUsers = () => usersRef.once('value');\r\n\r\nexport const onceGetLeagues = () => leaguesRef.once('value');\r\n","export interface IEventEmitter<T> {\r\n  on(handler: (data?: T) => void): void;\r\n  off(handler: (data?: T) => void): void;\r\n}\r\n\r\nexport type IHandler<T> = (data: T) => void;\r\n\r\nexport class EventEmitter<T> {\r\n  private handlers: Array<IHandler<T>> = [];\r\n\r\n  public on(handler: IHandler<T>): void {\r\n    this.handlers.push(handler);\r\n  }\r\n\r\n  public off(handler: IHandler<T>): void {\r\n    this.handlers = this.handlers.filter(h => h !== handler);\r\n  }\r\n\r\n  public trigger(data: T) {\r\n    this.handlers.slice(0).forEach(h => h(data));\r\n  }\r\n}\r\n","import { fire } from '../firebase';\r\nimport { EventEmitter } from '../utils/events/EventEmitter';\r\nimport { IGameInvite } from './LeagueSrv';\r\n\r\n// TODO: handle posible of many notification\r\n// for example: two game invites from two different leagues\r\nclass NotificationsService {\r\n  private gameInviteEventEmitter: EventEmitter<\r\n    IGameInvite\r\n  > = new EventEmitter();\r\n\r\n  public registerGameInvite(callback: (invite: IGameInvite) => void) {\r\n    this.gameInviteEventEmitter.on(callback);\r\n\r\n    const userId = fire.auth().currentUser?.uid;\r\n    const gameInvitesRef = fire\r\n      .database()\r\n      .ref()\r\n      .child(`notifications/gameInvites`);\r\n\r\n    gameInvitesRef\r\n      .child(`/invitedPlayers/${userId}`)\r\n      .on('child_added', (invite) => {\r\n        gameInvitesRef.child(invite.val()).once('value', (snapshot) => {\r\n          console.log(snapshot.val());\r\n          this.gameInviteEventEmitter.trigger(snapshot.val());\r\n        });\r\n      });\r\n  }\r\n}\r\n\r\nexport default new NotificationsService();\r\n","import React from 'react';\n\nexport type UserContext = firebase.User | null;\n\nconst AuthUserContext = React.createContext<UserContext>(null);\n\nexport default AuthUserContext;\n","import React from 'react';\r\nimport { fire } from '../firebase';\r\nimport AuthUserContext from './AuthUserContext';\r\n\r\nconst withAuthentication = <TProps,>(Component: React.ComponentType<TProps>) => {\r\n  class WithAuthentication extends React.Component<TProps> {\r\n    public state = {\r\n      authUser: null,\r\n    };\r\n\r\n    componentDidMount() {\r\n      fire.auth().onAuthStateChanged(authUser => {\r\n        authUser\r\n          ? this.setState({ authUser })\r\n          : this.setState({ authUser: null });\r\n      });\r\n    }\r\n\r\n    render() {\r\n      const { authUser } = this.state;\r\n\r\n      return (\r\n        <AuthUserContext.Provider value={authUser}>\r\n          <Component {...this.props} />\r\n        </AuthUserContext.Provider>\r\n      );\r\n    }\r\n  }\r\n\r\n  return WithAuthentication;\r\n};\r\n\r\nexport default withAuthentication;\r\n","import React from \"react\";\r\nimport { withRouter, Link, RouteComponentProps } from \"react-router-dom\";\r\nimport { Form, Input, Button } from \"antd\";\r\nimport {\r\n  MailOutlined,\r\n  LockOutlined,\r\n  ArrowLeftOutlined\r\n} from \"@ant-design/icons\";\r\nimport * as routes from \"../constants/routes\";\r\nimport { auth } from \"../firebase\";\r\nimport AuthUserContext from \"./AuthUserContext\";\r\n\r\nimport \"./Login.scss\";\r\nimport { IFormValues } from \"../models/common/BasicTypes\";\r\n\r\nconst FormItem = Form.Item;\r\n\r\nexport interface ILoginState {\r\n  isLoading: boolean;\r\n}\r\n\r\nexport interface ILoginProps extends RouteComponentProps {}\r\n\r\nclass Login extends React.Component<ILoginProps, ILoginState> {\r\n  state = {\r\n    isLoading: false\r\n  };\r\n\r\n  private handleSubmit = (values: IFormValues) => {\r\n    this.setState({ isLoading: true });\r\n\r\n    const { history } = this.props;\r\n    const { email, password } = values;\r\n\r\n    auth\r\n      .signInUser(email, password)\r\n      .then(authUser => {\r\n        console.log(authUser);\r\n        history.push(routes.MAIN);\r\n      })\r\n      .catch(error => {\r\n        // Handle Errors here.\r\n        // var errorCode = error.code;\r\n        // var errorMessage = error.message;\r\n        // ...\r\n        alert(error.message);\r\n        this.setState({ isLoading: false });\r\n      });\r\n  };\r\n\r\n  public render() {\r\n    const { history } = this.props;\r\n    const { isLoading } = this.state;\r\n\r\n    return (\r\n      <AuthUserContext.Consumer>\r\n        {authUser =>\r\n          !authUser ? (\r\n            <Form onFinish={this.handleSubmit} className=\"login-form\">\r\n              <FormItem\r\n                name=\"email\"\r\n                rules={[\r\n                  {\r\n                    type: \"email\",\r\n                    message: \"The input is not valid E-mail!\"\r\n                  },\r\n                  {\r\n                    required: true,\r\n                    message: \"Please input your email!\"\r\n                  }\r\n                ]}\r\n              >\r\n                <Input\r\n                  prefix={<MailOutlined style={{ color: \"rgba(0,0,0,.25)\" }} />}\r\n                  placeholder=\"email\"\r\n                  size=\"large\"\r\n                />\r\n              </FormItem>\r\n              <FormItem\r\n                name=\"password\"\r\n                rules={[\r\n                  { required: true, message: \"Please input your Password!\" }\r\n                ]}\r\n              >\r\n                <Input\r\n                  prefix={<LockOutlined style={{ color: \"rgba(0,0,0,.25)\" }} />}\r\n                  type=\"password\"\r\n                  placeholder=\"password\"\r\n                  size=\"large\"\r\n                />\r\n              </FormItem>\r\n              <FormItem>\r\n                {/* <a className=\"login-form-forgot\" href=\"\">\r\n                  Forgot password\r\n                </a> */}\r\n                <Button\r\n                  type=\"primary\"\r\n                  htmlType=\"submit\"\r\n                  size=\"large\"\r\n                  className=\"login-form-button\"\r\n                  loading={isLoading}\r\n                >\r\n                  Log in\r\n                </Button>\r\n                Or <Link to={routes.SIGN_UP}>register now!</Link>\r\n              </FormItem>\r\n            </Form>\r\n          ) : (\r\n            <div style={{ textAlign: \"center\", marginTop: \"50px\" }}>\r\n              <p>You are already logged in,</p>\r\n              <Button\r\n                type=\"primary\"\r\n                size=\"small\"\r\n                onClick={() => history.goBack()}\r\n                icon={<ArrowLeftOutlined />}\r\n              >\r\n                Go back\r\n              </Button>{\" \"}\r\n              or <Link to={routes.MAIN}>Go Home</Link>\r\n            </div>\r\n          )\r\n        }\r\n      </AuthUserContext.Consumer>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Login);\r\n","export const SIGN_IN = '/login';\nexport const SIGN_UP = '/signup';\nexport const MAIN = '/';\nexport const LEAGUE = '/league';\nexport const GAME = '/game';","import React from 'react';\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\r\nimport { Form, Input, Button } from 'antd';\r\nimport {\r\n  SmileOutlined,\r\n  UserOutlined,\r\n  MailOutlined,\r\n  LockOutlined,\r\n} from '@ant-design/icons';\r\nimport { auth, db } from '../firebase';\r\nimport './Login.scss';\r\nimport { IFormValues } from '../models/common/BasicTypes';\r\nimport { FormInstance } from 'antd/lib/form';\r\n\r\nconst FormItem = Form.Item;\r\n\r\ninterface ISignUpState {\r\n  confirmDirty: boolean;\r\n  isLoading: boolean;\r\n}\r\n\r\ninterface ISignUpProps extends RouteComponentProps {}\r\n\r\nclass SignUp extends React.Component<ISignUpProps, ISignUpState> {\r\n  private formRef = React.createRef<FormInstance>();\r\n\r\n  public constructor(props: ISignUpProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      confirmDirty: false,\r\n      isLoading: false,\r\n    };\r\n  }\r\n\r\n  private handleConfirmBlur = (e: React.FocusEvent<HTMLInputElement>) => {\r\n    const value = e.target.value;\r\n    this.setState({ confirmDirty: this.state.confirmDirty || !!value });\r\n  };\r\n\r\n  private compareToFirstPassword = (rule: any, value: any, callback: any) => {\r\n    const form = this.formRef.current;\r\n\r\n    if (form && value && value !== form.getFieldValue('password')) {\r\n      callback('Two passwords that you enter is inconsistent!');\r\n    } else {\r\n      callback();\r\n    }\r\n  };\r\n\r\n  private validateToNextPassword = (rule: any, value: any, callback: any) => {\r\n    const form = this.formRef.current;\r\n\r\n    if (value && this.state.confirmDirty) {\r\n      form && form.validateFields(['confirm']);\r\n    }\r\n    callback();\r\n  };\r\n\r\n  private handleSubmit = (values: IFormValues) => {\r\n    this.setState({ isLoading: true });\r\n\r\n    const { name, nickname, email, password } = values;\r\n    auth\r\n      .createUser(email, password)\r\n      .then(authUser => {\r\n        // Create a user in own accessible Firebase Database too\r\n        authUser &&\r\n          authUser.user &&\r\n          db\r\n            .doCreateUser(authUser.user.uid, { name, nickname, email })\r\n            .then(() => {\r\n              this.props.history.push('/');\r\n            })\r\n            .catch(error => {\r\n              alert(error.message);\r\n              this.setState({ isLoading: false });\r\n            });\r\n      })\r\n      .catch(error => {\r\n        alert(error.message);\r\n        this.setState({ isLoading: false });\r\n      });\r\n  };\r\n\r\n  public render() {\r\n    const { isLoading } = this.state;\r\n\r\n    return (\r\n      <Form\r\n        onFinish={this.handleSubmit}\r\n        ref={this.formRef}\r\n        className=\"login-form\"\r\n      >\r\n        <FormItem\r\n          name=\"name\"\r\n          rules={[{ required: true, message: 'Please input your name!' }]}\r\n        >\r\n          <Input\r\n            prefix={<UserOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Name\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"nickname\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please input your Nickname!',\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<SmileOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Nickname\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"email\"\r\n          rules={[\r\n            {\r\n              type: 'email',\r\n              message: 'The input is not valid E-mail!',\r\n            },\r\n            {\r\n              required: true,\r\n              message: 'Please input your email!',\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<MailOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            placeholder=\"Email\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"password\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please input your Password!',\r\n            },\r\n            {\r\n              validator: this.validateToNextPassword,\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<LockOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            type=\"password\"\r\n            placeholder=\"Password\"\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          name=\"confirm\"\r\n          rules={[\r\n            {\r\n              required: true,\r\n              message: 'Please confirm your password!',\r\n            },\r\n            {\r\n              validator: this.compareToFirstPassword,\r\n            },\r\n          ]}\r\n        >\r\n          <Input\r\n            prefix={<LockOutlined style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n            type=\"password\"\r\n            placeholder=\"Confirm password\"\r\n            onBlur={this.handleConfirmBlur}\r\n            size=\"large\"\r\n          />\r\n        </FormItem>\r\n        <FormItem>\r\n          <Button\r\n            type=\"primary\"\r\n            htmlType=\"submit\"\r\n            size=\"large\"\r\n            className=\"login-form-button\"\r\n            loading={isLoading}\r\n          >\r\n            Sign Up\r\n          </Button>\r\n        </FormItem>\r\n      </Form>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(SignUp);\r\n","import React from 'react';\nimport { withRouter, RouteComponentProps } from 'react-router-dom';\nimport { Spin } from 'antd';\nimport { fire } from '../firebase';\nimport * as routes from '../constants/routes';\nimport AuthUserContext, { UserContext } from './AuthUserContext';\n\ninterface IWithAuthorizationProps extends RouteComponentProps {}\n\nconst withAuthorization = <TProps,>(\n  authCondition: (authUser: UserContext) => boolean\n) => (Component: React.ComponentType<TProps>) => {\n  class WithAuthorization extends React.Component<\n    IWithAuthorizationProps & TProps\n  > {\n    public componentDidMount() {\n      fire.auth().onAuthStateChanged((authUser: UserContext) => {\n        if (!authCondition(authUser)) {\n          this.props.history.push(routes.SIGN_IN);\n        }\n      });\n    }\n\n    public render() {\n      return (\n        <AuthUserContext.Consumer>\n          {authUser =>\n            authUser ? (\n              <Component {...this.props} />\n            ) : (\n              <div className=\"full-view loader\">\n                <Spin\n                  size=\"large\"\n                  style={{ width: '100%', position: 'relative', top: '50%' }}\n                />\n              </div>\n            )\n          }\n        </AuthUserContext.Consumer>\n      );\n    }\n  }\n\n  return withRouter(WithAuthorization);\n};\n\nexport default withAuthorization;\n","import React, { Component } from 'react';\r\nimport { Modal, Form, Input, Select, Spin } from 'antd';\r\nimport { fire } from '../firebase';\r\nimport { onceGetUsers, onceGetLeagues } from '../firebase/db';\r\nimport { IBasicDialogProps } from './Dialog';\r\nimport { FormInstance } from 'antd/lib/form/Form';\r\nimport { IRawPlayer, IPlayer } from '../models/IPlayerModel';\r\n\r\nconst FormItem = Form.Item;\r\nconst Option = Select.Option;\r\n\r\ninterface INewLeagueState {\r\n  showDialog: boolean;\r\n  loading: boolean;\r\n  savingLeagueLoader: boolean;\r\n  users: { [userKey: string]: IRawPlayer };\r\n  count: number;\r\n}\r\n\r\nexport interface INewLeagueProps extends IBasicDialogProps<number> {}\r\n\r\nclass NewLeague extends Component<INewLeagueProps, INewLeagueState> {\r\n  private leagueID: number | undefined;\r\n  private formRef = React.createRef<FormInstance>();\r\n\r\n  constructor(props: INewLeagueProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showDialog: this.props.visible,\r\n      users: {},\r\n      count: 0,\r\n      loading: true,\r\n      // addPlayerCollapse: [],\r\n      savingLeagueLoader: false,\r\n    };\r\n  }\r\n\r\n  fetchPlayers() {\r\n    onceGetUsers().then((snapshot) => {\r\n      if (snapshot.val()) {\r\n        this.setState({ users: snapshot.val(), loading: false });\r\n      } else {\r\n        this.setState({ loading: false });\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetchPlayers();\r\n  }\r\n\r\n  render() {\r\n    const { showDialog, users, loading, savingLeagueLoader } = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        title=\"Create League\"\r\n        visible={showDialog}\r\n        destroyOnClose={true}\r\n        maskClosable={false}\r\n        confirmLoading={savingLeagueLoader}\r\n        onOk={this.onCreateLeague}\r\n        onCancel={this.closeModal}\r\n        afterClose={this.afterClose}\r\n        // width=\"600px\"\r\n        okText=\"Save & Play\"\r\n        getContainer=\".app\"\r\n      >\r\n        <Form ref={this.formRef} layout=\"vertical\">\r\n          <FormItem\r\n            label=\"Title\"\r\n            name=\"title\"\r\n            rules={[\r\n              { required: true, message: 'Please input the league title!' },\r\n            ]}\r\n          >\r\n            <Input />\r\n          </FormItem>\r\n          <FormItem label=\"Description\" name=\"description\">\r\n            <Input type=\"textarea\" />\r\n          </FormItem>\r\n          {\r\n            <FormItem\r\n              label=\"Players\"\r\n              name=\"players\"\r\n              rules={[{ required: true, len: 4, type: 'array' }]}\r\n            >\r\n              <Select\r\n                mode=\"multiple\"\r\n                notFoundContent={loading ? <Spin size=\"small\" /> : null}\r\n              >\r\n                {Object.keys(users).map((key) => (\r\n                  <Option key={key} value={key}>\r\n                    {users[key].nickname}\r\n                  </Option>\r\n                ))}\r\n              </Select>\r\n            </FormItem>\r\n          }\r\n        </Form>\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  private onCreateLeague = () => {\r\n    const form = this.formRef.current;\r\n    const { users } = this.state;\r\n\r\n    form &&\r\n      form\r\n        .validateFields(['title', 'description', 'players'])\r\n        .then((values) => {\r\n          const { description } = values;\r\n          this.setState({ savingLeagueLoader: true });\r\n\r\n          const players: IPlayer[] = values.players.map((key: string) => ({\r\n            key,\r\n            nickname: users[key].nickname,\r\n          }));\r\n\r\n          onceGetLeagues().then((snapshot) => {\r\n            const lastID = snapshot.val() && snapshot.val().lastID;\r\n            const newID = lastID ? lastID + 1 : 1;\r\n\r\n            fire\r\n              .database()\r\n              .ref('leagues/list/_' + newID)\r\n              .set({\r\n                ...values,\r\n                players,\r\n                description: description || '',\r\n                leagueID: newID,\r\n                active: true,\r\n              })\r\n              .then(() => this.setNewLeagueID(newID));\r\n            fire.database().ref('leagues/lastID').set(newID);\r\n          });\r\n        });\r\n  };\r\n\r\n  private setNewLeagueID = (leagueID: number) => {\r\n    this.leagueID = leagueID;\r\n\r\n    this.closeModal();\r\n  };\r\n  // in order to preserve the animation when closing\r\n  // there is also an inner state although visible state initialy is from props\r\n  private closeModal = () => {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n  };\r\n\r\n  private afterClose = () => {\r\n    const { onAfterClose } = this.props;\r\n\r\n    if (typeof onAfterClose === 'function') {\r\n      onAfterClose(this.leagueID);\r\n    }\r\n  };\r\n}\r\n\r\nexport default NewLeague;\r\n","import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport { Modal, List } from 'antd';\nimport './ResumeLeague.scss';\n\nclass ResumeLeague extends Component {\n  state = {\n    showDialog: this.props.visible,\n  };\n\n  closeModal(leagueID) {\n    // if leagueID - first close the modal then afterClose will pass the leagueID to rout to the right location\n    this.leagueID = leagueID;\n\n    this.setState({\n      showDialog: false,\n    });\n  }\n\n  render() {\n    const { afterClose, activeLeagues } = this.props;\n    const { showDialog } = this.state;\n\n    return (\n      <Modal\n        title=\"Resume League\"\n        visible={showDialog}\n        destroyOnClose={true}\n        maskClosable={false}\n        width=\"600px\"\n        footer={null}\n        onCancel={() => this.closeModal()}\n        afterClose={() => afterClose(this.leagueID)}\n      >\n        <p>List of open leagues</p>\n        <List\n          itemLayout=\"horizontal\"\n          dataSource={activeLeagues}\n          renderItem={item => (\n            <List.Item>\n              <List.Item.Meta\n                title={\n                  <a onClick={() => this.closeModal(item.leagueID)}>\n                    {item.title}\n                  </a>\n                }\n              />\n            </List.Item>\n          )}\n        />\n      </Modal>\n    );\n  }\n}\n\nexport default withRouter(ResumeLeague);\n","export const hasTouch = (): boolean =>\n  !!window.navigator.maxTouchPoints ||\n  'ontouchstart' in document.documentElement;\n\nexport function addListener(\n  element: HTMLElement,\n  type: string,\n  callback: (e: Event) => void\n) {\n  element.addEventListener(type, callback);\n\n  return () => {\n    element.removeEventListener(type, callback);\n  };\n}\n\nexport function isMobileBrowser(): boolean {\n  return (\n    typeof window.orientation !== 'undefined' ||\n    navigator.userAgent.indexOf('IEMobile') !== -1\n  );\n}\n\nexport const unique = <T>(array: T[]) => Array.from(new Set(array));\n\nexport const shuffle = (array: any[]) => {\n  const arrayCopy = [...array];\n\n  for (let i = arrayCopy.length - 1; i > 0; i--) {\n    let j = Math.floor(Math.random() * (i + 1));\n    [arrayCopy[i], arrayCopy[j]] = [arrayCopy[j], arrayCopy[i]];\n  }\n\n  return arrayCopy;\n};\n","import React from \"react\";\nimport { Motion, spring } from \"react-motion\";\nimport { addListener } from \"../../utils/Utils\";\nimport { UserOutlined } from \"@ant-design/icons\";\nimport \"./DragPad.scss\";\n\nconst springSetting1 = { stiffness: 180, damping: 10 };\nconst springSetting2 = { stiffness: 120, damping: 17 };\n\nexport function reorder(arr, from, to) {\n  const _arr = [...arr];\n\n  if (Math.abs(from - to) === arr.length - 1) {\n    [_arr[to], _arr[from]] = [_arr[from], _arr[to]];\n  } else if (from < to && to - from > 1) {\n    const val = _arr[from];\n    _arr.splice(from, 1);\n    _arr.unshift(_arr.pop());\n    _arr.splice(to, 0, val);\n  } else {\n    const val = _arr[from];\n    _arr.splice(from, 1);\n    _arr.splice(to, 0, val);\n  }\n\n  return _arr;\n}\n\nfunction clamp(n, min, max) {\n  return Math.max(Math.min(n, max), min);\n}\n\nconst allColors = [\"#EF767A\", \"#9acaff\", \"#49BEAA\", \"#49DCB1\"];\nconst [count, width, height] = [4, 80, 80];\n\n// indexed by visual position\n// const layout = [0, 1, 2, 3].map(n => {\n//   const row = Math.floor(n / 3);\n//   const col = n % 3;\n//   return [width * col, height * row];\n// });\n\nconst layout = [\n  [width * 1, height * 0],\n  [width * 2, height * 1],\n  [width * 1, height * 2],\n  [width * 0, height * 1]\n];\n\nexport default class DragPad extends React.Component {\n  unListenTouchmove;\n  unListenTouchend;\n  unListenMousemove;\n  unListenMouseup;\n  colors;\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      mouseXY: [0, 0],\n      mouseCircleDelta: [0, 0], // difference between mouse and circle pos for x + y coords, for dragging\n      lastPress: null, // key of the last pressed component\n      isPressed: false,\n      order: props.players,\n      from: null,\n      to: null\n    };\n\n    this.colors = props.players.reduce((colorObj, player, i) => {\n      colorObj[player.key] = allColors[i];\n\n      return colorObj;\n    }, {});\n  }\n\n  componentDidMount() {\n    this.unListenTouchmove = addListener(\n      window,\n      \"touchmove\",\n      this.handleTouchMove\n    );\n    this.unListenTouchend = addListener(window, \"touchend\", this.handleMouseUp);\n    this.unListenMousemove = addListener(\n      window,\n      \"mousemove\",\n      this.handleMouseMove\n    );\n    this.unListenMouseup = addListener(window, \"mouseup\", this.handleMouseUp);\n  }\n\n  componentWillUnmount() {\n    this.unListenTouchmove();\n    this.unListenTouchend();\n    this.unListenMousemove();\n    this.unListenMouseup();\n  }\n\n  handleTouchStart = (key, pressLocation, e) => {\n    this.handleMouseDown(key, pressLocation, e.touches[0]);\n  };\n\n  handleTouchMove = e => {\n    e.preventDefault();\n    this.handleMouseMove(e.touches[0]);\n  };\n\n  handleMouseMove = ({ pageX, pageY }) => {\n    const {\n      order,\n      lastPress,\n      isPressed,\n      mouseCircleDelta: [dx, dy]\n    } = this.state;\n\n    if (isPressed) {\n      const mouseXY = [pageX - dx, pageY - dy];\n\n      const col = clamp(Math.round(mouseXY[0] / width), 0, 2);\n      const row = clamp(\n        Math.round(mouseXY[1] / height),\n        0,\n        Math.floor(count / 2)\n      );\n\n      // if col === 1 && row === 0 => index = 0;\n      // if col === 2 && row === 1 => index = 1;\n      // if col === 1 && row === 2 => index = 2;\n      // if col === 0 && row === 1 => index = 3;\n\n      let to = null;\n\n      if (col === 1 && row === 0) {\n        to = 0;\n      } else if (col === 2 && row === 1) {\n        to = 1;\n      } else if (col === 1 && row === 2) {\n        to = 2;\n      } else if (col === 0 && row === 1) {\n        to = 3;\n      }\n\n      const from = order.findIndex(p => p.key === lastPress);\n\n      const newOrder =\n        typeof to === \"number\" && to !== from && reorder(order, from, to);\n\n      this.setState({\n        mouseXY,\n        order: newOrder ? newOrder : [...order],\n        from: newOrder ? from : this.state.from,\n        to: newOrder ? to : this.state.to\n      });\n    }\n  };\n\n  handleMouseDown = (key, [pressX, pressY], { pageX, pageY }) => {\n    this.setState({\n      lastPress: key,\n      isPressed: true,\n      mouseCircleDelta: [pageX - pressX, pageY - pressY],\n      mouseXY: [pressX, pressY]\n    });\n  };\n\n  handleMouseUp = () => {\n    this.setState({ isPressed: false, mouseCircleDelta: [0, 0] });\n\n    if (typeof this.props.onChange === \"function\") {\n      const { order, from, to } = this.state;\n      this.props.onChange(order, from, to);\n    }\n  };\n\n  render() {\n    const { order, lastPress, isPressed, mouseXY } = this.state;\n\n    return (\n      <div className=\"drag-pad\">\n        <div className=\"drag-pad-content\">\n          {order.map((player, key) => {\n            let style;\n            let x;\n            let y;\n            const visualPosition = order.findIndex(p => p.key === player.key);\n            // const visualPosition = order.indexOf(player.index);\n            if (player.key === lastPress && isPressed) {\n              [x, y] = mouseXY;\n              style = {\n                translateX: x,\n                translateY: y,\n                scale: spring(1.2, springSetting1),\n                boxShadow: spring(\n                  (x - (3 * width - 50) / 2) / 15,\n                  springSetting1\n                )\n              };\n            } else {\n              [x, y] = layout[visualPosition];\n              style = {\n                translateX: spring(x, springSetting2),\n                translateY: spring(y, springSetting2),\n                scale: spring(1, springSetting1),\n                boxShadow: spring(\n                  (x - (3 * width - 50) / 2) / 15,\n                  springSetting1\n                )\n              };\n            }\n            return (\n              <Motion key={player.key} style={style}>\n                {({ translateX, translateY, scale, boxShadow }) => (\n                  <div\n                    onMouseDown={this.handleMouseDown.bind(null, player.key, [\n                      x,\n                      y\n                    ])}\n                    onTouchStart={this.handleTouchStart.bind(null, player.key, [\n                      x,\n                      y\n                    ])}\n                    className=\"player-icon\"\n                    style={{\n                      backgroundColor: this.colors[player.key],\n                      WebkitTransform: `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`,\n                      transform: `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`,\n                      zIndex: player.key === lastPress ? 99 : visualPosition,\n                      boxShadow: `${boxShadow}px 5px 5px rgba(0,0,0,0.5)`\n                    }}\n                  >\n                    <UserOutlined />\n                    <span>{player.nickname}</span>\n                  </div>\n                )}\n              </Motion>\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import NewLeagueDialog from '../dialogs/NewLeague';\nimport ResumeLeagueDialog from '../dialogs/ResumeLeague';\nimport ReorderPlayers from '../dialogs/ReorderPlayers';\nimport NewGameDialog from '../dialogs/NewGameDialog/NewGameDialog';\nimport GameInvite from '../dialogs/GameInvite';\n\nexport enum Dialogs {\n  NEW_LEAGUE = 'NEW_LEAGUE',\n  RESUME_LEAGUE = 'RESUME_LEAGUE',\n  REORDER_PLAYERS = 'REORDER_PLAYERS',\n  NEW_GAME = 'NEW_GAME',\n  GAME_INVITE = 'GAME_INVITE',\n}\n\nexport const DialogsMapping = {\n  [Dialogs.NEW_LEAGUE]: NewLeagueDialog,\n  [Dialogs.RESUME_LEAGUE]: ResumeLeagueDialog,\n  [Dialogs.REORDER_PLAYERS]: ReorderPlayers,\n  [Dialogs.NEW_GAME]: NewGameDialog,\n  [Dialogs.GAME_INVITE]: GameInvite,\n};\n","import React, { Component } from 'react';\r\nimport { Modal } from 'antd';\r\nimport DragPad from '../common/dragPad/DragPad';\r\nimport { IBasicDialogProps } from './Dialog';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\ninterface IReorderPlayersState {\r\n  showDialog: boolean;\r\n  order: IPlayer[];\r\n}\r\n\r\nexport interface IReorderPlayersProps extends IBasicDialogProps<any> {\r\n  players: IPlayer[];\r\n  onOk: (order: IPlayer[]) => void;\r\n}\r\n\r\nexport default class ReorderPlayers extends Component<\r\n  IReorderPlayersProps,\r\n  IReorderPlayersState\r\n> {\r\n  constructor(props: IReorderPlayersProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      showDialog: props.visible,\r\n      order: props.players,\r\n    };\r\n\r\n    this.handleOnCancel = this.handleOnCancel.bind(this);\r\n    this.handleOnOk = this.handleOnOk.bind(this);\r\n    this.afterClose = this.afterClose.bind(this);\r\n    this.handleDragChange = this.handleDragChange.bind(this);\r\n  }\r\n\r\n  public render() {\r\n    const { players } = this.props;\r\n    const { showDialog } = this.state;\r\n\r\n    return (\r\n      <Modal\r\n        title=\"Reorder Players\"\r\n        visible={showDialog}\r\n        destroyOnClose={true}\r\n        maskClosable={false}\r\n        width=\"600px\"\r\n        onOk={this.handleOnOk}\r\n        onCancel={this.handleOnCancel}\r\n        afterClose={this.afterClose}\r\n      >\r\n        <DragPad players={players} onChange={this.handleDragChange} />\r\n      </Modal>\r\n    );\r\n  }\r\n\r\n  private handleOnCancel() {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n  }\r\n\r\n  private handleOnOk() {\r\n    this.setState({\r\n      showDialog: false,\r\n    });\r\n\r\n    const { onOk } = this.props;\r\n    if (typeof onOk === 'function') {\r\n      const { order } = this.state;\r\n      onOk(order);\r\n    }\r\n  }\r\n\r\n  private afterClose() {\r\n    const { onAfterClose } = this.props;\r\n\r\n    if (typeof onAfterClose === 'function') {\r\n      onAfterClose();\r\n    }\r\n  }\r\n\r\n  private handleDragChange(order: IPlayer[]) {\r\n    this.setState({\r\n      order,\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\nimport { Modal } from 'antd';\nimport './NewGameDialog.scss';\nimport { GameMode } from '../../models/IGameModel';\nimport { IBasicDialogProps } from '../Dialog';\n\ninterface INewGameDialogState {\n  showDialog: boolean;\n  modeSelected?: GameMode;\n}\n\nexport interface INewGameDialogProps extends IBasicDialogProps<GameMode> {}\n\nexport default class NewGameDialog extends React.Component<\n  INewGameDialogProps,\n  INewGameDialogState\n> {\n  public constructor(props: INewGameDialogProps) {\n    super(props);\n\n    this.state = {\n      showDialog: props.visible,\n    };\n  }\n\n  public render() {\n    const { showDialog } = this.state;\n\n    return (\n      <Modal\n        wrapClassName=\"remote-local-dialog\"\n        visible={showDialog}\n        destroyOnClose={true}\n        closable={false}\n        maskClosable={false}\n        centered={true}\n        width=\"300px\"\n        okText={'Frontal'}\n        cancelText={'OnLine'}\n        onOk={this.setGameMode('local')}\n        onCancel={this.setGameMode('remote')}\n        afterClose={this.handleAfterClose}\n        bodyStyle={{ display: 'none' }}\n      />\n    );\n  }\n\n  private setGameMode = (mode: GameMode) => () => {\n    this.setState({\n      showDialog: false,\n      modeSelected: mode,\n    });\n  };\n\n  private handleAfterClose = () => {\n    const { onAfterClose } = this.props;\n\n    if (typeof onAfterClose === 'function' && this.state.modeSelected) {\n      onAfterClose(this.state.modeSelected);\n    }\n  };\n}\n","import React from 'react';\nimport { Modal } from 'antd';\nimport { IGameInvite } from '../services/LeagueSrv';\nimport { IBasicDialogProps } from './Dialog';\n\ninterface IGameInviteState {\n  showDialog: boolean;\n}\n\nexport interface IGameInviteProps extends IBasicDialogProps<any> {\n  invite: IGameInvite;\n  onOk: () => void;\n}\n\nexport default class GameInvite extends React.Component<\n  IGameInviteProps,\n  IGameInviteState\n> {\n  public constructor(props: IGameInviteProps) {\n    super(props);\n\n    this.state = {\n      showDialog: props.visible,\n    };\n  }\n\n  public render() {\n    const { showDialog } = this.state;\n    const { leagueTitle, newGameId, inviter } = this.props.invite;\n\n    return (\n      <Modal\n        title=\"Game Invite\"\n        visible={showDialog}\n        destroyOnClose={true}\n        closable={true}\n        maskClosable={false}\n        centered={true}\n        width=\"300px\"\n        okText={'Join'}\n        cancelText={'Cancel'}\n        onOk={this.handleOk}\n        onCancel={this.handleCancel}\n        afterClose={this.handleAfterClose}\n      >\n        <div>\n          {`${inviter.nickname} from ${leagueTitle} invites you to join game ${newGameId}`}\n        </div>\n      </Modal>\n    );\n  }\n\n  private handleOk = () => {\n    this.setState({\n      showDialog: false,\n    });\n\n    const { onOk } = this.props;\n    if (typeof onOk === 'function') {\n      onOk();\n    }\n  };\n\n  private handleCancel = () => {\n    this.setState({\n      showDialog: false,\n    });\n  };\n\n  private handleAfterClose = () => {\n    const { onAfterClose } = this.props;\n\n    if (typeof onAfterClose === 'function') {\n      onAfterClose();\n    }\n  };\n}\n","export enum CARDS {\r\n  SPADE = 'SPADE',\r\n  HART = 'HART',\r\n  DIAMOND = 'DIAMOND',\r\n  CLUB = 'CLUB',\r\n  NT = 'NT',\r\n}\r\n\r\n\r\nexport enum CARDS_SHORT {\r\n  C = 'C',\r\n  D = 'D',\r\n  H = 'H',\r\n  S = 'S',\r\n}\r\n\r\nexport const CardsType = {\r\n  [CARDS.CLUB]: CARDS_SHORT.C,\r\n  [CARDS.DIAMOND]: CARDS_SHORT.D,\r\n  [CARDS.HART]: CARDS_SHORT.H,\r\n  [CARDS.SPADE]: CARDS_SHORT.S,\r\n  [CARDS.NT]: 'NT',\r\n};\r\n\r\nexport const DrawCardsType = {\r\n  [CARDS.CLUB]: CARDS_SHORT.C,\r\n  [CARDS.DIAMOND]: CARDS_SHORT.D,\r\n  [CARDS.HART]: CARDS_SHORT.H,\r\n  [CARDS.SPADE]: CARDS_SHORT.S\r\n};\r\n","import React from 'react';\nimport { DialogsMapping, Dialogs } from '../constants/dialogs';\nimport { INewGameDialogProps } from './NewGameDialog/NewGameDialog';\nimport { IGameInviteProps } from './GameInvite';\nimport { IReorderPlayersProps } from './ReorderPlayers';\nimport { INewLeagueProps } from './NewLeague';\n\nexport interface IBasicDialogProps<T> {\n  visible: boolean;\n  onAfterClose?: <T>(arg?: T) => void;\n}\n\n// TODO: remove the any once all the dialogs are ts and implement dinamic typing\nexport type DialogProps =\n  | INewGameDialogProps\n  | IGameInviteProps\n  | IReorderPlayersProps\n  | INewLeagueProps\n  | any;\n\nexport interface IDialogProps {\n  dialog: Dialogs;\n  dialogProps?: DialogProps;\n}\n\nconst Dialog: React.FC<IDialogProps> = (props) => {\n  const { dialog, dialogProps } = props;\n  const DialogEl = DialogsMapping[dialog];\n\n  return <DialogEl {...dialogProps} />;\n};\n\nexport default Dialog;\n","import React from 'react';\nimport { Button } from 'antd';\nimport Dialog, { DialogProps } from '../dialogs/Dialog';\nimport { Dialogs } from '../constants/dialogs';\n\nexport interface IMainMenuItem {\n  text: string;\n  onClick?: () => void;\n  dialog?: Dialogs;\n  disabled?: boolean;\n  dialogProps: DialogProps;\n}\n\nexport interface IMainMenuProps {\n  items: IMainMenuItem[];\n}\n\nconst MainMenu = (props: IMainMenuProps) => {\n  return (\n    <ul className=\"app-menu\">\n      {props.items.map((item, index) => {\n        const { onClick, text, dialog, dialogProps, disabled } = item;\n\n        // the Dialog should not be instanced unless it's visible\n        // in some Dialogs there are calls to the DB\n        return (\n          <li key={index}>\n            <Button onClick={onClick} size=\"large\" disabled={disabled} block>\n              {text}\n            </Button>\n            {dialog && dialogProps.visible ? (\n              <Dialog dialog={dialog} dialogProps={dialogProps} />\n            ) : (\n              ''\n            )}\n          </li>\n        );\n      })}\n    </ul>\n  );\n};\n\nexport default MainMenu;\n","import React, { Component } from 'react';\r\nimport { fire, auth } from '../firebase';\r\nimport withAuthorization from '../authentication/withAuthorization';\r\nimport MainMenu from './MainMenu';\r\nimport * as routes from './../constants/routes';\r\nimport { Dialogs } from './../constants/dialogs';\r\n\r\nclass Main extends Component {\r\n  // Dialogs visible states controling if the Dialog should be instansiated or not\r\n  // this outer state is for saving unnecessary access to the DB\r\n  state = {\r\n    activeLeagues: [],\r\n    newLeague: false,\r\n    resumeLeague: false,\r\n  };\r\n\r\n  /* Create reference to activeLeagues in Firebase Database */\r\n  activeLeagues = fire\r\n    .database()\r\n    .ref('leagues/list')\r\n    .orderByChild('active')\r\n    .equalTo(true);\r\n\r\n  fetch() {\r\n    this.activeLeagues.on('value', (snapshot) => {\r\n      if (snapshot.val()) {\r\n        const userId = fire.auth().currentUser.uid;\r\n\r\n        // filtering leagues data by userId,\r\n        // TODO: check if possible to fix the data differently in the database for better queries\r\n        // TODO: fix the loader functionality\r\n        this.setState({\r\n          activeLeagues: Object.values(snapshot.val()).filter(({ players }) =>\r\n            Object.values(players).some(({ key }) => key === userId)\r\n          ),\r\n          loading: false,\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.activeLeagues.off('value');\r\n  }\r\n\r\n  showResumeLeagueDialog() {\r\n    this.setState({\r\n      resumeLeague: true,\r\n    });\r\n  }\r\n\r\n  closeResumeLeagueDialog(leagueID) {\r\n    this.setState({\r\n      resumeLeague: false,\r\n    });\r\n\r\n    this.navigateToLeague(leagueID);\r\n  }\r\n\r\n  showNewLeagueDialog() {\r\n    this.setState({\r\n      newLeague: true,\r\n    });\r\n  }\r\n\r\n  closeNewLeagueDialog(leagueID) {\r\n    this.setState({\r\n      newLeague: false,\r\n    });\r\n\r\n    this.navigateToLeague(leagueID);\r\n  }\r\n\r\n  navigateToLeague(leagueID) {\r\n    if (leagueID) {\r\n      this.props.history.push(`${routes.LEAGUE}/` + leagueID);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className=\"app-main\">\r\n        <MainMenu\r\n          items={[\r\n            {\r\n              text: 'Resume League',\r\n              onClick: this.showResumeLeagueDialog.bind(this),\r\n              dialog: Dialogs.RESUME_LEAGUE,\r\n              disabled: this.state.activeLeagues.length === 0,\r\n              dialogProps: {\r\n                afterClose: this.closeResumeLeagueDialog.bind(this),\r\n                visible: this.state.resumeLeague,\r\n                activeLeagues: this.state.activeLeagues,\r\n              },\r\n            },\r\n            {\r\n              text: 'Create League',\r\n              onClick: this.showNewLeagueDialog.bind(this),\r\n              dialog: Dialogs.NEW_LEAGUE,\r\n              dialogProps: {\r\n                onAfterClose: this.closeNewLeagueDialog.bind(this),\r\n                visible: this.state.newLeague,\r\n              },\r\n            },\r\n            { text: 'Settings' },\r\n            { text: 'Scores' },\r\n            {\r\n              text: 'Sign Out',\r\n              onClick: auth.signOut,\r\n            },\r\n          ]}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst authCondition = (authUser) => !!authUser;\r\n\r\nexport default withAuthorization(authCondition)(Main);\r\n","export enum INPUT_MODE {\r\n  BID = 'BID',\r\n  WON = 'WON',\r\n}\r\n","import { fire } from '../firebase';\r\nimport { CardsType, DrawCardsType, CARDS_SHORT, CARDS } from '../constants/cards';\r\nimport {\r\n  IPlayerHand,\r\n  ICardsFromTo,\r\n  ICardsPosition,\r\n  IRoundData,\r\n  IHandState,\r\n} from '../models/IGameModel';\r\nimport { ThrownCardType } from '../game/ThrownCard/ThrownCard';\r\nimport { shuffle } from './Utils';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport const getTotalWonBid = (roundData: IRoundData) => {\r\n  let currentTotalBid: number = 0;\r\n  let currentTotalWon: number = 0;\r\n  let allHasWonInput: boolean = true;\r\n\r\n  for (const [key, value] of Object.entries(roundData)) {\r\n    if (key.indexOf('bid') > -1 && value !== null && value !== '') {\r\n      currentTotalBid += value * 1;\r\n    }\r\n\r\n    if (key.indexOf('won') > -1) {\r\n      if (value !== null && value !== '') {\r\n        currentTotalWon += value * 1;\r\n      } else {\r\n        allHasWonInput = false;\r\n      }\r\n    }\r\n  }\r\n\r\n  return { currentTotalBid, currentTotalWon, allHasWonInput };\r\n};\r\n\r\nexport const getTotalRemoteWonBid = (roundData: IRoundData) => {\r\n  let currentTotalBid: number = 0;\r\n  let currentTotalWon: number = 0;\r\n\r\n  [0, 1, 2, 3].forEach((player) => {\r\n    currentTotalBid += +roundData[`bid${player}`];\r\n    currentTotalWon += +roundData[`won${player}`];\r\n  });\r\n\r\n  return { currentTotalBid, currentTotalWon };\r\n};\r\n\r\nexport const calcIfRoundFell = (roundData: IRoundData): boolean => {\r\n  let didRoundFell = true;\r\n\r\n  for (let i = 0; i < 4; i++) {\r\n    const bid = `bid${i}`;\r\n    const won = `won${i}`;\r\n\r\n    if (\r\n      typeof roundData[bid] !== 'number' ||\r\n      typeof roundData[won] !== 'number'\r\n    ) {\r\n      didRoundFell = false;\r\n      break;\r\n    } else if (roundData[bid] === roundData[won]) {\r\n      didRoundFell = false;\r\n      break;\r\n    }\r\n  }\r\n\r\n  return didRoundFell;\r\n};\r\n\r\nexport const cardsList: string[] = (function () {\r\n  const arr: string[] = [];\r\n  for (const type of Object.values(DrawCardsType)) {\r\n    for (let i = 2; i < 15; i++) {\r\n      arr.push(`${i}-${type}`);\r\n    }\r\n  }\r\n\r\n  return arr;\r\n})();\r\n\r\nconst cardsFamilyScoreMap = {\r\n  [CardsType.CLUB]: 1,\r\n  [CardsType.DIAMOND]: 0,\r\n  [CardsType.HART]: 2,\r\n  [CardsType.SPADE]: 3,\r\n};\r\n\r\nexport const getDevicePlayerIndex = (players: IPlayer[]): number => {\r\n  return players.findIndex(\r\n    (player) => player.key === fire.auth().currentUser?.uid\r\n  );\r\n};\r\n\r\nexport const nextPlayerIndex = (index: number) => {\r\n  return index + 1 > 3 ? index + 1 - 4 : index + 1;\r\n};\r\n\r\nexport const dealCards = (players: IPlayer[]) => {\r\n  const shuffledCards = shuffleCards(cardsList);\r\n  const arrayOf4: string[][] = [[], [], [], []];\r\n\r\n  for (let i = 0; i < 52; i += 4) {\r\n    for (let j = 0; j < arrayOf4.length; j++) {\r\n      arrayOf4[j].push(shuffledCards[i + j]);\r\n    }\r\n  }\r\n\r\n  sortCardsArrays(arrayOf4);\r\n\r\n  return setCardsByPlayer(players, arrayOf4);\r\n};\r\n\r\nexport const shuffleCards = (cardsArray: string[]) => shuffle(cardsArray);\r\n\r\nexport const shufflePlayers = (players: IPlayer[]) => shuffle(players);\r\n\r\nconst setCardsByPlayer = (players: IPlayer[], cardsArr: string[][]) =>\r\n  players.reduce((obj, player, index) => {\r\n    obj[player.key] = cardsArr[index];\r\n    return obj;\r\n  }, {} as { [key: string]: string[] });\r\n\r\nconst sortCardsArrays = (cardsArray: string[][]) => {\r\n  cardsArray.forEach((arr) => sortCards(arr));\r\n};\r\n\r\nconst sortCards = (cards: string[]) =>\r\n  cards.sort((cardX, cardY) => {\r\n    const [cardXNum, cardXType] = cardX.split('-');\r\n    const [cardYNum, cardYType] = cardY.split('-');\r\n\r\n    if (cardsFamilyScoreMap[cardXType] < cardsFamilyScoreMap[cardYType]) {\r\n      return 1;\r\n    }\r\n    if (cardsFamilyScoreMap[cardXType] > cardsFamilyScoreMap[cardYType]) {\r\n      return -1;\r\n    }\r\n\r\n    return +cardYNum - +cardXNum;\r\n  });\r\n\r\nexport const uniqueHand = (hand: IPlayerHand[]) => {\r\n  const uniqueResult = [];\r\n  const map = new Map();\r\n\r\n  for (const playerHand of hand) {\r\n    if (!map.has(playerHand.player)) {\r\n      map.set(playerHand.player, true);\r\n\r\n      uniqueResult.push(playerHand);\r\n    }\r\n  }\r\n\r\n  return uniqueResult;\r\n};\r\n\r\nconst CARD_WIDTH = 90;\r\nconst CARD_HEIGHT = 126;\r\nconst CARD_MARKER_HEIGHT = 188;\r\n\r\nexport const getFromToCalc = (\r\n  thrownType: ThrownCardType,\r\n  markerTop: number,\r\n  markerWidth: number,\r\n  ownThrownCardInitPos: ICardsPosition\r\n): ICardsFromTo => {\r\n  switch (thrownType) {\r\n    case 'right':\r\n      return {\r\n        from: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth + CARD_WIDTH,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth / 2,\r\n        },\r\n      };\r\n\r\n    case 'left':\r\n      return {\r\n        from: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: -CARD_WIDTH,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth / 2 - CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'top':\r\n      return {\r\n        from: {\r\n          top: CARD_HEIGHT / 2,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT * 0.8,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    case 'bottom':\r\n      let fromTop: number | undefined = undefined;\r\n      let fromLeft: number | undefined = undefined;\r\n\r\n      if (ownThrownCardInitPos) {\r\n        fromTop = ownThrownCardInitPos.top;\r\n        fromLeft = ownThrownCardInitPos.left;\r\n      }\r\n\r\n      return {\r\n        from:\r\n          typeof fromTop === 'number' && typeof fromLeft === 'number'\r\n            ? {\r\n              top: fromTop,\r\n              left: fromLeft,\r\n            }\r\n            : undefined,\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT * 0.2,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    default:\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop,\r\n          left: markerWidth / 2,\r\n        },\r\n      };\r\n  }\r\n};\r\n\r\nexport const getToWinnerCalc = (\r\n  direction: ThrownCardType,\r\n  markerTop: number,\r\n  markerWidth: number\r\n) => {\r\n  switch (direction) {\r\n    case 'right':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: markerWidth + CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'left':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT / 2 + markerTop - CARD_HEIGHT / 2,\r\n          left: -CARD_WIDTH,\r\n        },\r\n      };\r\n\r\n    case 'top':\r\n      return {\r\n        to: {\r\n          top: 0,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n\r\n    case 'bottom':\r\n      return {\r\n        to: {\r\n          top: CARD_MARKER_HEIGHT + CARD_HEIGHT * 3,\r\n          left: markerWidth / 2 - CARD_WIDTH / 2,\r\n        },\r\n      };\r\n  }\r\n};\r\n\r\nexport const calculateHandWinner = (roundData: IRoundData) => {\r\n  const { trump, handsState, currentHand } = roundData;\r\n  const currentHandState = handsState && handsState[currentHand as number];\r\n  const { thrownCards } = currentHandState as IHandState;\r\n\r\n  const trumpCards = thrownCards.filter(\r\n    (thrown) =>\r\n      (thrown.card.split('-')[1] as CARDS_SHORT) === CardsType[trump as CARDS]\r\n  );\r\n\r\n  if (trumpCards.length) {\r\n    const thrownSorted = trumpCards.sort(\r\n      (a, b) => +b.card.split('-')[0] - +a.card.split('-')[0]\r\n    );\r\n\r\n    return thrownSorted[0];\r\n  } else {\r\n    const handCardType = thrownCards[0].card.split('-')[1];\r\n    const thrownSorted = thrownCards\r\n      .filter((thrown) => thrown.card.split('-')[1] === handCardType)\r\n      .sort((a, b) => +b.card.split('-')[0] - +a.card.split('-')[0]);\r\n\r\n    return thrownSorted[0];\r\n  }\r\n};\r\n","import React from 'react';\n\nexport const Spade = () => (\n\t<svg  x=\"0px\" y=\"0px\" viewBox=\"0 0 511.96 511.96\" style={{enableBackground:'new 0 0 511.96 511.96'}} width=\"1em\" height=\"1em\">\n\t\t<g>\n\t\t\t<path d=\"M302.728,390.351c16.49,15.934,26.368,25.759,55.905,24.541c43.494-1.783,83.871-25.459,106.364-62.729\n\t\t\t\tc38.78-64.247,17.576-128.53-23.702-166.824L272.705,6.528c-9.507-8.704-24.082-8.704-33.589,0L68.073,185.34\n\t\t\t\tc-40.13,37.226-57.256,99.037-23.729,161.483c21.283,39.645,61.767,66.357,106.726,68.087c29.281,1.121,40.801-8.66,57.759-24.488\n\t\t\t\tc4.458-4.167,11.767-1.033,11.767,5.076l0.009,29.987c0,16.172-4.228,32.071-12.253,46.115l-15.519,27.154\n\t\t\t\tc-3.354,5.888,0.892,13.206,7.671,13.206h110.813c6.78,0,11.034-7.318,7.671-13.206l-15.519-27.154\n\t\t\t\tc-8.024-14.045-12.244-29.943-12.244-46.115v-30.296C291.226,389.213,298.429,386.202,302.728,390.351\"/>\n\t\t\t<path style={{fill:'#2A2D33'}}  d=\"M427.21,329.362c-8.701,14.419-21.869,26.091-37.482,33.362c-10.397,4.841-21.597,7.606-32.91,8.072\n\t\t\t\tc-4.871,0.201-8.657,4.312-8.457,9.184c0.201,4.871,4.312,8.657,9.184,8.457c13.661-0.563,27.144-3.891,39.635-9.707\n\t\t\t\tc18.759-8.735,34.611-22.785,45.145-40.244c19.021-31.51,20.189-64.061,7.087-94.822c-1.911-4.485-7.096-6.573-11.581-4.662\n\t\t\t\tc-4.485,1.911-6.573,7.096-4.662,11.581C444.131,276.316,443.177,302.911,427.21,329.362z\"/>\n\t\t</g>\n\t</svg>\n);\n\nexport const Hart = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 510.977 510.977\" style={{enableBackground:'new 0 0 510.977 510.977'}} width=\"1em\" height=\"1em\">\n    <g>\n      <path style={{fill:'#D71E00'}} d=\"M255.22,105.177c19.535-49.77,61.325-87.79,113.231-87.79c43.705,0,79.625,23.111,108.871,54.44\n        c38.859,41.622,56.17,137.216-15.863,209.24c-36.546,36.546-205.815,212.524-205.815,212.524S86.384,317.613,49.838,281.066\n        c-72.033-72.024-55.578-167.618-15.863-209.24c29.581-31.002,65.165-54.44,108.871-54.44\n        C194.751,17.386,235.685,55.407,255.22,105.177\"/>\n      <path style={{fill:'#B21606'}} d=\"M429.848,94.824c26.006,21.865,39.538,63.103,31.858,97.341c-0.675,2.978-1.395,6.021-2.154,9.091\n        c-1.17,4.733,1.718,9.518,6.45,10.689c4.733,1.17,9.518-1.718,10.689-6.45c0.787-3.183,1.534-6.339,2.238-9.446\n        c9.114-40.635-6.622-88.592-37.718-114.736c-16.942-14.251-37.574-20.273-68.03-20.273c-4.875,0-8.828,3.952-8.828,8.828\n        s3.952,8.828,8.828,8.828C399.8,78.694,416.45,83.554,429.848,94.824z\"/>\n    </g>\n  </svg>\n);\n\nexport const Diamond = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{enableBackground: 'new 0 0 512 512'}} width=\"1em\" height=\"1em\">\n    <g>\n      <polygon style={{fill:'#D71E00'}} points=\"256,0 45.714,256 256,512 466.286,256 \t\"/>\n      <path style={{fill:'#B21606'}} d=\"M248.872,448.656c-3.162,3.937-2.533,9.692,1.404,12.853c3.937,3.162,9.692,2.533,12.853-1.404\n        l64-79.698c3.162-3.937,2.533-9.692-1.404-12.853c-3.937-3.162-9.692-2.533-12.853,1.404L248.872,448.656z\"/>\n    </g>\n  </svg>\n);\n\nexport const Club = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 511.998 511.998\" style={{enableBackground: 'new 0 0 511.998 511.998'}} width=\"1em\" height=\"1em\">\n    <g>\n      <path d=\"M419.381,199.229c-26.651-12.378-51.541-12.674-74.177-7.186c18.441-21.827,29.058-50.472,27.396-81.642\n        C369.438,51,320.017,2.36,260.58,0.087c-66.578-2.542-121.353,50.67-121.353,116.682c0,28.699,10.393,54.937,27.567,75.273\n        c-22.636-5.488-47.526-5.192-74.177,7.186c-41.023,19.061-69.569,59.401-70.153,104.628\n        c-0.835,65.204,51.757,118.317,116.763,118.317c31.412,0,59.859-12.459,80.842-32.633v34.403c0,16.501-4.303,32.714-12.495,47.041\n        l-15.755,27.576c-3.422,5.991,0.907,13.438,7.797,13.438h112.766c6.899,0,11.219-7.446,7.797-13.438l-15.755-27.576\n        c-8.183-14.327-12.495-30.54-12.495-47.041V389.54c20.992,20.175,49.439,32.633,80.842,32.633\n        c65.006,0,117.607-53.113,116.763-118.317C488.95,258.629,460.403,218.289,419.381,199.229\"/>\n      <path style={{fill:'#2A2D33'}} d=\"M423.915,355.877c-13.621,13.805-31.752,21.385-51.142,21.385c-4.961,0-8.982,4.022-8.982,8.982\n        c0,4.961,4.022,8.982,8.982,8.982c24.196,0,46.934-9.506,63.927-26.729c16.991-17.2,26.197-40.066,25.888-64.288\n        c-0.063-4.96-4.136-8.93-9.096-8.867c-4.96,0.063-8.93,4.136-8.867,9.096C444.872,323.859,437.529,342.095,423.915,355.877z\"/>\n    </g>\n  </svg>  \n);\n\nexport const ChangePlayers = () => (\n  <svg x=\"0px\" y=\"0px\" viewBox=\"0 0 512 512\" style={{enableBackground: 'new 0 0 512 512'}} width=\"1em\" height=\"1em\">\n    <g>\n      <g>\n        <path d=\"M170.256,403.875c10.65-12.234,17.122-28.196,17.122-45.652c0-38.393-31.234-69.627-69.627-69.627\n          c-14.451,0-27.886,4.428-39.024,11.994c-1.632-10.049-2.463-20.254-2.463-30.537c0-49.249,18.842-95.868,53.054-131.273\n          c25.408-26.294,57.27-44.329,92.103-52.568l-23.142,27.868l23.133,19.21l59.366-71.49L201.539,17.43l-14.69,26.236l24.912,13.95\n          c-39.327,9.833-75.273,30.476-104.065,60.27c-39.659,41.041-61.5,95.081-61.5,152.168c0,20.2,2.752,40.155,8.17,59.414\n          c-3.996,8.772-6.241,18.504-6.241,28.756c0,17.491,6.497,33.483,17.185,45.726c-37.719,14.016-64.668,50.375-64.668,92.914v15.034\n          h234.473v-15.034C235.117,454.25,208.078,417.838,170.256,403.875z M117.752,318.665c21.813,0,39.558,17.746,39.558,39.558\n          s-17.746,39.558-39.559,39.558c-21.812,0-39.557-17.746-39.557-39.558S95.94,318.665,117.752,318.665z M32.362,481.828\n          c6.879-30.85,34.471-53.977,67.363-53.977h36.311c32.892,0,60.484,23.128,67.363,53.977H32.362z\"/>\n      </g>\n    </g>\n    <g>\n      <g>\n        <path d=\"M511.357,208.266c0-42.611-27.04-79.025-64.86-92.988c10.65-12.233,17.122-28.196,17.122-45.652\n          C463.619,31.234,432.385,0,393.992,0c-38.393,0-69.627,31.234-69.627,69.626c0,17.491,6.497,33.483,17.186,45.726\n          c-37.719,14.016-64.667,50.375-64.667,92.915v15.034h171.669c3.701,14.892,5.576,30.234,5.576,45.751\n          c0,45.405-16.341,89.291-46.014,123.576c-21.289,24.598-48.406,43.143-78.51,54.073l19.818-31.008l-25.335-16.193l-50.044,78.3\n          L358.173,512l11.325-27.855l-25.967-10.556c33.429-12.822,63.523-33.788,87.321-61.284\n          c34.401-39.748,53.347-90.623,53.347-143.254c0-15.46-1.611-30.777-4.793-45.751h31.952V208.266z M393.992,30.069\n          c21.813,0,39.558,17.746,39.558,39.557c0,21.813-17.746,39.558-39.558,39.558s-39.558-17.746-39.558-39.558\n          C354.434,47.814,372.179,30.069,393.992,30.069z M308.603,193.232c6.879-30.851,34.471-53.978,67.363-53.978h36.311\n          c32.892,0,60.484,23.128,67.363,53.978H308.603z\"/>\n      </g>\n    </g>\n    <g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g><g></g>\n  </svg>\n);\n","import React from 'react';\nimport { Row, Col } from 'antd';\nimport { TrophyTwoTone } from '@ant-design/icons';\nimport { cardsRenderer } from './renderers';\n\nconst MobileTable = (props) => {\n  const {\n    dataSource: rounds,\n    players,\n    currentRound,\n    leagueScores,\n    gameID,\n  } = props;\n\n  // const onDragEnd = (fromIndex, toIndex) => {\n  //   console.log(\"onDragEnd\");\n  // };\n\n  return (\n    <div className=\"game-table\">\n      <h3 className=\"game-header\">Game {gameID}</h3>\n      <Row gutter={1} className=\"table-header\" style={{ marginBottom: 1 }}>\n        <Col span={4}>\n          <div className=\"table-cell\">round</div>\n        </Col>\n        {getTableHeaders(players)}\n      </Row>\n\n      {rounds.map((round, i) => (\n        <Row\n          gutter={1}\n          className={`table-row ${\n            currentRound - 1 === i ? 'current-round' : ''\n          } ${round.fell ? 'round-fell' : ''}`}\n          key={i}\n        >\n          <Col span={4}>\n            <div className=\"table-cell\">\n              {i + 1}{' '}\n              {round.factor > 1 && (\n                <span className=\"round-factor\">{`x${round.factor}`}</span>\n              )}\n            </div>\n          </Col>\n          {getRoundCol(players, round)}\n        </Row>\n      ))}\n\n      <Row gutter={1} className={`table-row`}>\n        <Col span={4}>\n          <div className=\"table-cell\">\n            <TrophyTwoTone twoToneColor=\"#52c41a\" />\n          </div>\n        </Col>\n        {getLeagueScoresCol(players, leagueScores)}\n      </Row>\n    </div>\n  );\n};\n\nexport default MobileTable;\n\n///////////////////////////\n//\n// helpers\n//\n///////////////////////////\n\nexport const getTableHeaders = (players) =>\n  players.map(({ index: playerIndex, playerName }) => (\n    <Col key={playerIndex} span={5}>\n      <div className=\"table-cell\">{playerName}</div>\n    </Col>\n  ));\n\nconst getRoundCol = (players, roundData) =>\n  players.map(({ index: playerIndex }) => (\n    <Col span={5} key={playerIndex}>\n      <div\n        className={`table-cell score-cell ${\n          roundData[`bid${playerIndex}`] !== roundData[`won${playerIndex}`]\n            ? 'fell'\n            : ''\n        } ${playerIndex === roundData.highestBidder ? 'highest-bidder' : ''}`}\n      >\n        {roundData[`aggregateScore${playerIndex}`]}\n        {playerIndex === roundData.highestBidder && (\n          <span className=\"trump\">{cardsRenderer(roundData.trump)}</span>\n        )}\n      </div>\n    </Col>\n  ));\n\nconst getLeagueScoresCol = (players, leagueScores) =>\n  players.map(({ index: playerIndex }) => (\n    <Col span={5} key={playerIndex}>\n      <div className={`table-cell`}>\n        {leagueScores[`leagueScore${playerIndex}`] !== ''\n          ? leagueScores[`leagueScore${playerIndex}`]\n          : '-'}\n      </div>\n    </Col>\n  ));\n","import React from 'react';\nimport Icon from '@ant-design/icons';\nimport { Spade, Hart, Diamond, Club } from '../cards/Icons';\nimport { CARDS } from '../../constants/cards';\n\nexport const cardsRenderer = (text) => {\n  switch (text) {\n    case CARDS.SPADE:\n      return <Icon component={Spade} />;\n    case CARDS.HART:\n      return <Icon component={Hart} />;\n    case CARDS.DIAMOND:\n      return <Icon component={Diamond} />;\n    case CARDS.CLUB:\n      return <Icon component={Club} />;\n    case CARDS.NT:\n      return 'NT';\n  }\n};\n","import React, { Component } from 'react';\nimport { Button, Modal } from 'antd';\nimport Icon, { QuestionOutlined } from '@ant-design/icons';\nimport { Spade, Hart, Diamond, Club } from './Icons';\nimport './Modal.scss';\n\nclass CardsModal extends Component {\n  state = { visible: false };\n\n  componentDidUpdate(prevProp) {\n    if (\n      prevProp.visible !== this.props.visible &&\n      this.props.visible !== this.state.visible\n    ) {\n      this.setState({\n        visible: this.props.visible,\n      });\n    }\n  }\n\n  showModal = () => {\n    this.setState({\n      visible: true,\n    });\n  };\n\n  handleCancel = () => {\n    this.setState({\n      visible: false,\n    });\n  };\n\n  onTrumpSelect(value) {\n    this.props.onChange(value);\n    this.setState({\n      visible: false,\n    });\n  }\n\n  trumpIconMap = {\n    SPADE: Spade,\n    HART: Hart,\n    DIAMOND: Diamond,\n    CLUB: Club,\n    NT: 'NT',\n  };\n\n  render() {\n    const { trump, disabled } = this.props;\n\n    return (\n      <div className=\"cards-modal\">\n        trump\n        <Button\n          ghost\n          className=\"card-btn\"\n          onClick={this.showModal}\n          disabled={disabled}\n        >\n          {trump ? (\n            trump === 'NT' ? (\n              'NT'\n            ) : (\n              <Icon component={this.trumpIconMap[trump]} />\n            )\n          ) : (\n            <QuestionOutlined />\n          )}\n        </Button>\n        <Modal\n          footer={null}\n          visible={this.state.visible}\n          onCancel={this.handleCancel}\n          className=\"cards-modal-dialog\"\n        >\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'SPADE')}\n          >\n            <Icon component={Spade} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'HART')}\n          >\n            <Icon component={Hart} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'DIAMOND')}\n          >\n            <Icon component={Diamond} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'CLUB')}\n          >\n            <Icon component={Club} />\n          </Button>\n          <Button\n            className=\"card-btn\"\n            onClick={this.onTrumpSelect.bind(this, 'NT')}\n          >\n            NT\n          </Button>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nexport default CardsModal;\n","import React, { Component } from 'react';\nimport { Button } from 'antd';\nimport './Pad.scss';\n\nexport default class NumbersPad extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      showMore: false,\n    };\n\n    this.toggleMore = this.toggleMore.bind(this);\n    this.onBtnClick = this.onBtnClick.bind(this);\n  }\n\n  toggleMore() {\n    this.setState({\n      showMore: !this.state.showMore,\n    });\n  }\n\n  onBtnClick(e) {\n    this.props.onSelect(e.target.textContent * 1);\n  }\n\n  render() {\n    const { disabled } = this.props;\n    const btnSize = 'default';\n    const { showMore } = this.state;\n\n    return (\n      <div>\n        <div className=\"dial-pad\">\n          {!showMore ? this.getButtons(0, 10) : this.getButtons(10, 4)}\n          <Button\n            size={btnSize}\n            onClick={this.toggleMore}\n            className=\"more-less-btn\"\n            disabled={disabled}\n          >\n            {!showMore ? 'More...' : 'Less...'}\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  getButtons = (baseNum, amount) => {\n    const { disabled, disabledNumber } = this.props;\n    const btnSize = 'default';\n\n    return Array(amount)\n      .fill(baseNum)\n      .map((num, i) => (\n        <Button\n          key={i}\n          onClick={this.onBtnClick}\n          size={btnSize}\n          disabled={disabled || disabledNumber === i + num}\n        >\n          {i + num}\n        </Button>\n      ));\n  };\n}\n","import React, { Component } from 'react';\n\nexport const CSS_TRANSITIONS = {\n  FADE_IN: 'fade-in',\n  SLIDE_UP: 'slide-up'\n}\n\nexport default class Css extends Component {\n  componentDidMount() {\n    const type = this.props.type;\n    this.div.classList.add(type);\n    setTimeout(() => this.div.classList.remove(type), 400);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.children !== this.props.children) {\n      const type = this.props.type;\n      this.div.classList.add(type);\n      setTimeout(() => this.div.classList.remove(type), 400);\n    }\n  }\n  render() {\n    return (\n      <div\n        className={''}\n        ref={(el) => this.div = el}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}","import React from 'react';\nimport './Pad.css';\nimport Css, { CSS_TRANSITIONS } from '../transition/Css';\n\nconst PlayerPad = (props) => {\n  const { name, bid, won, score } = props;\n\n  return (\n    <div className=\"player-pad\">\n      <div className=\"pad-name\">\n        {name}&nbsp;\n        {score !== undefined &&\n          <span className=\"pad-score\">\n            [<Css type={CSS_TRANSITIONS.SLIDE_UP}>{score}</Css>]\n        </span>}\n      </div>\n\n      <div className=\"pad-bid-won\">\n        Bid: {typeof bid === 'number' ? bid : ' '} Won: {won}\n      </div>\n    </div>\n  );\n};\n\nexport default PlayerPad;","import React from 'react';\nimport './TwoWayArrow.css';\n\nexport const TWO_WAY_ARROW_DIRECTION = {\n  TOP: 'top',\n  BOTTOM: 'bottom'\n};\n\n// TODO: add option for horizontal arrow \n// https://codepen.io/hakimel/pen/gfIsk \n// https://codepen.io/Sloebel/pen/MdLKdY\n\nconst TwoWayArrow = (props) => {\n  return (\n    <div className={`arrow-indicator ${props.direction || ''}`}>\n      <span><i></i><i></i></span>\n      <i></i>\n      <span><i></i><i></i></span>\n    </div>\n  )\n};\n\nexport default TwoWayArrow;","import React, { useCallback } from 'react';\nimport Card2C from '../../images/playCards/2-C.svg'\nimport Card2D from '../../images/playCards/2-D.svg'\nimport Card2H from '../../images/playCards/2-H.svg'\nimport Card2J from '../../images/playCards/2-J.svg'\nimport Card2S from '../../images/playCards/2-S.svg'\nimport Card3C from '../../images/playCards/3-C.svg'\nimport Card3D from '../../images/playCards/3-D.svg'\nimport Card3H from '../../images/playCards/3-H.svg'\nimport Card3S from '../../images/playCards/3-S.svg'\nimport Card4C from '../../images/playCards/4-C.svg'\nimport Card4D from '../../images/playCards/4-D.svg'\nimport Card4H from '../../images/playCards/4-H.svg'\nimport Card4S from '../../images/playCards/4-S.svg'\nimport Card5C from '../../images/playCards/5-C.svg'\nimport Card5D from '../../images/playCards/5-D.svg'\nimport Card5H from '../../images/playCards/5-H.svg'\nimport Card5S from '../../images/playCards/5-S.svg'\n\nimport Card6C from '../../images/playCards/6-C.svg'\nimport Card6D from '../../images/playCards/6-D.svg'\nimport Card6H from '../../images/playCards/6-H.svg'\nimport Card6S from '../../images/playCards/6-S.svg'\n\nimport Card7C from '../../images/playCards/7-C.svg'\nimport Card7D from '../../images/playCards/7-D.svg'\nimport Card7H from '../../images/playCards/7-H.svg'\nimport Card7S from '../../images/playCards/7-S.svg'\n\nimport Card8C from '../../images/playCards/8-C.svg'\nimport Card8D from '../../images/playCards/8-D.svg'\nimport Card8H from '../../images/playCards/8-H.svg'\nimport Card8S from '../../images/playCards/8-S.svg'\n\nimport Card9C from '../../images/playCards/9-C.svg'\nimport Card9D from '../../images/playCards/9-D.svg'\nimport Card9H from '../../images/playCards/9-H.svg'\nimport Card9S from '../../images/playCards/9-S.svg'\n\nimport Card10C from '../../images/playCards/10-C.svg'\nimport Card10D from '../../images/playCards/10-D.svg'\nimport Card10H from '../../images/playCards/10-H.svg'\nimport Card10S from '../../images/playCards/10-S.svg'\n\nimport Card11C from '../../images/playCards/11-C.svg'\nimport Card11D from '../../images/playCards/11-D.svg'\nimport Card11H from '../../images/playCards/11-H.svg'\nimport Card11S from '../../images/playCards/11-S.svg'\n\nimport Card12C from '../../images/playCards/12-C.svg'\nimport Card12D from '../../images/playCards/12-D.svg'\nimport Card12H from '../../images/playCards/12-H.svg'\nimport Card12S from '../../images/playCards/12-S.svg'\n\nimport Card13C from '../../images/playCards/13-C.svg'\nimport Card13D from '../../images/playCards/13-D.svg'\nimport Card13H from '../../images/playCards/13-H.svg'\nimport Card13S from '../../images/playCards/13-S.svg'\n\nimport Card14C from '../../images/playCards/14-C.svg'\nimport Card14D from '../../images/playCards/14-D.svg'\nimport Card14H from '../../images/playCards/14-H.svg'\nimport Card14S from '../../images/playCards/14-S.svg'\n\nimport './PlayCard.scss';\n\nexport interface IPlayCardProps {\n  card: string;\n  preSelected: boolean;\n  thrown: boolean;\n  disabled: boolean;\n  onCardClick: (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => void;\n}\n\nconst PlayCard = (props: IPlayCardProps) => {\n  const { card, preSelected, thrown, onCardClick, disabled } = props;\n\n  const clickHandler = useCallback(\n    (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n      if (!disabled) {\n        onCardClick(event);\n      }\n    },\n    [onCardClick, disabled]\n  );\n  console.log('card', Card2C)\n\n  const getCard = (card: string) => {\n    switch (card) {\n      case '2-C':\n        return Card2C\n      case '2-D':\n        return Card2D\n      case '2-H':\n        return Card2H\n      case '2-J':\n        return Card2J\n      case '2-S':\n        return Card2S\n      case '3-C':\n        return Card3C\n      case '3-D':\n        return Card3D\n      case '3-H':\n        return Card3H\n      case '3-S':\n        return Card3S\n\n      case '4-C':\n        return Card4C\n      case '4-D':\n        return Card4D\n      case '4-H':\n        return Card4H\n      case '4-S':\n        return Card4S\n\n\n      case '5-C':\n        return Card5C\n      case '5-D':\n        return Card5D\n      case '5-H':\n        return Card5H\n      case '5-S':\n        return Card5S\n\n      case '6-C':\n        return Card6C\n      case '6-D':\n        return Card6D\n      case '6-H':\n        return Card6H\n      case '6-S':\n        return Card6S\n\n      case '7-C':\n        return Card7C\n      case '7-D':\n        return Card7D\n      case '7-H':\n        return Card7H\n      case '7-S':\n        return Card7S\n\n      case '8-C':\n        return Card8C\n      case '8-D':\n        return Card8D\n      case '8-H':\n        return Card8H\n      case '8-S':\n        return Card8S\n\n      case '9-C':\n        return Card9C\n      case '9-D':\n        return Card9D\n      case '9-H':\n        return Card9H\n      case '9-S':\n        return Card9S\n\n      case '10-C':\n        return Card10C;\n      case '10-D':\n        return Card10D;\n      case '10-H':\n        return Card10H;\n      case '10-S':\n        return Card10S;\n\n      case '11-C':\n        return Card11C;\n      case '11-D':\n        return Card11D;\n      case '11-H':\n        return Card11H;\n      case '11-S':\n        return Card11S;\n\n      case '12-C':\n        return Card12C;\n      case '12-D':\n        return Card12D;\n      case '12-H':\n        return Card12H;\n      case '12-S':\n        return Card12S;\n\n      case '13-C':\n        return Card13C;\n      case '13-D':\n        return Card13D;\n      case '13-H':\n        return Card13H;\n      case '13-S':\n        return Card13S;\n\n      case '14-C':\n        return Card14C;\n      case '14-D':\n        return Card14D;\n      case '14-H':\n        return Card14H;\n      case '14-S':\n        return Card14S;\n    }\n  }\n\n  return (\n    <div\n      className={`play-card ${preSelected ? 'pre-selected' : ''} ${thrown ? 'thrown' : ''\n        } ${disabled ? 'disabled' : ''}`}\n      onClick={clickHandler}\n    >\n      <img src={getCard(card)} />\n    </div>\n  );\n};\n\nexport default PlayCard;\n","import React, { useState, useEffect } from 'react';\nimport './ThrownCard.scss';\n\nexport type ThrownCardType = 'top' | 'left' | 'right' | 'bottom';\n\nexport interface IThrownCardProps {\n  card?: string;\n  thrownType: ThrownCardType;\n  from?: { top: number; left: number };\n  to: { top: number; left: number };\n  hasWinner?: boolean;\n}\n\nconst ThrownCard = (props: IThrownCardProps) => {\n  const { card, thrownType, from, to, hasWinner } = props;\n  const [style, setStyle] = useState(from ? from : to);\n\n  useEffect(() => {\n    setStyle(to);\n  }, [to]);\n\n  return (\n    <div\n      className={`thrown-card ${thrownType} ${hasWinner ? 'has-winner' : ''}`}\n      style={{ ...style }}\n    >\n      {card && (\n        <img\n          src={require(`../../images/playCards/${card}.svg`)}\n          style={{ width: '90px' }}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default ThrownCard;\n","import React, { Component } from 'react';\r\nimport { Radio, Switch, Badge, Row, Col, Modal, message, Button } from 'antd';\r\nimport { SoundOutlined } from '@ant-design/icons';\r\nimport Icon from '@ant-design/icons';\r\nimport CardsModal from '../../common/cards/Modal';\r\nimport { ChangePlayers } from '../../common/cards/Icons';\r\nimport NumbersPad from '../../common/numbers/Pad';\r\nimport PlayerPad from '../../common/player/Pad';\r\nimport { INPUT_MODE } from '../../constants/states';\r\nimport Dialog from '../../dialogs/Dialog';\r\nimport { Dialogs } from '../../constants/dialogs';\r\nimport { PlayersContext } from '../GameTab';\r\nimport Css, { CSS_TRANSITIONS } from '../../common/transition/Css';\r\nimport TwoWayArrow, {\r\n  TWO_WAY_ARROW_DIRECTION,\r\n} from '../../common/twoWayArrow/TwoWayArrow';\r\nimport PlayCard from '../PlayCard/PlayCard';\r\nimport ThrownCard from '../ThrownCard/ThrownCard';\r\nimport {\r\n  nextPlayerIndex,\r\n  uniqueHand,\r\n  getFromToCalc,\r\n  getToWinnerCalc,\r\n} from '../../utils/game-utils';\r\nimport playerTurn from '../../assets/sounds/playerTurn.mp3';\r\nimport './GamePad.scss';\r\n\r\nconst confirm = Modal.confirm;\r\nmessage.config({\r\n  top: 100,\r\n  maxCount: 3,\r\n});\r\n\r\nclass GamePad extends Component {\r\n  audio = new Audio(playerTurn);\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      selectedPlayer: undefined,\r\n      reorderPlayersDialogVisible: false,\r\n      trumpModalVisible: false,\r\n      preSelectedCard: undefined,\r\n      thrownCard: undefined,\r\n      thrownCards: [],\r\n      handCardType: undefined,\r\n      isMute: false,\r\n    };\r\n\r\n    this.handleSwitchMode = this.handleSwitchMode.bind(this);\r\n    this.handleCardsPadChange = this.handleCardsPadChange.bind(this);\r\n    this.handleNumberSelect = this.handleNumberSelect.bind(this);\r\n    this.setSelectedPlayer = this.setSelectedPlayer.bind(this);\r\n    this.showChangeHighestBidderConfirm = this.showChangeHighestBidderConfirm.bind(\r\n      this\r\n    );\r\n    this.showChangePlayerDialog = this.showChangePlayerDialog.bind(this);\r\n    this.handleReorderPlayersAfterClose = this.handleReorderPlayersAfterClose.bind(\r\n      this\r\n    );\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.gameMode === 'remote') {\r\n      const { devicePlayerIndex, ownCardsState } = this.props;\r\n      const currentRoundData = this.getRoundData();\r\n      const { handsState, currentHand, inputMode } = currentRoundData;\r\n\r\n      const {\r\n        allRounds: prevAllRounds,\r\n        currentRound: prevCurrentRound,\r\n      } = prevProps;\r\n      const prevCurrentRoundData =\r\n        prevAllRounds.length && prevAllRounds[prevCurrentRound - 1];\r\n\r\n      if (\r\n        prevCurrentRoundData.inputMode !== inputMode &&\r\n        inputMode === INPUT_MODE.WON\r\n      ) {\r\n        this.setState({\r\n          selectedPlayer: currentRoundData.highestBidder,\r\n        });\r\n\r\n        if (currentRoundData.highestBidder === devicePlayerIndex) {\r\n          this.playAudio();\r\n        }\r\n      }\r\n\r\n      if (\r\n        prevCurrentRoundData.currentBidder !== currentRoundData.currentBidder &&\r\n        inputMode === INPUT_MODE.BID\r\n      ) {\r\n        this.setState({\r\n          selectedPlayer: currentRoundData.currentBidder,\r\n        });\r\n      }\r\n\r\n      const prevHandsState = prevCurrentRoundData.handsState;\r\n      if (prevHandsState !== handsState) {\r\n        const stateToUpdate = {};\r\n        const thrown =\r\n          handsState &&\r\n          handsState[currentHand] &&\r\n          (handsState[currentHand]['thrownCards'] || []).find(\r\n            (thrown) => thrown.player === devicePlayerIndex\r\n          );\r\n\r\n        if (thrown && thrown.card && (ownCardsState || []).length > 1) {\r\n          stateToUpdate.thrownCard = thrown.card;\r\n        } else {\r\n          stateToUpdate.thrownCard = undefined;\r\n        }\r\n\r\n        if (handsState) {\r\n          const thrownCards = handsState[currentHand]['thrownCards']\r\n            ? uniqueHand([\r\n                ...this.state.thrownCards,\r\n                ...handsState[currentHand]['thrownCards'],\r\n              ])\r\n            : [];\r\n\r\n          stateToUpdate.thrownCards = thrownCards;\r\n          stateToUpdate.selectedPlayer = handsState[currentHand]['turnOf'];\r\n          stateToUpdate.handCardType =\r\n            thrownCards[0] && thrownCards[0].card.split('-')[1];\r\n        } else {\r\n          stateToUpdate.thrownCards = [];\r\n          stateToUpdate.selectedPlayer = currentRoundData.highestBidder;\r\n          stateToUpdate.handCardType = undefined;\r\n        }\r\n\r\n        if (\r\n          inputMode === INPUT_MODE.WON &&\r\n          stateToUpdate.selectedPlayer === devicePlayerIndex\r\n        ) {\r\n          this.playAudio();\r\n        }\r\n\r\n        this.setState(stateToUpdate);\r\n      }\r\n    }\r\n  }\r\n\r\n  handleSwitchMode(checked) {\r\n    const { onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { trump, segment, handsState } = roundData;\r\n\r\n    if (segment === 0) {\r\n      return message.warning('Total Bids are 13?!?!');\r\n    }\r\n\r\n    if (this.state.thrownCard || handsState) {\r\n      return message.warning('Can`t change bids after a card was thrown');\r\n    }\r\n\r\n    const everyoneBid = this.isAllBids(roundData);\r\n\r\n    if (trump && everyoneBid) {\r\n      this.setState({\r\n        selectedPlayer: undefined,\r\n      });\r\n\r\n      onChange({\r\n        ...roundData,\r\n        inputMode: checked ? INPUT_MODE.WON : INPUT_MODE.BID,\r\n      });\r\n    } else {\r\n      message.warning('Bids are not completed');\r\n    }\r\n  }\r\n\r\n  setSelectedPlayer(e) {\r\n    if (this.isAllowedToSelectPlayer() && e.target.type === 'radio') {\r\n      this.setState({\r\n        selectedPlayer: e.target.value,\r\n      });\r\n    }\r\n  }\r\n\r\n  isAllowedToSelectPlayer() {\r\n    const { gameMode } = this.props;\r\n    const roundData = this.getRoundData();\r\n\r\n    if (gameMode === 'remote') {\r\n      const { inputMode, highestBidder } = roundData;\r\n\r\n      return inputMode === INPUT_MODE.WON || typeof highestBidder === 'number'\r\n        ? false\r\n        : true;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  handleCardsPadChange(trump) {\r\n    const { onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode } = roundData;\r\n\r\n    this.setState({ trumpModalVisible: false });\r\n\r\n    if (inputMode !== INPUT_MODE.WON) {\r\n      onChange({ ...roundData, trump });\r\n    }\r\n  }\r\n\r\n  handleNumberSelect(num) {\r\n    const { players, currentRound, onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode, highestBidder } = roundData;\r\n\r\n    if (inputMode === INPUT_MODE.BID && this.props.gameMode === 'remote') {\r\n      return this.handleRemoteBidFlow(num);\r\n    }\r\n\r\n    const { selectedPlayer } = this.state;\r\n    const mode = inputMode === INPUT_MODE.BID ? 'bid' : 'won';\r\n    const prop = mode + selectedPlayer;\r\n\r\n    const newRoundData = {};\r\n\r\n    if (inputMode === INPUT_MODE.BID) {\r\n      if (currentRound === 13) {\r\n        if (\r\n          (num >= 5 && !roundData[`bid${highestBidder}`]) ||\r\n          roundData[`bid${highestBidder}`] < num\r\n        ) {\r\n          newRoundData.highestBidder = selectedPlayer;\r\n        }\r\n      } else {\r\n        const nextPlayer = this.getNextPlayer(selectedPlayer, players);\r\n        const nextPlayerBid = roundData[`bid${nextPlayer}`];\r\n        const beforePlayerBid = this.getBeforePlayerBid(selectedPlayer, players);\r\n\r\n        if (\r\n          nextPlayerBid === undefined || nextPlayerBid === '' ||\r\n          nextPlayer === highestBidder\r\n        ) {\r\n          // validate first bid is more then 5\r\n          if (\r\n            (!highestBidder && highestBidder !== 0) ||\r\n            highestBidder === selectedPlayer\r\n          ) {\r\n            if (num < 5) {\r\n              return message.warning('First Bid should be more then 5');\r\n            } else {\r\n              newRoundData.highestBidder = selectedPlayer;\r\n            }\r\n          } else if (num >= 5) {\r\n            this.showChangeHighestBidderConfirm(\r\n              onChange,\r\n              roundData,\r\n              prop,\r\n              num,\r\n              selectedPlayer,\r\n              players\r\n            );\r\n          } else if (\r\n           !beforePlayerBid && beforePlayerBid !== 0\r\n          ) {\r\n            return message.warning('The Bids are not in the right order!!');\r\n          }\r\n        } else {\r\n          return message.warning(\r\n            'The Next Player already Bid, Can not change bid'\r\n          );\r\n        }\r\n      }\r\n    }\r\n\r\n    newRoundData[prop] = num;\r\n    onChange({ ...roundData, ...newRoundData }, selectedPlayer);\r\n  }\r\n\r\n  calculateDisableNum() {\r\n    const { players } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { highestBidder, inputMode } = roundData;\r\n    const { selectedPlayer } = this.state;\r\n\r\n    if (typeof selectedPlayer !== 'number') return undefined;\r\n\r\n    if (inputMode !== INPUT_MODE.BID) return undefined;\r\n\r\n    if (this.getNextPlayer(selectedPlayer, players) !== highestBidder)\r\n      return undefined;\r\n\r\n    // get the list of players bided before\r\n    const beforePlayers = this.getBeforePlayers(selectedPlayer, players);\r\n\r\n    // loop through 3 players before selectedPlayer\r\n    // if all bid already return segment else return undefined\r\n\r\n    let bids = 0;\r\n\r\n    for (const player of beforePlayers) {\r\n      const aBid = roundData[`bid${player}`];\r\n      if (aBid === null) return undefined;\r\n\r\n      bids += aBid;\r\n    }\r\n\r\n    return 13 - bids;\r\n  }\r\n\r\n  showChangeHighestBidderConfirm(\r\n    onChange,\r\n    roundData,\r\n    prop,\r\n    num,\r\n    selectedPlayer,\r\n    players\r\n  ) {\r\n    confirm({\r\n      title: 'Change Highest Bidder?',\r\n      content: '(will reset the rest of the bids)',\r\n      okType: 'danger',\r\n      onOk() {\r\n        onChange(\r\n          {\r\n            ...roundData,\r\n            bid0: '',\r\n            bid1: '',\r\n            bid2: '',\r\n            bid3: '',\r\n            [prop]: num,\r\n            highestBidder: selectedPlayer,\r\n          },\r\n          selectedPlayer\r\n        );\r\n      },\r\n      onCancel: () => {\r\n        const beforePlayerBid = this.getBeforePlayerBid(selectedPlayer, players);\r\n\r\n        if (beforePlayerBid || beforePlayerBid === 0) {\r\n          onChange({ ...roundData, [prop]: num }, selectedPlayer);\r\n        } else {\r\n          message.warning('The Bids are not in the right order!!');\r\n          onChange({ ...roundData }, selectedPlayer);\r\n        }\r\n      },\r\n    });\r\n  }\r\n\r\n  getNextPlayer = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    const nextIndex = index + 1 > 3 ? index + 1 - 4 : index + 1;\r\n\r\n    return players[nextIndex].index;\r\n  };\r\n\r\n  getBeforePlayer = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    const beforeIndex = index - 1 > -1 ? index - 1 : index - 1 + 4;\r\n\r\n    return players[beforeIndex].index;\r\n  };\r\n\r\n  getBeforePlayerBid = (selectedPlayer, players) => {\r\n    const roundData = this.getRoundData();\r\n    \r\n    return roundData[`bid${this.getBeforePlayer(selectedPlayer, players)}`];\r\n  }\r\n\r\n  getBeforePlayers = (selectedPlayer, players) => {\r\n    const index = players.findIndex(\r\n      (player) => player.index === selectedPlayer\r\n    );\r\n    return players\r\n      .filter((player) => index !== player.index)\r\n      .map((player) => player.index);\r\n  };\r\n\r\n  // getAfterPlayers = (selectedPlayer) => [1, 2, 3].map(afterPlayer => selectedPlayer + afterPlayer > 4 ? selectedPlayer + afterPlayer - 4 : selectedPlayer + afterPlayer);\r\n\r\n  getPlayerAggregateScore = (roundsData, roundIndex, playerIndex) => {\r\n    const roundData = roundsData[roundIndex];\r\n\r\n    if (!roundData) {\r\n      return 0;\r\n    }\r\n\r\n    const aggregateScore = roundData[`aggregateScore${playerIndex}`];\r\n    // if round.fell == true, look for round before\r\n    if (typeof aggregateScore === 'number' && !roundData.fell) {\r\n      return aggregateScore;\r\n    }\r\n\r\n    return this.getPlayerAggregateScore(\r\n      roundsData,\r\n      roundIndex - 1,\r\n      playerIndex\r\n    );\r\n  };\r\n\r\n  render() {\r\n    const { devicePlayerIndex, gameMode } = this.props;\r\n    const currentRoundData = this.getRoundData();\r\n    const {\r\n      round,\r\n      check,\r\n      trump,\r\n      segment,\r\n      inputMode,\r\n      fell,\r\n      factor,\r\n    } = currentRoundData;\r\n    const {\r\n      selectedPlayer,\r\n      reorderPlayersDialogVisible,\r\n      trumpModalVisible,\r\n      isMute,\r\n    } = this.state;\r\n    const isAllBids = this.isAllBids(currentRoundData);\r\n    const playersButtons = this.getPlayersButtons();\r\n    const isRemote = gameMode === 'remote';\r\n\r\n    return (\r\n      <Radio.Group\r\n        buttonStyle=\"solid\"\r\n        className={`game-pad-container ${fell ? 'round-fell' : ''}`}\r\n        onChange={this.setSelectedPlayer}\r\n        value={selectedPlayer}\r\n      >\r\n        <h3>Round: {round}</h3>\r\n        <Row type=\"flex\" justify=\"space-around\">\r\n          <Col>\r\n            <Switch\r\n              onChange={this.handleSwitchMode}\r\n              checkedChildren={isRemote ? ' Play ' : ' Won '}\r\n              unCheckedChildren=\" Bid \"\r\n              checked={inputMode === INPUT_MODE.WON}\r\n            />\r\n            <div className=\"segment\">\r\n              Bids:{' '}\r\n              <Css type={CSS_TRANSITIONS.FADE_IN}>\r\n                {!isAllBids ? `${segment && 13 + segment}` : segment}\r\n              </Css>\r\n              <TwoWayArrow\r\n                direction={\r\n                  isAllBids &&\r\n                  (segment > 0\r\n                    ? TWO_WAY_ARROW_DIRECTION.TOP\r\n                    : TWO_WAY_ARROW_DIRECTION.BOTTOM)\r\n                }\r\n              />\r\n            </div>\r\n            <div>Check: {check ? 'yes' : 'no'}</div>\r\n            <Css type={CSS_TRANSITIONS.FADE_IN}>\r\n              {fell ? <div className=\"fell-indicator\">round fell</div> : ''}\r\n            </Css>\r\n            {!fell && factor > 1 && (\r\n              <div className=\"factor-indicator\">{`x${factor}`}</div>\r\n            )}\r\n            {isRemote && (\r\n              <Button\r\n                className={`toggle-sound-btn ${isMute ? 'is-mute' : ''}`}\r\n                type=\"link\"\r\n                icon={<SoundOutlined />}\r\n                onClick={this.toggleMute}\r\n              />\r\n            )}\r\n          </Col>\r\n          <Col className=\"item item2\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex + 1)]}\r\n          </Col>\r\n          <Col>\r\n            <CardsModal\r\n              trump={trump}\r\n              onChange={this.handleCardsPadChange}\r\n              disabled={inputMode === INPUT_MODE.WON}\r\n              visible={trumpModalVisible}\r\n            />\r\n          </Col>\r\n        </Row>\r\n\r\n        <div\r\n          className=\"thrown-cards-marker\"\r\n          ref={(el) => (this.cardsMarkerRef = el)}\r\n        ></div>\r\n\r\n        <Row type=\"flex\" justify=\"space-around\">\r\n          <Col className=\"item item4\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex)]}\r\n          </Col>\r\n          <Col style={{ zIndex: 1 }}>\r\n            {isRemote && inputMode === INPUT_MODE.WON ? (\r\n              <div className=\"number-pad-placement\"></div>\r\n            ) : (\r\n              <NumbersPad\r\n                disabledNumber={this.calculateDisableNum()}\r\n                onSelect={this.handleNumberSelect}\r\n                disabled={this.isNumberPadDisabled()}\r\n              />\r\n            )}\r\n          </Col>\r\n          <Col className=\"item item6\">\r\n            {playersButtons[nextPlayerIndex(devicePlayerIndex + 2)]}\r\n          </Col>\r\n        </Row>\r\n        <Row type=\"flex\" justify=\"center\" style={{ position: 'relative' }}>\r\n          <Col className=\"item item8\">{playersButtons[devicePlayerIndex]}</Col>\r\n          {!isRemote && round === 1 && inputMode === INPUT_MODE.BID && (\r\n            <div>\r\n              <Button\r\n                type=\"dashed\"\r\n                shape=\"circle\"\r\n                className=\"change-players-btn\"\r\n                onClick={this.showChangePlayerDialog}\r\n              >\r\n                <Icon component={ChangePlayers} />\r\n              </Button>\r\n              {reorderPlayersDialogVisible && (\r\n                <PlayersContext.Consumer>\r\n                  {({ players, reorderPlayers }) => (\r\n                    <Dialog\r\n                      dialog={Dialogs.REORDER_PLAYERS}\r\n                      dialogProps={{\r\n                        onOk: reorderPlayers,\r\n                        onAfterClose: this.handleReorderPlayersAfterClose,\r\n                        visible: reorderPlayersDialogVisible,\r\n                        players,\r\n                      }}\r\n                    />\r\n                  )}\r\n                </PlayersContext.Consumer>\r\n              )}\r\n            </div>\r\n          )}\r\n        </Row>\r\n        {isRemote && this.getThrownCardsPlacement()}\r\n        {this.getCards()}\r\n      </Radio.Group>\r\n    );\r\n  }\r\n\r\n  getPlayersButtons = () => {\r\n    const { allRounds, currentRound, players } = this.props;\r\n    const currentRoundData = allRounds.length && allRounds[currentRound - 1];\r\n    const highestBidder = currentRoundData.highestBidder;\r\n\r\n    return players.map(({ index: playerIndex, playerName }, i) => {\r\n      return (\r\n        <Badge key={playerIndex} dot={highestBidder === playerIndex}>\r\n          <Radio.Button value={playerIndex}>\r\n            <PlayerPad\r\n              name={playerName}\r\n              bid={currentRoundData[`bid${playerIndex}`]}\r\n              won={currentRoundData[`won${playerIndex}`]}\r\n              score={this.getPlayerAggregateScore(\r\n                allRounds,\r\n                currentRound - 1,\r\n                playerIndex\r\n              )}\r\n            />\r\n          </Radio.Button>\r\n        </Badge>\r\n      );\r\n    });\r\n  };\r\n\r\n  showChangePlayerDialog() {\r\n    this.setState({\r\n      reorderPlayersDialogVisible: true,\r\n    });\r\n  }\r\n\r\n  handleReorderPlayersAfterClose() {\r\n    this.setState({\r\n      reorderPlayersDialogVisible: false,\r\n    });\r\n  }\r\n\r\n  handleRemoteBidFlow(num) {\r\n    const { devicePlayerIndex, onChange } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { highestBidder } = roundData;\r\n    const { selectedPlayer } = this.state;\r\n    const stateToUpdate = {};\r\n\r\n    if (typeof highestBidder !== 'number') {\r\n      if (num < 5) {\r\n        return message.warning('First Bid should be more then 5');\r\n      } else {\r\n        stateToUpdate.highestBidder = selectedPlayer;\r\n        stateToUpdate[`bid${selectedPlayer}`] = num;\r\n        stateToUpdate.currentBidder = nextPlayerIndex(selectedPlayer);\r\n\r\n        if (!roundData.trump) {\r\n          setTimeout(\r\n            () =>\r\n              this.setState({\r\n                trumpModalVisible: true,\r\n              }),\r\n            300\r\n          );\r\n        }\r\n      }\r\n    } else if (devicePlayerIndex === selectedPlayer) {\r\n      stateToUpdate[`bid${selectedPlayer}`] = num;\r\n      const nextPlayer = nextPlayerIndex(selectedPlayer);\r\n\r\n      if (nextPlayer === highestBidder) {\r\n        stateToUpdate.currentBidder = '';\r\n\r\n        setTimeout(() => this.handleSwitchMode(true), 1500);\r\n      } else {\r\n        stateToUpdate.currentBidder = nextPlayerIndex(selectedPlayer);\r\n      }\r\n    }\r\n\r\n    if (Object.keys(stateToUpdate).length) {\r\n      onChange({ ...roundData, ...stateToUpdate }, selectedPlayer);\r\n    }\r\n  }\r\n\r\n  getCards() {\r\n    const { ownCardsState, devicePlayerIndex } = this.props;\r\n    const {\r\n      preSelectedCard,\r\n      thrownCard,\r\n      handCardType,\r\n      selectedPlayer,\r\n    } = this.state;\r\n\r\n    if (ownCardsState) {\r\n      const hasCardType = Object.values(ownCardsState).some(\r\n        (card) => card.split('-')[1] === handCardType\r\n      );\r\n      const isDevicePlayer = devicePlayerIndex === selectedPlayer;\r\n\r\n      return (\r\n        <div className=\"cards-container\">\r\n          {Object.values(ownCardsState).map((card) => (\r\n            <PlayCard\r\n              key={card}\r\n              card={card}\r\n              preSelected={preSelectedCard === card}\r\n              thrown={thrownCard === card}\r\n              onCardClick={this.handleCardClick(card)}\r\n              disabled={\r\n                isDevicePlayer &&\r\n                hasCardType &&\r\n                card.split('-')[1] !== handCardType\r\n              }\r\n            />\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return '';\r\n  }\r\n\r\n  // TODO: memoize it\r\n  getThrownCardsPlacement() {\r\n    if (!this.cardsMarkerRef) {\r\n      return '';\r\n    }\r\n    const currentRoundData = this.getRoundData();\r\n    const { handsState, currentHand } = currentRoundData;\r\n    const handWinner = handsState && handsState[currentHand].handWinner;\r\n    const { thrownCards } = this.state;\r\n    const { devicePlayerIndex } = this.props;\r\n    const fn = nextPlayerIndex;\r\n\r\n    const playerOnPadMap = {\r\n      [devicePlayerIndex]: 'bottom',\r\n      [fn(devicePlayerIndex)]: 'left',\r\n      [fn(devicePlayerIndex + 1)]: 'top',\r\n      [fn(devicePlayerIndex + 2)]: 'right',\r\n    };\r\n\r\n    const toWinner =\r\n      handWinner !== undefined &&\r\n      this.getFromTo(playerOnPadMap[handWinner], true);\r\n\r\n    return (\r\n      <div className=\"hand-cards-container\">\r\n        {thrownCards.map((thrown) => {\r\n          const { from, to } =\r\n            toWinner || this.getFromTo(playerOnPadMap[thrown.player]);\r\n\r\n          return (\r\n            <ThrownCard\r\n              key={thrown.player}\r\n              thrownType={playerOnPadMap[thrown.player]}\r\n              card={thrown.card}\r\n              from={from}\r\n              to={to}\r\n              hasWinner={handWinner !== undefined}\r\n            />\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  handleCardClick = (card) => (e) => {\r\n    const { preSelectedCard, selectedPlayer } = this.state;\r\n    const {\r\n      currentRound,\r\n      devicePlayerIndex,\r\n      onCardThrown,\r\n    } = this.props;\r\n    const roundData = this.getRoundData();\r\n    const { inputMode } = roundData;\r\n\r\n    if (inputMode === INPUT_MODE.WON && selectedPlayer === devicePlayerIndex) {\r\n      if (preSelectedCard === card) {\r\n        // throw card\r\n\r\n        // set the initial position of own thrown card\r\n        const top = e.currentTarget.offsetParent.offsetTop - 15;\r\n        const left = e.currentTarget.offsetLeft;\r\n        this.ownThrownCardInitPos = { top, left };\r\n\r\n        this.setState({\r\n          thrownCards: [\r\n            ...this.state.thrownCards,\r\n            {\r\n              player: selectedPlayer,\r\n              card,\r\n            },\r\n          ],\r\n        });\r\n\r\n        onCardThrown(card, selectedPlayer, currentRound, roundData.currentHand);\r\n\r\n        this.setState({\r\n          thrownCard: card,\r\n          // preSelectedCard: undefined,\r\n        });\r\n      } else {\r\n        this.setState({\r\n          preSelectedCard: card,\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  // calculate end position by thrownType\r\n  getFromTo(type, toWinner) {\r\n    const markerTop = this.cardsMarkerRef && this.cardsMarkerRef.offsetTop;\r\n    const markerWidth = this.cardsMarkerRef && this.cardsMarkerRef.offsetWidth;\r\n\r\n    if (toWinner) {\r\n      return getToWinnerCalc(type, markerTop, markerWidth);\r\n    }\r\n\r\n    return getFromToCalc(\r\n      type,\r\n      markerTop,\r\n      markerWidth,\r\n      this.ownThrownCardInitPos\r\n    );\r\n  }\r\n\r\n  // TODO: memoize it\r\n  isAllBids = (roundData) =>\r\n    Array(4)\r\n      .fill(1)\r\n      .every((_, i) => typeof roundData[`bid${i}`] === 'number');\r\n\r\n  getRoundData() {\r\n    const { allRounds, currentRound } = this.props;\r\n    return allRounds.length && allRounds[currentRound - 1];\r\n  }\r\n\r\n  playAudio() {\r\n    !this.state.isMute && this.audio.play();\r\n  }\r\n\r\n  isNumberPadDisabled() {\r\n    const { devicePlayerIndex, gameMode } = this.props;\r\n    const { selectedPlayer } = this.state;\r\n\r\n    return (\r\n      typeof selectedPlayer !== 'number' ||\r\n      (gameMode === 'remote' && devicePlayerIndex !== selectedPlayer)\r\n    );\r\n  }\r\n\r\n  toggleMute = () => {\r\n    this.setState({\r\n      isMute: !this.state.isMute,\r\n    });\r\n  };\r\n}\r\n\r\nexport default GamePad;\r\n","import { INPUT_MODE } from '../constants/states';\r\nimport { IPlayerScoresSummary, IPlayer } from './IPlayerModel';\r\nimport { CARDS } from '../constants/cards';\r\n\r\nexport type GameMode = 'local' | 'remote';\r\n\r\nexport enum GAME_STATUS {\r\n  ACTIVE = 'ACTIVE',\r\n  FINISHED = 'FINISHED',\r\n}\r\n\r\nexport interface IThrownCard {\r\n  card: string;\r\n  player: number;\r\n}\r\n\r\nexport interface IHandState {\r\n  handWinner?: number;\r\n  status: GAME_STATUS;\r\n  thrownCards: IThrownCard[];\r\n}\r\nexport interface IHandsState {\r\n  [handKey: number]: IHandState;\r\n}\r\n\r\nexport interface IBaseRoundData {\r\n  [index: string]: any;\r\n  segment: string | number;\r\n  totalBids: string | number;\r\n  trump: CARDS | string;\r\n  check: boolean;\r\n  factor: number;\r\n  fell: boolean;\r\n  highestBidder: string | number;\r\n  currentBidder?: number;\r\n  inputMode: INPUT_MODE;\r\n  score0: string | number;\r\n  score1: string | number;\r\n  score2: string | number;\r\n  score3: string | number;\r\n  aggregateScore0: string | number;\r\n  aggregateScore1: string | number;\r\n  aggregateScore2: string | number;\r\n  aggregateScore3: string | number;\r\n  bid0: string | number;\r\n  bid1: string | number;\r\n  bid2: string | number;\r\n  bid3: string | number;\r\n  won0: string | number;\r\n  won1: string | number;\r\n  won2: string | number;\r\n  won3: string | number;\r\n  currentHand?: number;\r\n}\r\n\r\nexport interface IRoundData extends IBaseRoundData {\r\n  round: number;\r\n  handsState?: IHandsState;  \r\n}\r\n\r\nexport interface IPlayerHand {\r\n  player: number;\r\n  hand: string;\r\n}\r\n\r\nexport interface ICardsPosition {\r\n  top: number;\r\n  left: number;\r\n}\r\n\r\nexport interface ICardsFromTo {\r\n  from?: ICardsPosition;\r\n  to: ICardsPosition;\r\n}\r\n\r\nexport interface IGameColumn {\r\n  playerName: string;\r\n  index: number;\r\n}\r\n\r\nexport type GameViewType = 'table' | 'panel';\r\n\r\nexport type LeagueScoreType =\r\n  | 'leagueScore0'\r\n  | 'leagueScore1'\r\n  | 'leagueScore2'\r\n  | 'leagueScore3';\r\nexport type LeagueScoreTypeMap = {\r\n  [key in LeagueScoreType]?: number;\r\n};\r\n\r\nexport type TotalScoreType =\r\n  | 'totalScore0'\r\n  | 'totalScore1'\r\n  | 'totalScore2'\r\n  | 'totalScore3';\r\nexport type TotalScoreTypeMap = {\r\n  [key in TotalScoreType]?: number;\r\n};\r\n\r\nexport interface IBaseGameData extends TotalScoreTypeMap {\r\n  [index: string]: any;\r\n  rounds: IRoundData[];\r\n  currentRound: number;\r\n  status?: GAME_STATUS;\r\n}\r\n\r\nexport interface ILeagueGameModel {\r\n  gameID: string;\r\n  gameMode?: GameMode;\r\n  playersOrder?: IPlayer[];\r\n  status?: GAME_STATUS;\r\n}\r\n\r\nexport interface IGameData extends IBaseGameData, ILeagueGameModel {\r\n  [index: string]: any;\r\n  gameID: string;\r\n  dealer?: string;\r\n  gameMode?: GameMode;\r\n  playersOrder?: IPlayer[];\r\n  ownCardsState?: string[];\r\n}\r\n\r\nexport interface IGamePlayersSummary {\r\n  [player: string]: IPlayerScoresSummary;\r\n}\r\n","import React, { Component } from 'react';\nimport { Button } from 'antd';\nimport { RightOutlined, LeftOutlined } from '@ant-design/icons';\nimport MobileTable from '../common/table/MobileTable';\nimport GamePad from './GamePad/GamePad';\nimport { hasTouch, addListener } from '../utils/Utils';\n\nexport default class GameMobileView extends Component {\n  constructor(props) {\n    super(props);\n\n    this.carouselEl = React.createRef();\n    this.carouselSwipedRight = this.carouselSwipedRight.bind(this);\n    this.carouselSwipedLeft = this.carouselSwipedLeft.bind(this);\n  }\n\n  componentDidMount() {\n    if (hasTouch()) {\n      this.unListenSwipedLeft = addListener(\n        this.carouselEl,\n        'swiped-left',\n        this.carouselSwipedLeft\n      );\n      this.unListenSwipedRight = addListener(\n        this.carouselEl,\n        'swiped-right',\n        this.carouselSwipedRight\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    if (hasTouch()) {\n      this.unListenSwipedLeft();\n      this.unListenSwipedRight();\n    }\n  }\n\n  carouselSwipedLeft = () => {\n    const { currentView, onCurrentViewChange } = this.props;\n\n    if (currentView !== 'panel') {\n      onCurrentViewChange('panel');\n    } else {\n      this.carouselEl.classList.add('bounce-left');\n      setTimeout(() => this.carouselEl.classList.remove('bounce-left'), 400);\n    }\n  };\n\n  carouselSwipedRight() {\n    const { currentView, onCurrentViewChange } = this.props;\n\n    if (currentView !== 'table') {\n      onCurrentViewChange('table');\n    } else {\n      this.carouselEl.classList.add('bounce-right');\n      setTimeout(() => this.carouselEl.classList.remove('bounce-right'), 400);\n    }\n  }\n\n  nextRound = () => {\n    const { goToRound, currentRound } = this.props;\n    const round = Number(currentRound);\n\n    if (round < 13) {\n      goToRound && goToRound(round + 1);\n    }\n  };\n\n  toRoundBefore = () => {\n    const { goToRound, currentRound } = this.props;\n    const round = Number(currentRound);\n\n    if (round !== 1) {\n      goToRound && goToRound(round - 1);\n    }\n  };\n\n  render() {\n    const {\n      gameID,\n      gameMode,\n      ownCardsState,\n      currentView,\n      rounds,\n      playersColumns,\n      currentRound,\n      handleSave,\n      leagueScores,\n      devicePlayerIndex,\n      handleCardThrown,\n    } = this.props;\n\n    return (\n      <div\n        className={`game-mobile-view ${\n          gameMode === 'remote' ? 'mode-remote' : ''\n        }`}\n      >\n        <div className=\"my-carousel\" ref={(el) => (this.carouselEl = el)}>\n          <div className={`my-carousel-slides-container ${currentView}`}>\n            <div className=\"my-carousel-slide\">\n              <MobileTable\n                dataSource={rounds}\n                leagueScores={leagueScores}\n                players={playersColumns}\n                currentRound={currentRound}\n                gameID={gameID}\n              />\n            </div>\n            <div className=\"my-carousel-slide\">\n              <GamePad\n                gameMode={gameMode}\n                ownCardsState={ownCardsState}\n                onCardThrown={handleCardThrown}\n                currentRound={currentRound}\n                allRounds={rounds}\n                players={playersColumns}\n                devicePlayerIndex={devicePlayerIndex}\n                onChange={handleSave}\n              />\n            </div>\n          </div>\n        </div>\n        {this.showNavigation() && (\n          <div className=\"round-navigation\">\n            {currentRound !== 1 && (\n              <Button\n                type=\"primary\"\n                className=\"left\"\n                ghost\n                onClick={this.toRoundBefore}\n              >\n                <LeftOutlined />\n                {`Round ${currentRound - 1}`}\n              </Button>\n            )}\n\n            {currentRound !== 13 && (\n              <Button type=\"primary\" ghost onClick={this.nextRound}>\n                {`Round ${Number(currentRound) + 1}`}\n                <RightOutlined />\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  showNavigation() {\n    const { gameMode, ownCardsState, currentView } = this.props;\n\n    return (\n      gameMode !== 'remote' ||\n      (ownCardsState || []).length === 0 ||\n      currentView === 'table'\n    );\n  }\n}\n","export const GAME_DEFAULT_SCORES = [10, 7, 3, 1];","import { fire } from '../firebase';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport default class GameService {\r\n  // the request to set cards by player will happen only if current user is the dealer\r\n  // but if the data already exist it will not override it (by database rules)\r\n  public static setCardsToPlayers(\r\n    gameKey: string,\r\n    round: number,\r\n    cardsByPlayer: {\r\n      [key: string]: string[];\r\n    }\r\n  ) {\r\n    fire\r\n      .database()\r\n      .ref()\r\n      .child(`cardsByGame/${gameKey}/round${round}`)\r\n      .update(\r\n        {\r\n          cardsState: cardsByPlayer,\r\n        },\r\n        (error) => {\r\n          if (error) {\r\n            console.error('cards state probably already exists');\r\n          }\r\n        }\r\n      );\r\n  }\r\n\r\n  public static updateHandCardsState(\r\n    gameKey: string,\r\n    round: number,\r\n    cardIndex?: string\r\n  ) {\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    if (userId) {\r\n      fire\r\n        .database()\r\n        .ref()\r\n        .child(`cardsByGame/${gameKey}/round${round}/cardsState/${userId}`)\r\n        .update({ [`${cardIndex}`]: null });\r\n    }\r\n  }\r\n\r\n  public static savePlayersOrder(\r\n    leagueID: string,\r\n    gameKey: string,\r\n    playersOrder: IPlayer[]\r\n  ) {\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${gameKey}`)\r\n      .update({ playersOrder });\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { fire } from '../firebase';\r\nimport { Button, message } from 'antd';\r\nimport { TableOutlined, BorderOuterOutlined } from '@ant-design/icons';\r\nimport {\r\n  getDevicePlayerIndex,\r\n  dealCards,\r\n  nextPlayerIndex,\r\n  getTotalWonBid,\r\n  calcIfRoundFell,\r\n  getTotalRemoteWonBid,\r\n  calculateHandWinner,\r\n} from '../utils/game-utils';\r\nimport './GameTab.scss';\r\nimport { INPUT_MODE } from '../constants/states';\r\nimport GameMobileView from './GameMobileView';\r\nimport { GAME_DEFAULT_SCORES } from '../constants/scores';\r\nimport GameService from '../services/GameSrv';\r\nimport {\r\n  IGameColumn,\r\n  GameViewType,\r\n  GAME_STATUS,\r\n  IGameData,\r\n  ILeagueGameModel,\r\n  IGamePlayersSummary,\r\n  IRoundData,\r\n  TotalScoreTypeMap,\r\n  TotalScoreType,\r\n  LeagueScoreTypeMap,\r\n  LeagueScoreType,\r\n  IThrownCard,\r\n} from '../models/IGameModel';\r\nimport { RouteComponentProps } from 'react-router-dom';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nexport const PlayersContext = React.createContext<{\r\n  players: IPlayer[];\r\n  reorderPlayers?: (newOrder: IPlayer[]) => void;\r\n}>({ players: [] });\r\n\r\ntype GameRouteParams = {\r\n  leagueID: string;\r\n  gameID: string;\r\n};\r\n\r\nexport interface IGameTabProps extends RouteComponentProps<GameRouteParams> {\r\n  players: IPlayer[];\r\n  loaderStateCb: (loading: boolean) => void;\r\n}\r\n\r\nexport interface IGameTabState {\r\n  players: IPlayer[];\r\n  devicePlayerIndex: number | null;\r\n  columns: IGameColumn[];\r\n  currentView: GameViewType;\r\n  gameData: Partial<IGameData>;\r\n  gameSummary: IGamePlayersSummary;\r\n}\r\n\r\nclass GameTab extends Component<IGameTabProps, IGameTabState> {\r\n  private gameRef?: firebase.database.Reference;\r\n  private leagueGamesRef?: firebase.database.Query;\r\n  private gameSummaryRef?: firebase.database.Reference;\r\n  private ownCardsStateRef?: firebase.database.Reference;\r\n  private gameKey: string = '';\r\n\r\n  constructor(props: IGameTabProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      players: props.players,\r\n      devicePlayerIndex: null, //this.getDevicePlayerIndex(props.players),\r\n      columns: [], //this.initColumns(props.players),\r\n      currentView: 'table',\r\n      gameData: {\r\n        currentRound: 1,\r\n        dealer: undefined,\r\n        rounds: [],\r\n        totalScore0: undefined,\r\n        totalScore1: undefined,\r\n        totalScore2: undefined,\r\n        totalScore3: undefined,\r\n        // status: '',\r\n      },\r\n      gameSummary: {},\r\n    };\r\n\r\n    this.selectActiveRound = this.selectActiveRound.bind(this);\r\n    this.setCurrentViewState = this.setCurrentViewState.bind(this);\r\n    // this.selectActiveRound = this.selectActiveRound.bind(this);\r\n    this.handleReorderPlayers = this.handleReorderPlayers.bind(this);\r\n  }\r\n\r\n  private fetch() {\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { leagueID, gameID } = params;\r\n\r\n    const db = fire.database();\r\n\r\n    if (this.gameRef) {\r\n      this.gameRef.off('value');\r\n    }\r\n\r\n    this.leagueGamesRef = db\r\n      .ref(`leagueGames/_${leagueID}`)\r\n      .orderByChild('gameID')\r\n      .equalTo(Number(gameID));\r\n\r\n    this.leagueGamesRef.once('value', (snapshot) => {\r\n      const gameData = Object.values(snapshot.val())[0] as ILeagueGameModel;\r\n      const gameKey = Object.keys(snapshot.val())[0];\r\n      this.gameKey = gameKey;\r\n      this.gameRef = db.ref(`games/${gameKey}`);\r\n      this.gameSummaryRef = db.ref(\r\n        `leagueGamesSummary/_${leagueID}/${gameKey}/players`\r\n      );\r\n      const { gameMode, playersOrder } = gameData;\r\n\r\n      const players = playersOrder || this.props.players;\r\n\r\n      this.setState({\r\n        players,\r\n        columns: this.initColumns(players),\r\n        devicePlayerIndex: getDevicePlayerIndex(players),\r\n      });\r\n\r\n      this.gameRef.on('value', (snap) => {\r\n        const gameRefData = snap.val();\r\n\r\n        this.setState({\r\n          gameData: {\r\n            ...this.state.gameData,\r\n            gameMode,\r\n            ...gameRefData,\r\n          },\r\n        });\r\n\r\n        this.props.loaderStateCb(false);\r\n      });\r\n\r\n      this.gameSummaryRef.on('value', (snap) => {\r\n        this.setState({\r\n          gameSummary: {\r\n            ...snap.val(),\r\n          },\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.gameRef?.off('value');\r\n    this.gameSummaryRef?.off('value');\r\n    if (this.ownCardsStateRef) {\r\n      this.ownCardsStateRef.off('value');\r\n    }\r\n  }\r\n\r\n  public componentDidUpdate(\r\n    prevProps: IGameTabProps,\r\n    prevState: IGameTabState\r\n  ) {\r\n    if (prevProps.match.params.gameID !== this.props.match.params.gameID) {\r\n      this.fetch();\r\n    }\r\n\r\n    const { gameData } = this.state;\r\n\r\n    if (\r\n      prevState.gameData.gameMode !== gameData.gameMode ||\r\n      prevState.gameData.currentRound !== gameData.currentRound\r\n    ) {\r\n      this.handleGameModeChange();\r\n    }\r\n\r\n    if (prevState.gameData !== gameData) {\r\n      const { currentRound, dealer, gameMode } = gameData;\r\n      const roundData = this.getRoundData(currentRound as number);\r\n\r\n      if (gameMode === 'remote' && roundData) {\r\n        const { handsState, currentHand } = roundData;\r\n        const currentHandState =\r\n          handsState && handsState[currentHand as number];\r\n        const userId = fire.auth().currentUser?.uid;\r\n\r\n        if (\r\n          currentHandState &&\r\n          (currentHandState.thrownCards || []).length === 4 &&\r\n          currentHandState.status === 'ACTIVE'\r\n        ) {\r\n          setTimeout(() => {\r\n            if (dealer === userId) {\r\n              this.handleHandFinished(roundData);\r\n            }\r\n          }, 2500);\r\n        }\r\n\r\n        if (\r\n          currentHand === 13 &&\r\n          (handsState || {})[currentHand].status === 'FINISHED' &&\r\n          dealer === userId\r\n        ) {\r\n          this.calculateHandScore(roundData);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private handleSave = (row: IRoundData, player: number) => {\r\n    const stateToUpdate: Partial<IGameData> = {};\r\n    let summaryToUpdate;\r\n    const prevRounds = this.state.gameData.rounds || [];\r\n    const newData = [...prevRounds];\r\n    const index = newData.findIndex((item) => row.round === item.round);\r\n\r\n    const item = newData[index];\r\n\r\n    newData.splice(index, 1, {\r\n      ...item,\r\n      ...row,\r\n    });\r\n\r\n    // reference to the new Data relevant row to update with score and segment\r\n    row = newData[index];\r\n\r\n    if (typeof player === 'number') {\r\n      // calculate score\r\n      this.calculatePlayerScore(row, player, newData, index, stateToUpdate);\r\n\r\n      //update O/U\r\n      const {\r\n        currentTotalBid,\r\n        currentTotalWon,\r\n        allHasWonInput,\r\n      } = getTotalWonBid(row);\r\n\r\n      row.segment = currentTotalBid !== null ? currentTotalBid - 13 : '';\r\n      row.check = allHasWonInput && currentTotalWon === 13;\r\n\r\n      // calculate if round fell - change next round factor\r\n      if (row.check) {\r\n        const didRoundFell = calcIfRoundFell(row);\r\n\r\n        if (didRoundFell) {\r\n          row.fell = true;\r\n\r\n          if (row.round < 12) {\r\n            // because metaData index is zero based row.round value is next round index\r\n            newData[row.round].factor = row.factor * 2;\r\n          } else if (row.factor > 1) {\r\n            newData[row.round].factor = row.factor;\r\n          }\r\n        } else if (row.fell) {\r\n          row.fell = false;\r\n          if (newData[row.round]) {\r\n            newData[row.round].factor =\r\n              row.factor > 1 ? row.factor / 2 : row.factor;\r\n          }\r\n\r\n          for (let i = 0; i < 4; i++) {\r\n            this.calculatePlayerScore(row, i, newData, index, stateToUpdate);\r\n          }\r\n        }\r\n\r\n        // calculate round summary stats\r\n        summaryToUpdate = this.calculateSummary(newData, index);\r\n\r\n        if (row.round === 13 && !row.fell) {\r\n          stateToUpdate.status = GAME_STATUS.FINISHED;\r\n          this.updateGameStatus(GAME_STATUS.FINISHED);\r\n\r\n          // round summary league scores\r\n          const {\r\n            totalScore0,\r\n            totalScore1,\r\n            totalScore2,\r\n            totalScore3,\r\n          } = this.state.gameData;\r\n          const scores: TotalScoreTypeMap = {\r\n            totalScore0,\r\n            totalScore1,\r\n            totalScore2,\r\n            totalScore3,\r\n          };\r\n          const totalScore: TotalScoreType = `totalScore${player}` as TotalScoreType;\r\n          scores[totalScore] = stateToUpdate[totalScore];\r\n          summaryToUpdate = this.calculateLeagueScores(scores, summaryToUpdate);\r\n        }\r\n\r\n        this.gameSummaryRef?.update(this.mapToPlayersObj(summaryToUpdate));\r\n      }\r\n    }\r\n\r\n    if (this.state.gameData.gameMode === 'remote') {\r\n      // prev round inputMode === BID\r\n      // round inputMode === WON\r\n      // set players with won === 0;\r\n      const prevRound = prevRounds[index];\r\n\r\n      if (\r\n        prevRound.inputMode === INPUT_MODE.BID &&\r\n        row.inputMode === INPUT_MODE.WON\r\n      ) {\r\n        [0, 1, 2, 3].forEach((player) => {\r\n          row[`won${player}`] = 0;\r\n        });\r\n      }\r\n    }\r\n\r\n    stateToUpdate.rounds = newData;\r\n\r\n    // this.setState(stateToUpdate);\r\n    this.gameRef?.update(stateToUpdate);\r\n  };\r\n\r\n  private handleCardThrown = (\r\n    card: string,\r\n    player: number,\r\n    currentRound: number,\r\n    currentHand: number\r\n  ) => {\r\n    const roundData = this.getRoundData(currentRound);\r\n    const thrownCards =\r\n      (roundData &&\r\n        roundData.handsState &&\r\n        roundData.handsState[currentHand].thrownCards) ||\r\n      [];\r\n    const newThrownCards = [...thrownCards, { player, card }];\r\n\r\n    const {\r\n      gameData: { ownCardsState },\r\n    } = this.state;\r\n\r\n    this.gameRef\r\n      ?.child(`rounds/${currentRound - 1}/handsState/${currentHand}`)\r\n      .update({\r\n        status: 'ACTIVE',\r\n        turnOf: newThrownCards.length !== 4 ? nextPlayerIndex(player) : null,\r\n        thrownCards: newThrownCards,\r\n      })\r\n      .then(() => this.updateOwnCardState(card, currentRound, ownCardsState));\r\n  };\r\n\r\n  private calculatePlayerScore = (\r\n    round: IRoundData,\r\n    player: number,\r\n    roundsData: IRoundData[],\r\n    currentRound: number,\r\n    stateToUpdate: Partial<IGameData>\r\n  ) => {\r\n    let rowScore;\r\n\r\n    const bid = round[`bid${player}`];\r\n    const won = round[`won${player}`];\r\n\r\n    if (won !== '' && bid !== '') {\r\n      if (won === bid) {\r\n        if (won * 1 === 0) {\r\n          rowScore = (round.segment as number) > 0 ? 25 : 50;\r\n        } else {\r\n          rowScore = Math.pow(won, 2) + 10;\r\n        }\r\n      } else {\r\n        const diff = Math.abs(won - bid);\r\n\r\n        if (bid * 1 === 0) {\r\n          rowScore =\r\n            -((round.segment as number) > 0 ? 25 : 50) + (diff - 1) * 10;\r\n        } else {\r\n          rowScore = diff * -10;\r\n        }\r\n      }\r\n\r\n      rowScore *= round.factor;\r\n\r\n      round[`score${player}`] = rowScore;\r\n\r\n      //calculate aggregate score\r\n      let aggregateScore = 0;\r\n      for (let i = 0; i <= currentRound; i++) {\r\n        const round = roundsData[i];\r\n\r\n        if (typeof round[`score${player}`] === 'number' && !round.fell) {\r\n          aggregateScore += round[`score${player}`];\r\n        }\r\n      }\r\n      round[`aggregateScore${player}`] = aggregateScore;\r\n      stateToUpdate[`totalScore${player}`] = round[`aggregateScore${player}`];\r\n    }\r\n  };\r\n\r\n  private calculateLeagueScores = (\r\n    scores: TotalScoreTypeMap,\r\n    summaryToUpdate: IGamePlayersSummary\r\n  ): IGamePlayersSummary => {\r\n    const sortedScores: TotalScoreType[] = (Object.keys(\r\n      scores\r\n    ) as TotalScoreType[]).sort(\r\n      (a: TotalScoreType, b: TotalScoreType) =>\r\n        (scores[b] || 0) - (scores[a] || 0)\r\n    );\r\n\r\n    sortedScores.forEach((scoreIndex: TotalScoreType, i) => {\r\n      const score = scores[scoreIndex] as number;\r\n      let leagueScore = GAME_DEFAULT_SCORES[i];\r\n\r\n      // score < 0 => -1\r\n      if (score < 0) {\r\n        leagueScore--;\r\n      }\r\n\r\n      // score reminder from 100 == 0 => leagueScore + 1\r\n      if (score % 100 === 0) {\r\n        leagueScore++;\r\n      }\r\n\r\n      // score > 300 => +3\r\n      if (score > 300) {\r\n        leagueScore += 3;\r\n      }\r\n\r\n      // score < -100 => -3\r\n      if (score < -100) {\r\n        leagueScore -= 3;\r\n      }\r\n\r\n      summaryToUpdate[`${scoreIndex.slice(-1)}`].leagueScore = leagueScore;\r\n    });\r\n\r\n    return summaryToUpdate;\r\n  };\r\n\r\n  private calculateSummary = (\r\n    roundsData: IRoundData[],\r\n    currentRoundIndex: number\r\n  ): IGamePlayersSummary => {\r\n    const currentRound = currentRoundIndex + 1;\r\n    const playersSummary: IGamePlayersSummary = {};\r\n\r\n    for (let pIndex = 0; pIndex < 4; pIndex++) {\r\n      // playersSummary[pIndex] = {};\r\n      let stood = 0;\r\n      let totalRounds = 0;\r\n      let totalHBrounds = 0;\r\n      let stoodWhileHB = 0;\r\n      let stoodInOver = 0;\r\n      let totalOverRounds = 0;\r\n      let stoodInUnder = 0;\r\n      let totalNTrounds = 0;\r\n      let stoodInNT = 0;\r\n      let stoodWhenLastBidder = 0;\r\n      let totalStoodWhenLastBidder = 0;\r\n\r\n      for (let rIndex = 0; rIndex < currentRound; rIndex++) {\r\n        const round = roundsData[rIndex];\r\n        if (!round.fell) {\r\n          totalRounds++;\r\n          const highestBidder = round.highestBidder === pIndex;\r\n          const lastBidder =\r\n            !highestBidder &&\r\n            (pIndex + 1 > 3 ? 0 : pIndex + 1) === round.highestBidder;\r\n\r\n          if (highestBidder) {\r\n            totalHBrounds++;\r\n          } else if (lastBidder) {\r\n            totalStoodWhenLastBidder++;\r\n          }\r\n\r\n          if (round.segment && round.segment > 0) {\r\n            totalOverRounds++;\r\n          }\r\n\r\n          if (round.trump === 'NT') {\r\n            totalNTrounds++;\r\n          }\r\n\r\n          if (round[`bid${pIndex}`] === round[`won${pIndex}`]) {\r\n            stood++;\r\n\r\n            if (highestBidder) {\r\n              stoodWhileHB++;\r\n            } else if (lastBidder) {\r\n              stoodWhenLastBidder++;\r\n            }\r\n\r\n            if (round.trump === 'NT') {\r\n              stoodInNT++;\r\n            }\r\n\r\n            round.segment && round.segment > 0 ? stoodInOver++ : stoodInUnder++;\r\n          }\r\n        }\r\n      }\r\n\r\n      const successRate = { wins: stood, total: totalRounds };\r\n      const successRateHB = { wins: stoodWhileHB, total: totalHBrounds };\r\n      const successRateOver = { wins: stoodInOver, total: totalOverRounds };\r\n      const successRateUnder = {\r\n        wins: stoodInUnder,\r\n        total: totalRounds - totalOverRounds,\r\n      };\r\n      const successRateNT = { wins: stoodInNT, total: totalNTrounds };\r\n      const successRateLastBidder = {\r\n        wins: stoodWhenLastBidder,\r\n        total: totalStoodWhenLastBidder,\r\n      };\r\n\r\n      playersSummary[pIndex] = {\r\n        // successRate: Number.isNaN(successRate) ? '' : successRate,\r\n        leagueScore: 0,\r\n        successRate,\r\n        successRateHB,\r\n        successRateOver,\r\n        successRateUnder,\r\n        successRateNT,\r\n        successRateLastBidder,\r\n      };\r\n    }\r\n\r\n    return playersSummary;\r\n  };\r\n\r\n  private mapToPlayersObj = (\r\n    summaryToUpdate: IGamePlayersSummary\r\n  ): IGamePlayersSummary => {\r\n    const { players, gameSummary } = this.state;\r\n\r\n    return players.reduce((obj: IGamePlayersSummary, player, index) => {\r\n      obj[player.key] = {\r\n        ...gameSummary[player.key],\r\n        ...summaryToUpdate[index],\r\n      };\r\n\r\n      return obj;\r\n    }, {});\r\n  };\r\n\r\n  private updateGameStatus = (status: GAME_STATUS) => {\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { leagueID } = params;\r\n\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${this.gameKey}`)\r\n      .update({ status });\r\n  };\r\n\r\n  private toggleSlide = () => {\r\n    const currentView = this.state.currentView === 'panel' ? 'table' : 'panel';\r\n    this.setCurrentViewState(currentView);\r\n  };\r\n\r\n  private setCurrentViewState(currentView: GameViewType) {\r\n    this.setState({ currentView });\r\n  }\r\n\r\n  private selectActiveRound(newRound: number) {\r\n    const { gameData, currentView } = this.state;\r\n    const { rounds, currentRound, gameMode, dealer } = gameData;\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    if (\r\n      Number(newRound) < Number(currentRound) ||\r\n      (rounds && rounds[(currentRound as number) - 1].check)\r\n    ) {\r\n      this.gameRef?.update({\r\n        currentRound: Number(newRound),\r\n      });\r\n\r\n      if (currentView === 'table') {\r\n        this.toggleSlide();\r\n      }\r\n\r\n      if (\r\n        gameMode === 'remote' &&\r\n        dealer === userId &&\r\n        !(rounds as IRoundData[])[newRound - 1].handsState\r\n      ) {\r\n        // deal cards\r\n        const { players } = this.state;\r\n        const cardsByPlayer = dealCards(players);\r\n\r\n        // *** if cards already exist for this round firebase will block the update\r\n        GameService.setCardsToPlayers(this.gameKey, newRound, cardsByPlayer);\r\n      }\r\n    } else {\r\n      message.warning('Current round is not completed');\r\n    }\r\n  }\r\n\r\n  private handleReorderPlayers(newOrder: IPlayer[]) {\r\n    this.setState({\r\n      players: newOrder,\r\n      devicePlayerIndex: getDevicePlayerIndex(newOrder),\r\n      columns: this.initColumns(newOrder),\r\n    });\r\n\r\n    const { params } = this.props.match;\r\n    const { leagueID } = params;\r\n    fire\r\n      .database()\r\n      .ref(`leagueGames/_${leagueID}/${this.gameKey}`)\r\n      .update({ playersOrder: newOrder });\r\n  }\r\n\r\n  private getLeagueScores = (): LeagueScoreTypeMap => {\r\n    const { gameSummary, players } = this.state;\r\n\r\n    if (Object.keys(gameSummary).length === 0) {\r\n      return {\r\n        leagueScore0: 0,\r\n        leagueScore1: 0,\r\n        leagueScore2: 0,\r\n        leagueScore3: 0,\r\n      };\r\n    }\r\n\r\n    return players.reduce((summaryObj: LeagueScoreTypeMap, player, i) => {\r\n      summaryObj[`leagueScore${i}` as LeagueScoreType] =\r\n        gameSummary[player.key].leagueScore;\r\n      return summaryObj;\r\n    }, {});\r\n  };\r\n\r\n  public render() {\r\n    const {\r\n      columns,\r\n      currentView,\r\n      gameData,\r\n      players,\r\n      devicePlayerIndex,\r\n    } = this.state;\r\n    const { rounds, currentRound, gameMode, ownCardsState } = gameData;\r\n    const { match } = this.props;\r\n    const { params } = match;\r\n    const { gameID } = params;\r\n    const playersColumns = columns.slice(0, 4);\r\n\r\n    return (\r\n      <PlayersContext.Provider\r\n        value={{ players, reorderPlayers: this.handleReorderPlayers }}\r\n      >\r\n        {createPortal(\r\n          <Button\r\n            className=\"toggle-view-btn\"\r\n            type=\"link\"\r\n            onClick={this.toggleSlide}\r\n            icon={\r\n              currentView === 'table' ? (\r\n                <BorderOuterOutlined />\r\n              ) : (\r\n                <TableOutlined />\r\n              )\r\n            }\r\n          />,\r\n          document.querySelector('#app-header') || document.body\r\n        )}\r\n\r\n        <GameMobileView\r\n          gameID={gameID}\r\n          gameMode={gameMode}\r\n          currentView={currentView}\r\n          rounds={rounds}\r\n          ownCardsState={ownCardsState}\r\n          handleCardThrown={this.handleCardThrown}\r\n          // handState={}\r\n          playersColumns={playersColumns}\r\n          devicePlayerIndex={devicePlayerIndex}\r\n          currentRound={currentRound}\r\n          handleSave={this.handleSave}\r\n          onCurrentViewChange={this.setCurrentViewState}\r\n          goToRound={this.selectActiveRound}\r\n          leagueScores={this.getLeagueScores()}\r\n        />\r\n      </PlayersContext.Provider>\r\n    );\r\n  }\r\n\r\n  private initColumns = (players: IPlayer[]): IGameColumn[] => {\r\n    return players.map(({ nickname }, i) => {\r\n      return {\r\n        playerName: nickname,\r\n        index: i,\r\n      };\r\n    });\r\n  };\r\n\r\n  private getRoundData(roundIndex: number) {\r\n    return (this.state.gameData.rounds || []).find(\r\n      (round) => round.round === roundIndex\r\n    );\r\n  }\r\n\r\n  private handleGameModeChange() {\r\n    const { gameData, players } = this.state;\r\n    const { gameMode } = gameData;\r\n\r\n    if (gameMode === 'remote') {\r\n      const { currentRound, dealer } = gameData;\r\n      const userId = fire.auth().currentUser?.uid;\r\n\r\n      this.ownCardsStateRef = fire\r\n        .database()\r\n        .ref(\r\n          `cardsByGame/${this.gameKey}/round${currentRound}/cardsState/${userId}`\r\n        );\r\n\r\n      this.ownCardsStateRef.on('value', (snap) => {\r\n        console.log(snap.val());\r\n        this.setState((state) => {\r\n          return {\r\n            gameData: {\r\n              ...state.gameData,\r\n              ownCardsState: snap.val() || [],\r\n            },\r\n          };\r\n        });\r\n\r\n        const {\r\n          gameData: { currentRound },\r\n        } = this.state;\r\n        const roundData = this.getRoundData(currentRound as number);\r\n\r\n        // if current round === 1 and no handsState and gameMode === remote then deal cards\r\n        if (\r\n          !snap.val() &&\r\n          currentRound === 1 &&\r\n          !roundData?.handsState &&\r\n          dealer === userId\r\n        ) {\r\n          const cardsByPlayer = dealCards(players);\r\n          GameService.setCardsToPlayers(\r\n            this.gameKey,\r\n            currentRound,\r\n            cardsByPlayer\r\n          );\r\n        }\r\n      });\r\n    } else if (gameData.ownCardsState) {\r\n      this.setState({\r\n        gameData: {\r\n          ...gameData,\r\n          ownCardsState: undefined,\r\n        },\r\n      });\r\n    }\r\n  }\r\n\r\n  private handleHandFinished(roundData: IRoundData) {\r\n    const winner = calculateHandWinner(roundData);\r\n    const { round, handsState, currentHand } = roundData;\r\n\r\n    this.gameRef\r\n      ?.child(`rounds/${round - 1}`)\r\n      .update({\r\n        [`won${winner.player}`]: roundData[`won${winner.player}`]\r\n          ? roundData[`won${winner.player}`] + 1\r\n          : 1,\r\n        handsState: {\r\n          ...handsState,\r\n          [currentHand as number]: {\r\n            ...(handsState || {})[currentHand as number],\r\n            status: 'FINISHED',\r\n            handWinner: winner.player,\r\n          },\r\n          [(currentHand as number) + 1]: {\r\n            status: 'ACTIVE',\r\n            turnOf: winner.player,\r\n            thrownCards: [],\r\n          },\r\n        },\r\n      })\r\n      .then(() =>\r\n        setTimeout(\r\n          () => currentHand !== 13 && this.goToNextHand(roundData, winner),\r\n          200\r\n        )\r\n      );\r\n  }\r\n\r\n  private goToNextHand(roundData: IRoundData, winner: IThrownCard) {\r\n    const { round, currentHand } = roundData;\r\n\r\n    this.gameRef?.child(`rounds/${round - 1}`).update({\r\n      // [`won${winner.player}`]: roundData[`won${winner.player}`]\r\n      //   ? roundData[`won${winner.player}`] + 1\r\n      //   : 1,\r\n      currentHand: (currentHand as number) + 1,\r\n      // handsState: {\r\n      //   // ...handsState,\r\n      //   [currentHand + 1]: {\r\n      //     status: 'ACTIVE',\r\n      //     turnOf: winner.player,\r\n      //     thrownCards: [],\r\n      //   },\r\n      // },\r\n    });\r\n  }\r\n\r\n  private calculateHandScore(roundData: IRoundData) {\r\n    const gameData = { ...this.state.gameData };\r\n    const { rounds: allRounds, currentRound } = gameData;\r\n    const newRound = { ...roundData };\r\n    const gameToUpdate: Partial<IGameData> = {};\r\n\r\n    [0, 1, 2, 3].forEach((player) =>\r\n      this.calculatePlayerScore(\r\n        newRound,\r\n        player,\r\n        allRounds as IRoundData[],\r\n        (currentRound as number) - 1,\r\n        gameToUpdate\r\n      )\r\n    );\r\n\r\n    // calc if round check\r\n    // update O/U\r\n    const { currentTotalWon } = getTotalRemoteWonBid(newRound);\r\n\r\n    newRound.check = currentTotalWon === 13;\r\n\r\n    // calculate if round fell - change next round factor\r\n    if (newRound.check && allRounds) {\r\n      const didRoundFell = calcIfRoundFell(newRound);\r\n\r\n      if (didRoundFell) {\r\n        newRound.fell = true;\r\n\r\n        if (newRound.round < 12) {\r\n          // because metaData index is zero based row.round value is next round index\r\n          allRounds[newRound.round].factor = newRound.factor * 2;\r\n        } else if (newRound.factor > 1) {\r\n          allRounds[newRound.round].factor = newRound.factor;\r\n        }\r\n      } else if (newRound.fell) {\r\n        newRound.fell = false;\r\n        if (allRounds[newRound.round]) {\r\n          allRounds[newRound.round].factor =\r\n            newRound.factor > 1 ? newRound.factor / 2 : newRound.factor;\r\n        }\r\n\r\n        for (let i = 0; i < 4; i++) {\r\n          this.calculatePlayerScore(\r\n            newRound,\r\n            i,\r\n            allRounds,\r\n            (currentRound as number) - 1,\r\n            gameToUpdate\r\n          );\r\n        }\r\n      }\r\n\r\n      // calculate round summary stats\r\n      let summaryToUpdate = this.calculateSummary(\r\n        allRounds,\r\n        (currentRound as number) - 1\r\n      );\r\n\r\n      if (newRound.round === 13 && !newRound.fell) {\r\n        gameToUpdate.status = GAME_STATUS.FINISHED;\r\n        this.updateGameStatus(GAME_STATUS.FINISHED);\r\n\r\n        // round summary league scores\r\n        const {\r\n          totalScore0,\r\n          totalScore1,\r\n          totalScore2,\r\n          totalScore3,\r\n        } = gameToUpdate;\r\n        const scores = { totalScore0, totalScore1, totalScore2, totalScore3 };\r\n        // scores[`totalScore${player}`] = gameToUpdate[`totalScore${player}`];\r\n        summaryToUpdate = this.calculateLeagueScores(scores, summaryToUpdate);\r\n      }\r\n\r\n      this.gameSummaryRef?.update(this.mapToPlayersObj(summaryToUpdate));\r\n    }\r\n\r\n    allRounds?.splice((currentRound as number) - 1, 1, newRound);\r\n\r\n    gameToUpdate.rounds = allRounds;\r\n\r\n    this.gameRef?.update(gameToUpdate);\r\n  }\r\n\r\n  private updateOwnCardState(\r\n    thrownCard: string,\r\n    currentRound: number,\r\n    ownCardsState: string[] = []\r\n  ) {\r\n    const cardIndex = Object.keys(ownCardsState).find(\r\n      (index) => ownCardsState[+index] === thrownCard\r\n    );\r\n    GameService.updateHandCardsState(this.gameKey, currentRound, cardIndex);\r\n  }\r\n}\r\n\r\nexport default GameTab;\r\n","import React from 'react';\nimport { Spin } from 'antd';\n\ninterface ILoaderProps {\n  className?: string;\n}\n\nconst Loader = (props: ILoaderProps) => (\n  <div className={`full-view loader ${props.className ? props.className : ''}`}>\n    <Spin\n      size=\"large\"\n      style={{ width: '100%', position: 'relative', top: '50%' }}\n    />\n  </div>\n);\n\nexport default Loader;\n","import React, { Component } from 'react';\r\nimport { fire } from '../firebase';\r\nimport './LeagueSummary.css';\r\nimport { Row, Col } from 'antd';\r\n\r\nconst statsObj = {\r\n  successRate: 'Succes Win Rates',\r\n  successRateHB: 'Highest Bidding Win Rates',\r\n  successRateOver: 'Over Win Rate',\r\n  successRateUnder: 'Under Win Rate',\r\n  successRateNT: 'NT Win Rates',\r\n  successRateLastBidder: 'Last Bidder Win Rate',\r\n};\r\n\r\nexport default class LeagueSummary extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      players: props.league.players,\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.gameSummaryRef.off('value');\r\n  }\r\n\r\n  fetch() {\r\n    const {\r\n      league: { leagueID },\r\n    } = this.props;\r\n    const { players } = this.state;\r\n\r\n    const dbRef = fire.database().ref();\r\n    this.gameSummaryRef = dbRef.child(`leagueGamesSummary/_${leagueID}`);\r\n    this.leagueGamesRef = dbRef\r\n      .child(`leagueGames/_${leagueID}`)\r\n      .orderByChild('status')\r\n      .equalTo('FINISHED');\r\n\r\n    this.leagueGamesRef.on('value', (snap) => {\r\n      if (snap.val()) {\r\n        const gameKeys = Object.keys(snap.val());\r\n        const lastKey = gameKeys[gameKeys.length - 1];\r\n\r\n        this.gameSummaryRef\r\n          .orderByKey()\r\n          .endAt(lastKey)\r\n          .on('value', (snap) => {\r\n            const gameSummary = Object.values(snap.val());\r\n            this.setState({\r\n              players: players.map((player) => {\r\n                const playerKey = player.key;\r\n\r\n                return {\r\n                  ...player,\r\n                  games: gameSummary.map((game, i) => game.players[playerKey]),\r\n                };\r\n              }),\r\n            });\r\n          });\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { league } = this.props;\r\n    const { title } = league;\r\n    const { players } = this.state;\r\n\r\n    return (\r\n      <div className=\"game-summery\">\r\n        <h3>{title}</h3>\r\n\r\n        <h3>League Score:</h3>\r\n        <Row gutter={1} className=\"table-header\" style={{ marginBottom: 1 }}>\r\n          {this.getTableHeaders(players)}\r\n        </Row>\r\n        <Row gutter={1}>{this.getScoreRow(players)}</Row>\r\n        {Object.keys(statsObj).map(this.getStatsRow)}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  getTableHeaders = (players) =>\r\n    players.map(({ key, nickname }) => (\r\n      <Col key={key} span={6}>\r\n        <div className=\"table-cell\">{nickname}</div>\r\n      </Col>\r\n    ));\r\n\r\n  getScoreRow = (players) =>\r\n    players.map((player) => (\r\n      <Col span={6} key={player.key}>\r\n        <div className=\"table-cell\">\r\n          {player.games && this.scoreReducer(player.games, 'leagueScore')}\r\n        </div>\r\n      </Col>\r\n    ));\r\n\r\n  getStatsRow = (statsKey) => {\r\n    const { players } = this.state;\r\n\r\n    return (\r\n      <div className=\"stats-row\" key={statsKey}>\r\n        <h4>{statsObj[statsKey]}</h4>\r\n        <Row gutter={1}>{this.getWinRateRow(players, statsKey)}</Row>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  getWinRateRow = (players, statsKey) =>\r\n    players.map((player) => (\r\n      <Col span={6} key={player.key}>\r\n        <div className=\"table-cell\">\r\n          {player.games && this.calculateRate(player.games, statsKey)}%\r\n        </div>\r\n      </Col>\r\n    ));\r\n\r\n  scoreReducer = (games, prop) =>\r\n    games.reduce((sum, game) => sum + Number(game[prop]), 0);\r\n\r\n  calculateRate = (games, prop) =>\r\n    this.toPercentage(this.preCalculateRate(games, prop));\r\n\r\n  toPercentage = ({ wins, total }) =>\r\n    Number.parseFloat((wins / total) * 100).toFixed(0);\r\n\r\n  preCalculateRate = (games, prop) =>\r\n    games.reduce(\r\n      (sumObj, game) => {\r\n        const category = game[prop];\r\n        sumObj.wins += category.wins;\r\n        sumObj.total += category.total;\r\n        return sumObj;\r\n      },\r\n      { wins: 0, total: 0 }\r\n    );\r\n}\r\n","import { fire } from '../firebase';\r\nimport { ILeagueModel } from '../models/ILeagueModel';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\ninterface IInvited {\r\n  [userID: string]: string;\r\n}\r\n\r\nexport interface IGameInvite {\r\n  inviteKey: string;\r\n  leagueID: number;\r\n  leagueTitle: string;\r\n  newGameId: number;\r\n  inviter: IPlayer;\r\n}\r\n\r\ninterface IInviteObj {\r\n  invited: IInvited;\r\n  invite: IGameInvite;\r\n}\r\n\r\nexport default class LeagueService {\r\n  public static invitePlayers(\r\n    league: Partial<ILeagueModel>,\r\n    newGameId: number\r\n  ): Promise<boolean> {\r\n    // TODO: add reject when after a xxx seconds with not enough joined players\r\n    // TODO: upgrade the promise to allow cancel\r\n    return new Promise<boolean>((resolve) => {\r\n      // create firebase ref to notification/gameInvites\r\n      const gameInvitesRef = fire\r\n        .database()\r\n        .ref()\r\n        .child('notifications/gameInvites');\r\n\r\n      // generate new key\r\n      const inviteKey = gameInvitesRef.push().key;\r\n      const { invited, invite } = LeagueService.setInviteObj(\r\n        league,\r\n        inviteKey as string,\r\n        newGameId\r\n      );\r\n\r\n      // update the invantation and invited list\r\n      const update = {\r\n        [`${inviteKey}`]: invite,\r\n      };\r\n\r\n      gameInvitesRef\r\n        .update(update)\r\n        .then(() => LeagueService.setAllInvited(invited, gameInvitesRef))\r\n        .then((invitedRefs) => {\r\n          // setTimeout(() => {\r\n          //   gameInvitesRef\r\n          //     .child(`${inviteKey}/joinedPlayers`)\r\n          //     .push('QVU5a8IMtPZkqo76vgRAvErZ3pm2');\r\n          // }, 2000);\r\n          // setTimeout(() => {\r\n          //   gameInvitesRef\r\n          //     .child(`${inviteKey}/joinedPlayers`)\r\n          //     .push('6fosZWZDV5g0yB7Js8IQhk3ADHh2');\r\n          // }, 2500);\r\n\r\n          const playersKeys = Object.keys(invited);\r\n\r\n          // listen to changes in the invantation (joinedPlayers)\r\n          gameInvitesRef\r\n            .child(`${inviteKey}/joinedPlayers`)\r\n            .on('child_added', (player: firebase.database.DataSnapshot) => {\r\n              console.log(player.val());\r\n              // resolve when all players joined\r\n              const index = playersKeys.indexOf(player.val());\r\n\r\n              if (index > -1) {\r\n                playersKeys.splice(index, 1);\r\n              }\r\n\r\n              console.log(playersKeys);\r\n\r\n              if (!playersKeys.length) {\r\n                gameInvitesRef\r\n                  .child(`${inviteKey}/joinedPlayers`)\r\n                  .off('child_added');\r\n\r\n                LeagueService.removeAllInvited(invitedRefs);\r\n                resolve();\r\n              }\r\n            });\r\n        });\r\n    });\r\n  }\r\n\r\n  public static setInviteObj(\r\n    league: Partial<ILeagueModel>,\r\n    inviteKey: string,\r\n    newGameId: number\r\n  ): IInviteObj {\r\n    const { players, leagueID, title } = league;\r\n    const userId = fire.auth().currentUser?.uid;\r\n    const inviter = players?.find((player) => player.key === userId) as IPlayer;\r\n    const invited = (players as IPlayer[])\r\n      .filter((player) => player.key !== userId)\r\n      .reduce((invited, player) => {\r\n        invited[player.key] = inviteKey;\r\n\r\n        return invited;\r\n      }, {} as IInvited);\r\n\r\n    return {\r\n      invited,\r\n      invite: {\r\n        inviter,\r\n        inviteKey,\r\n        leagueID: leagueID as number,\r\n        leagueTitle: title as string,\r\n        newGameId,\r\n      },\r\n    };\r\n  }\r\n\r\n  public static setAllInvited(\r\n    invited: IInvited,\r\n    gameInvitesRef: firebase.database.Reference\r\n  ): Promise<firebase.database.Reference[]> {\r\n    const sets: Promise<firebase.database.Reference>[] = [];\r\n\r\n    Object.keys(invited).forEach((playerKey) => {\r\n      const promise = gameInvitesRef\r\n        .child(`invitedPlayers/${playerKey}`)\r\n        .push(invited[playerKey]);\r\n\r\n      sets.push(promise);\r\n    });\r\n\r\n    return Promise.all(sets);\r\n  }\r\n\r\n  public static removeAllInvited(invitedRefs: firebase.database.Reference[]) {\r\n    invitedRefs.forEach((ref: firebase.database.Reference) => {\r\n      ref.set(null);\r\n    });\r\n  }\r\n\r\n  public static acceptGameInvite(invite: IGameInvite): Promise<any> {\r\n    const { inviteKey } = invite;\r\n    const gameInviteRef = fire\r\n      .database()\r\n      .ref()\r\n      .child(`notifications/gameInvites/${inviteKey}/joinedPlayers`);\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    // TODO: listen also if game was added before resolve,\r\n    // otherwise the navigation to the new game is before the game is actually created\r\n    return new Promise((resolve) => {\r\n      gameInviteRef.push(userId).then(() => {\r\n        gameInviteRef.on('value', (snap) => {\r\n          if (Object.values(snap.val()).length === 3) {\r\n            gameInviteRef.off('value');\r\n            resolve();\r\n          }\r\n        });\r\n      });\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport { fire } from '../firebase';\r\nimport { Route, Link, RouteComponentProps } from 'react-router-dom';\r\nimport withAuthorization from '../authentication/withAuthorization';\r\nimport { Menu, Layout, message } from 'antd';\r\nimport {\r\n  DashboardOutlined,\r\n  GoldOutlined,\r\n  ExportOutlined,\r\n  PlusOutlined,\r\n} from '@ant-design/icons';\r\nimport './League.scss';\r\nimport GameTab from '../game/GameTab';\r\nimport * as routes from '../constants/routes';\r\nimport gameDataTpl from '../dataTemplates/gameTpl';\r\nimport RcDrawer from 'rc-drawer';\r\nimport 'rc-drawer/assets/index.css';\r\nimport Loader from '../common/loader/Loader';\r\nimport LeagueSummary from '../leagueSummary/LeagueSummary';\r\nimport Dialog from '../dialogs/Dialog';\r\nimport { Dialogs } from '../constants/dialogs';\r\nimport { ILeagueModel } from '../models/ILeagueModel';\r\nimport { MenuInfo } from 'rc-menu/lib/interface';\r\nimport { GameMode, GAME_STATUS } from '../models/IGameModel';\r\nimport { UserContext } from '../authentication/AuthUserContext';\r\nimport LeagueService from '../services/LeagueSrv';\r\nimport { shufflePlayers } from '../utils/game-utils';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\n\r\nconst { Content } = Layout;\r\nconst SubMenu = Menu.SubMenu;\r\n\r\nexport interface ILeagueState {\r\n  loading: boolean;\r\n  menuSelected: string | 'dashboard';\r\n  league: Partial<ILeagueModel>;\r\n  leagueGames: Array<any>;\r\n  drawerVisible: boolean;\r\n  newGameDialog: boolean;\r\n}\r\n\r\ntype TParams = { leagueID?: string };\r\n\r\nexport interface ILeagueProps extends RouteComponentProps<TParams> {}\r\n\r\nclass League extends React.Component<ILeagueProps, ILeagueState> {\r\n  private leagueRef: firebase.database.Reference;\r\n  private leagueGamesRef: firebase.database.Reference;\r\n\r\n  constructor(props: ILeagueProps) {\r\n    super(props);\r\n\r\n    const { location, match } = props;\r\n    const { leagueID } = match.params;\r\n\r\n    const matchGame = location.pathname.match(/game\\/[1-9]/g) || [];\r\n    const gameID = matchGame.length ? matchGame[0].split('/')[1] : false;\r\n\r\n    this.state = {\r\n      loading: false,\r\n      menuSelected: gameID || 'dashboard',\r\n      league: { title: '', players: [] },\r\n      leagueGames: [],\r\n      drawerVisible: false,\r\n      newGameDialog: false,\r\n      // activeGame: `0`\r\n    };\r\n\r\n    /* Create reference to messages in Firebase Database */\r\n    const dbRef = fire.database().ref();\r\n    this.leagueRef = dbRef.child(`leagues/list/_${leagueID}`);\r\n    this.leagueGamesRef = dbRef.child(`leagueGames/_${leagueID}`);\r\n\r\n    this.handleMenuItemClick = this.handleMenuItemClick.bind(this);\r\n    this.newGameDialogHandler = this.newGameDialogHandler.bind(this);\r\n  }\r\n\r\n  public componentDidMount() {\r\n    this.fetch();\r\n  }\r\n\r\n  public componentWillUnmount() {\r\n    this.leagueRef.off('value');\r\n  }\r\n\r\n  private fetch() {\r\n    this.setState({ loading: true });\r\n    this.leagueRef.on('value', (snapshot) => {\r\n      const leagueData: ILeagueModel = snapshot.val();\r\n      console.log(leagueData);\r\n      if (leagueData) {\r\n        this.setState({\r\n          league: {\r\n            ...this.state.league,\r\n            ...leagueData,\r\n          },\r\n          loading: false,\r\n        });\r\n      }\r\n    });\r\n\r\n    this.leagueGamesRef.on('child_added', (snapshot) => {\r\n      this.setState((prevState) => {\r\n        return { leagueGames: [...prevState.leagueGames, snapshot.val()] };\r\n      });\r\n    });\r\n\r\n    this.leagueGamesRef.on('child_changed', (snapshot) => {\r\n      console.log('child_changed', snapshot.val());\r\n      this.setState((prevState) => {\r\n        const leagueGames = prevState.leagueGames;\r\n        const changedIndex = leagueGames.findIndex(\r\n          (game) => game.gameID === snapshot.val().gameID\r\n        );\r\n\r\n        return {\r\n          leagueGames: [\r\n            ...leagueGames.slice(0, changedIndex),\r\n            {\r\n              ...snapshot.val(),\r\n            },\r\n            ...leagueGames.slice(changedIndex + 1),\r\n          ],\r\n        };\r\n      });\r\n    });\r\n  }\r\n\r\n  public render() {\r\n    const { match } = this.props;\r\n    const { league, loading, drawerVisible } = this.state;\r\n    const { leagueID, players } = league;\r\n\r\n    return (\r\n      <Layout className=\"league-container\">\r\n        <RcDrawer\r\n          getContainer=\".app\"\r\n          width=\"250px\"\r\n          open={drawerVisible}\r\n          onHandleClick={this.toggleDrawer}\r\n          onClose={this.toggleDrawer}\r\n        >\r\n          <div className=\"drawer-title\">{league.title}</div>\r\n          {this.getMenu()}\r\n        </RcDrawer>\r\n        {loading && <Loader className=\"with-mask\" />}\r\n        <Layout>\r\n          <Content>\r\n            <Route\r\n              path={`${routes.LEAGUE}/:leagueID/game/:gameID`}\r\n              render={(props) =>\r\n                !!leagueID ? (\r\n                  <GameTab\r\n                    {...props}\r\n                    players={players as IPlayer[]}\r\n                    // loading={loading}\r\n                    loaderStateCb={this.setLoaderState}\r\n                  />\r\n                ) : (\r\n                  <Loader />\r\n                )\r\n              }\r\n            />\r\n            <Route\r\n              exact\r\n              path={match.url}\r\n              render={(props) =>\r\n                !!leagueID ? (\r\n                  <LeagueSummary {...props} league={league} />\r\n                ) : (\r\n                  <Loader />\r\n                )\r\n              }\r\n            />\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  private getMenu() {\r\n    const { match } = this.props;\r\n    const { leagueGames, menuSelected, newGameDialog } = this.state;\r\n\r\n    return (\r\n      <Menu\r\n        mode=\"inline\"\r\n        selectedKeys={[menuSelected]}\r\n        defaultOpenKeys={['gamesSub']}\r\n        onClick={this.handleMenuItemClick}\r\n        className=\"league-menu\"\r\n      >\r\n        <Menu.Item key=\"dashboard\">\r\n          <DashboardOutlined />\r\n          <Link to={`${match.url}`}>League Summary</Link>\r\n        </Menu.Item>\r\n        <SubMenu\r\n          key=\"gamesSub\"\r\n          title={\r\n            <span>\r\n              <GoldOutlined />\r\n              <span>Games</span>\r\n            </span>\r\n          }\r\n        >\r\n          {leagueGames.map((game, i) => (\r\n            <Menu.Item key={game.gameID.toString()}>\r\n              <Link to={`${match.url}${routes.GAME}/${game.gameID}`}>\r\n                Game {game.gameID}\r\n              </Link>\r\n            </Menu.Item>\r\n          ))}\r\n\r\n          <Menu.Item key=\"new_game\">\r\n            <PlusOutlined />\r\n            <span>New Game</span>\r\n          </Menu.Item>\r\n        </SubMenu>\r\n        {newGameDialog && (\r\n          <Dialog\r\n            dialog={Dialogs.NEW_GAME}\r\n            dialogProps={{\r\n              visible: true,\r\n              onAfterClose: this.newGameDialogHandler,\r\n            }}\r\n          />\r\n        )}\r\n        <Menu.Item key=\"main_menu\">\r\n          <ExportOutlined className={'rotate-180'} />\r\n          <Link to={`/`}>To Main Menu</Link>\r\n        </Menu.Item>\r\n      </Menu>\r\n    );\r\n  }\r\n\r\n  private toggleDrawer = () => {\r\n    this.setState({\r\n      drawerVisible: !this.state.drawerVisible,\r\n    });\r\n  };\r\n\r\n  private setLoaderState = (loading: boolean) => {\r\n    this.setState({ loading });\r\n  };\r\n\r\n  private handleMenuItemClick(item: MenuInfo): void {\r\n    const key = item.key;\r\n\r\n    if (key === 'new_game') {\r\n      if (this.isAddGameOk()) {\r\n        // trying to block the leauge database by adding to the league blockedBy attribute value with the user Id\r\n        // together with the database rules preventing other user from updating the league data\r\n        this.blockLeague().then(\r\n          () => {\r\n            this.setNewGameDialogState(true);\r\n          },\r\n          (error: Error | null) => {\r\n            console.error(error);\r\n            message.warning('One of the players is blocking!!');\r\n          }\r\n        );\r\n      } else {\r\n        message.warning('Last Game is not finished yet!!');\r\n      }\r\n    } else if (key !== 'main_menu' && key !== this.state.menuSelected) {\r\n      this.setState({ menuSelected: key });\r\n    }\r\n\r\n    setTimeout(this.toggleDrawer, 200);\r\n  }\r\n\r\n  private blockLeague() {\r\n    const userId = fire.auth().currentUser?.uid;\r\n\r\n    return this.leagueRef.child('blockedBy').set(userId);\r\n  }\r\n\r\n  private unblockLeague() {\r\n    this.leagueRef.update({\r\n      blockedBy: null,\r\n    });\r\n  }\r\n\r\n  private setNewGameDialogState = (show: boolean) => {\r\n    this.setState({\r\n      newGameDialog: show,\r\n    });\r\n  };\r\n\r\n  private newGameDialogHandler(gameMode: GameMode) {\r\n    this.setState({\r\n      newGameDialog: false,\r\n    });\r\n\r\n    if (gameMode === 'local') {\r\n      this.unblockLeague();\r\n      this.addGame(gameMode);\r\n    } else if (gameMode === 'remote') {\r\n      this.setState({ loading: true });\r\n      // ask other players to join the game\r\n      const { league, leagueGames } = this.state;\r\n      const newGameId = leagueGames.length + 1;\r\n\r\n      LeagueService.invitePlayers({ ...league }, newGameId).then(() => {\r\n        console.log('inventation resolved- ok to add game');\r\n        this.addGame('remote');\r\n        this.setState({ loading: false });\r\n      });\r\n    }\r\n  }\r\n\r\n  private addGame = (gameMode: GameMode) => {\r\n    const { league, leagueGames } = this.state;\r\n    const { leagueID, players, blockedBy } = league;\r\n\r\n    const { history, match } = this.props;\r\n    const newGameId = leagueGames.length + 1;\r\n\r\n    const newGameKey = fire.database().ref().child('games').push().key;\r\n\r\n    const gameTpl = gameDataTpl(players as IPlayer[], gameMode);\r\n    const updates: { [key: string]: any } = {};\r\n\r\n    updates[`/games/${newGameKey}`] = {\r\n      gameID: newGameId,\r\n      dealer: gameMode === 'remote' && blockedBy ? blockedBy : '',\r\n      ...gameTpl.gameData,\r\n    };\r\n    updates[`/leagueGames/_${leagueID}/${newGameKey}`] = {\r\n      gameID: newGameId,\r\n      gameMode,\r\n      playersOrder: this.addGamePlayers(gameMode, players),\r\n      status: GAME_STATUS.ACTIVE,\r\n    };\r\n    updates[`/leagueGamesSummary/_${leagueID}/${newGameKey}`] = {\r\n      ...gameTpl.gameSummary,\r\n    };\r\n\r\n    fire\r\n      .database()\r\n      .ref()\r\n      .update(updates, (error) => {\r\n        if (!error) {\r\n          this.setState({ menuSelected: `${newGameId}` });\r\n          history.push(`${match.url}${routes.GAME}/${newGameId}`);\r\n        }\r\n      });\r\n  };\r\n\r\n  private addGamePlayers(gameMode: GameMode, players?: IPlayer[]) {\r\n    return players && gameMode === 'remote' ? shufflePlayers(players) : null;\r\n  }\r\n\r\n  private isAddGameOk() {\r\n    const { leagueGames } = this.state;\r\n    const lastGame = leagueGames[leagueGames.length - 1];\r\n\r\n    return !lastGame || lastGame.status === GAME_STATUS.FINISHED;\r\n  }\r\n}\r\n\r\nconst authCondition = (authUser: UserContext) => !!authUser;\r\n\r\nexport default withAuthorization<ILeagueProps>(authCondition)(League);\r\n","import { INPUT_MODE } from '../constants/states';\r\nimport {\r\n  GameMode,\r\n  GAME_STATUS,\r\n  IRoundData,\r\n  IBaseRoundData,\r\n  IGamePlayersSummary,\r\n} from '../models/IGameModel';\r\nimport { IPlayer } from '../models/IPlayerModel';\r\nimport { IGameDataTpl } from '../models/ILeagueModel';\r\n\r\nexport default function gameDataTpl(\r\n  players: IPlayer[],\r\n  gameMode: GameMode\r\n): IGameDataTpl {\r\n  const rounds: IRoundData[] = [];\r\n  const initRoundData: IBaseRoundData = {\r\n    segment: '',\r\n    totalBids: '',\r\n    trump: '',\r\n    check: false,\r\n    factor: 1,\r\n    fell: false,\r\n    highestBidder: '',\r\n    inputMode: INPUT_MODE.BID,\r\n    score0: '',\r\n    aggregateScore0: '',\r\n    bid0: '',\r\n    won0: '',\r\n    score1: '',\r\n    aggregateScore1: '',\r\n    bid1: '',\r\n    won1: '',\r\n    score2: '',\r\n    aggregateScore2: '',\r\n    bid2: '',\r\n    won2: '',\r\n    score3: '',\r\n    aggregateScore3: '',\r\n    bid3: '',\r\n    won3: '',\r\n  };\r\n\r\n  if (gameMode === 'remote') {\r\n    initRoundData.currentHand = 1;\r\n  }\r\n\r\n  for (let i = 0; i < 13; i++) {\r\n    rounds.push({ round: i + 1, ...initRoundData });\r\n  }\r\n\r\n  const rateInit = {\r\n    wins: 0,\r\n    total: 0,\r\n  };\r\n\r\n  return {\r\n    gameData: {\r\n      rounds,\r\n      currentRound: 1,\r\n      totalScore0: 0,\r\n      totalScore1: 0,\r\n      totalScore2: 0,\r\n      totalScore3: 0,\r\n      status: GAME_STATUS.ACTIVE,\r\n    },\r\n    gameSummary: {\r\n      players: players.reduce((summaryObj: IGamePlayersSummary, player) => {\r\n        summaryObj[player.key] = {\r\n          leagueScore: 0,\r\n          successRate: rateInit,\r\n          successRateHB: rateInit,\r\n          successRateOver: rateInit,\r\n          successRateUnder: rateInit,\r\n          successRateNT: rateInit,\r\n          successRateLastBidder: rateInit,\r\n        };\r\n\r\n        return summaryObj;\r\n      }, {}),\r\n    },\r\n  };\r\n}\r\n","import React, { Component } from 'react';\r\nimport { withRouter, Route, RouteComponentProps } from 'react-router-dom';\r\nimport NotificationService from './services/NotificationSrv';\r\nimport { fire } from './firebase';\r\nimport cards from './cards.png';\r\nimport phoneImg from './images/phone.png';\r\nimport * as routes from './constants/routes';\r\nimport withAuthentication from './authentication/withAuthentication';\r\nimport './App.scss';\r\nimport 'antd/dist/antd.css';\r\nimport Login from './authentication/Login';\r\nimport SignUp from './authentication/SignUp';\r\nimport Main from './main/Main';\r\nimport League from './league/League';\r\nimport { isMobileBrowser } from './utils/Utils';\r\nimport { Dialogs } from './constants/dialogs';\r\nimport Dialog from './dialogs/Dialog';\r\nimport LeagueService, { IGameInvite } from './services/LeagueSrv';\r\nimport Loader from './common/loader/Loader';\r\n\r\ninterface IAppProps extends RouteComponentProps {}\r\n\r\ninterface IAppState {\r\n  inlineHeader: boolean;\r\n  showGameInvite: boolean;\r\n  loader: boolean;\r\n  invite?: IGameInvite;\r\n}\r\n\r\nclass App extends Component<IAppProps, IAppState> {\r\n  private unlistenHistory: () => void;\r\n\r\n  constructor(props: IAppProps) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      inlineHeader: false,\r\n      showGameInvite: false,\r\n      loader: false,\r\n    };\r\n\r\n    this.toggleHeaderInline = this.toggleHeaderInline.bind(this);\r\n  }\r\n\r\n  // set main header state by router value\r\n  // if in main menu page header is bigger\r\n  toggleHeaderInline(inline = true) {\r\n    this.setState({\r\n      inlineHeader: inline,\r\n    });\r\n  }\r\n\r\n  componentWillMount() {\r\n    const { pathname } = this.props.location;\r\n    // set initial header state\r\n    this.toggleHeaderInline(pathname !== '/');\r\n\r\n    // listen to routing changes\r\n    this.unlistenHistory = this.props.history.listen((location, action) => {\r\n      const { pathname } = location;\r\n      this.toggleHeaderInline(pathname !== '/' && pathname !== '/login');\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.unlistenHistory();\r\n  }\r\n\r\n  componentDidMount() {\r\n    fire.auth().onAuthStateChanged((authUser) => {\r\n      if (authUser) {\r\n        NotificationService.registerGameInvite(this.onGameInvite);\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    const { inlineHeader, showGameInvite, invite, loader } = this.state;\r\n\r\n    return (\r\n      <div\r\n        className={`app-wrapper ${\r\n          isMobileBrowser() ? 'mobile-mode' : 'desktop-mode'\r\n        }`}\r\n      >\r\n        <img src={phoneImg} alt=\"\"/>\r\n        <div className={`app ${inlineHeader ? 'inline-header' : ''}`}>\r\n          <header id=\"app-header\">\r\n            <img src={cards} className=\"app-logo\" alt=\"logo\" />\r\n            <h1 className=\"app-title\">Sub Whist</h1>\r\n          </header>\r\n          {loader && <Loader className=\"with-mask\" />}\r\n          <div className=\"app-content\">\r\n            <Route exact path=\"/\" component={Main} />\r\n            <Route exact path={routes.SIGN_IN} component={Login} />\r\n            <Route exact path={routes.SIGN_UP} component={SignUp} />\r\n            <Route\r\n              path={`${routes.LEAGUE}/:leagueID`}\r\n              render={(props) => <League {...props} />}\r\n            />\r\n          </div>\r\n        </div>\r\n        {showGameInvite && (\r\n          <Dialog\r\n            dialog={Dialogs.GAME_INVITE}\r\n            dialogProps={{\r\n              visible: true,\r\n              invite,\r\n              onAfterClose: this.closeGameInvite,\r\n              onOk: this.acceptGameInvite,\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  onGameInvite = (invite: IGameInvite) => {\r\n    this.setState({\r\n      showGameInvite: true,\r\n      invite,\r\n    });\r\n  };\r\n\r\n  acceptGameInvite = () => {\r\n    const { invite } = this.state;\r\n\r\n    this.setState({ loader: true });\r\n    invite && LeagueService.acceptGameInvite(invite).then(\r\n      () => {\r\n        this.setState({ loader: false });\r\n        const { history } = this.props;\r\n        const { leagueID, newGameId } = invite;\r\n\r\n        setTimeout(\r\n          () => history.push(`${routes.LEAGUE}/${leagueID}/game/${newGameId}`),\r\n          500\r\n        );\r\n      },\r\n      () => {\r\n        this.setState({ loader: false });\r\n      }\r\n    );\r\n  };\r\n\r\n  closeGameInvite = () => {\r\n    this.setState({\r\n      showGameInvite: false,\r\n    });\r\n  };\r\n}\r\n\r\nexport default withRouter(withAuthentication(App));\r\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"pure-swipe\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\n\nimport \"./index.scss\";\n\nReactDOM.render(\n  <Router basename={process.env.PUBLIC_URL}>\n    <App />\n  </Router>,\n  document.getElementById(\"root\")\n);\nregisterServiceWorker();\n"],"sourceRoot":""}