(this.webpackJsonpwhist=this.webpackJsonpwhist||[]).push([[0],{185:function(e,t,a){},213:function(e,t,a){var n={"./10-C.svg":452,"./10-D.svg":453,"./10-H.svg":454,"./10-S.svg":455,"./11-C.svg":456,"./11-D.svg":457,"./11-H.svg":458,"./11-S.svg":459,"./12-C.svg":460,"./12-D.svg":461,"./12-H.svg":462,"./12-S.svg":463,"./13-C.svg":464,"./13-D.svg":465,"./13-H.svg":466,"./13-S.svg":467,"./14-C.svg":468,"./14-D.svg":469,"./14-H.svg":470,"./14-S.svg":471,"./2-C.svg":472,"./2-D.svg":473,"./2-H.svg":474,"./2-J.svg":475,"./2-S.svg":476,"./3-C.svg":477,"./3-D.svg":478,"./3-H.svg":479,"./3-S.svg":480,"./4-C.svg":481,"./4-D.svg":482,"./4-H.svg":483,"./4-S.svg":484,"./5-C.svg":485,"./5-D.svg":486,"./5-H.svg":487,"./5-S.svg":488,"./6-C.svg":489,"./6-D.svg":490,"./6-H.svg":491,"./6-S.svg":492,"./7-C.svg":493,"./7-D.svg":494,"./7-H.svg":495,"./7-S.svg":496,"./8-C.svg":497,"./8-D.svg":498,"./8-H.svg":499,"./8-S.svg":500,"./9-C.svg":501,"./9-D.svg":502,"./9-H.svg":503,"./9-S.svg":504};function r(e){var t=o(e);return a(t)}function o(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=o,e.exports=r,r.id=213},214:function(e,t,a){e.exports=a.p+"static/media/cards.03003d3d.png"},215:function(e,t,a){e.exports=a.p+"static/media/phone.b4836590.png"},241:function(e,t,a){e.exports=a(514)},251:function(e,t,a){},416:function(e,t,a){},431:function(e,t,a){},432:function(e,t,a){},438:function(e,t,a){},439:function(e,t,a){},446:function(e,t,a){},447:function(e,t,a){},448:function(e,t,a){},449:function(e,t,a){},450:function(e,t,a){},451:function(e,t,a){},452:function(e,t,a){e.exports=a.p+"static/media/10-C.90a1d2da.svg"},453:function(e,t,a){e.exports=a.p+"static/media/10-D.1e7ceb93.svg"},454:function(e,t,a){e.exports=a.p+"static/media/10-H.a99c411d.svg"},455:function(e,t,a){e.exports=a.p+"static/media/10-S.8b991ebd.svg"},456:function(e,t,a){e.exports=a.p+"static/media/11-C.e4d58ae7.svg"},457:function(e,t,a){e.exports=a.p+"static/media/11-D.b2cc7b26.svg"},458:function(e,t,a){e.exports=a.p+"static/media/11-H.c357eab3.svg"},459:function(e,t,a){e.exports=a.p+"static/media/11-S.e9f02fbd.svg"},460:function(e,t,a){e.exports=a.p+"static/media/12-C.483c9a18.svg"},461:function(e,t,a){e.exports=a.p+"static/media/12-D.e34fab0b.svg"},462:function(e,t,a){e.exports=a.p+"static/media/12-H.ddc0d874.svg"},463:function(e,t,a){e.exports=a.p+"static/media/12-S.84f4e7a8.svg"},464:function(e,t,a){e.exports=a.p+"static/media/13-C.f612b546.svg"},465:function(e,t,a){e.exports=a.p+"static/media/13-D.0ff22a04.svg"},466:function(e,t,a){e.exports=a.p+"static/media/13-H.60e7d399.svg"},467:function(e,t,a){e.exports=a.p+"static/media/13-S.22bb59a1.svg"},468:function(e,t,a){e.exports=a.p+"static/media/14-C.49a458de.svg"},469:function(e,t,a){e.exports=a.p+"static/media/14-D.3fde324e.svg"},470:function(e,t,a){e.exports=a.p+"static/media/14-H.e892e743.svg"},471:function(e,t,a){e.exports=a.p+"static/media/14-S.78374225.svg"},472:function(e,t,a){e.exports=a.p+"static/media/2-C.8a51f4b1.svg"},473:function(e,t,a){e.exports=a.p+"static/media/2-D.dd5bdb07.svg"},474:function(e,t,a){e.exports=a.p+"static/media/2-H.15c2e192.svg"},475:function(e,t,a){e.exports=a.p+"static/media/2-J.2efb9493.svg"},476:function(e,t,a){e.exports=a.p+"static/media/2-S.bce46c7b.svg"},477:function(e,t,a){e.exports=a.p+"static/media/3-C.6f681593.svg"},478:function(e,t,a){e.exports=a.p+"static/media/3-D.15244443.svg"},479:function(e,t,a){e.exports=a.p+"static/media/3-H.5d6c501c.svg"},480:function(e,t,a){e.exports=a.p+"static/media/3-S.56340b99.svg"},481:function(e,t,a){e.exports=a.p+"static/media/4-C.b4c5fedb.svg"},482:function(e,t,a){e.exports=a.p+"static/media/4-D.c1449960.svg"},483:function(e,t,a){e.exports=a.p+"static/media/4-H.a23231b3.svg"},484:function(e,t,a){e.exports=a.p+"static/media/4-S.10c84208.svg"},485:function(e,t,a){e.exports=a.p+"static/media/5-C.0eb86f9c.svg"},486:function(e,t,a){e.exports=a.p+"static/media/5-D.152f12ae.svg"},487:function(e,t,a){e.exports=a.p+"static/media/5-H.8196387a.svg"},488:function(e,t,a){e.exports=a.p+"static/media/5-S.143b7322.svg"},489:function(e,t,a){e.exports=a.p+"static/media/6-C.4cb8bdad.svg"},490:function(e,t,a){e.exports=a.p+"static/media/6-D.bd92854e.svg"},491:function(e,t,a){e.exports=a.p+"static/media/6-H.19f2ecf2.svg"},492:function(e,t,a){e.exports=a.p+"static/media/6-S.ade7c7e4.svg"},493:function(e,t,a){e.exports=a.p+"static/media/7-C.d8d8520b.svg"},494:function(e,t,a){e.exports=a.p+"static/media/7-D.204f8d6f.svg"},495:function(e,t,a){e.exports=a.p+"static/media/7-H.f0681bb0.svg"},496:function(e,t,a){e.exports=a.p+"static/media/7-S.f6bb3b39.svg"},497:function(e,t,a){e.exports=a.p+"static/media/8-C.fe3de886.svg"},498:function(e,t,a){e.exports=a.p+"static/media/8-D.b6635e40.svg"},499:function(e,t,a){e.exports=a.p+"static/media/8-H.eac2a810.svg"},500:function(e,t,a){e.exports=a.p+"static/media/8-S.6e2329eb.svg"},501:function(e,t,a){e.exports=a.p+"static/media/9-C.a91a0922.svg"},502:function(e,t,a){e.exports=a.p+"static/media/9-D.2c4bfcfc.svg"},503:function(e,t,a){e.exports=a.p+"static/media/9-H.75cb4cf1.svg"},504:function(e,t,a){e.exports=a.p+"static/media/9-S.30d03378.svg"},505:function(e,t,a){},510:function(e,t,a){},513:function(e,t,a){},514:function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"createUser",(function(){return E})),a.d(n,"signInUser",(function(){return S})),a.d(n,"signOut",(function(){return w}));var r={};a.r(r),a.d(r,"doCreateUser",(function(){return C})),a.d(r,"onceGetUsers",(function(){return O})),a.d(r,"onceGetLeagues",(function(){return k}));var o=a(0),c=a.n(o),i=a(5),s=a.n(i),l=(a(246),a(3)),u=a(4),d=a(16),m=a(7),h=a(8),f=a(71),g=a(142),p=a.n(g),v=(a(247),a(249),p.a.initializeApp({apiKey:"AIzaSyCBrRBBfQTCAF5rqj_A8fXN4jMZlZ310RM",authDomain:"whist-d4d9b.firebaseapp.com",databaseURL:"https://whist-d4d9b.firebaseio.com",projectId:"whist-d4d9b",storageBucket:"whist-d4d9b.appspot.com",messagingSenderId:"630677405872"})),b=p.a.auth(),y=p.a.database(),E=function(e,t){return b.createUserWithEmailAndPassword(e,t)},S=function(e,t){return b.signInWithEmailAndPassword(e,t)},w=function(){return b.signOut()},C=function(e,t){return y.ref("users/".concat(e)).set(t)},O=function(){return y.ref("users").once("value")},k=function(){return y.ref("leagues").once("value")},j=function(){function e(){Object(l.a)(this,e),this.handlers=[]}return Object(u.a)(e,[{key:"on",value:function(e){this.handlers.push(e)}},{key:"off",value:function(e){this.handlers=this.handlers.filter((function(t){return t!==e}))}},{key:"trigger",value:function(e){this.handlers.slice(0).forEach((function(t){return t(e)}))}}]),e}(),D=new(function(){function e(){Object(l.a)(this,e),this.gameInviteEventEmitter=new j}return Object(u.a)(e,[{key:"registerGameInvite",value:function(e){var t,a=this;this.gameInviteEventEmitter.on(e);var n=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid,r=v.database().ref().child("notifications/gameInvites");r.child("/invitedPlayers/".concat(n)).on("child_added",(function(e){r.child(e.val()).once("value",(function(e){console.log(e.val()),a.gameInviteEventEmitter.trigger(e.val())}))}))}}]),e}()),R=a(214),N=a.n(R),x=a(215),I=a.n(x),M=c.a.createContext(null),P=function(e){return function(t){Object(h.a)(n,t);var a=Object(m.a)(n);function n(){var e;Object(l.a)(this,n);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=a.call.apply(a,[this].concat(r))).state={authUser:null},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;v.auth().onAuthStateChanged((function(t){t?e.setState({authUser:t}):e.setState({authUser:null})}))}},{key:"render",value:function(){var t=this.state.authUser;return c.a.createElement(M.Provider,{value:t},c.a.createElement(e,this.props))}}]),n}(c.a.Component)},T=(a(251),a(252),a(48),a(13)),L=(a(149),a(43)),B=(a(150),a(59)),A=a(35),G=a(518),H=a(519),W=a(520),U=(a(185),B.a.Item),_=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={isLoading:!1},e.handleSubmit=function(t){e.setState({isLoading:!0});var a=e.props.history,r=t.email,o=t.password;n.signInUser(r,o).then((function(e){console.log(e),a.push("/")})).catch((function(t){t.code,t.message;alert(t.message),e.setState({isLoading:!1})}))},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props.history,a=this.state.isLoading;return c.a.createElement(M.Consumer,null,(function(n){return n?c.a.createElement("div",{style:{textAlign:"center",marginTop:"50px"}},c.a.createElement("p",null,"You are already logged in,"),c.a.createElement(T.a,{type:"primary",size:"small",onClick:function(){return t.goBack()},icon:c.a.createElement(W.a,null)},"Go back")," ","or ",c.a.createElement(A.b,{to:"/"},"Go Home")):c.a.createElement(B.a,{onFinish:e.handleSubmit,className:"login-form"},c.a.createElement(U,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your email!"}]},c.a.createElement(L.a,{prefix:c.a.createElement(G.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"email",size:"large"})),c.a.createElement(U,{name:"password",rules:[{required:!0,message:"Please input your Password!"}]},c.a.createElement(L.a,{prefix:c.a.createElement(H.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"password",size:"large"})),c.a.createElement(U,null,c.a.createElement(T.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button",loading:a},"Log in"),"Or ",c.a.createElement(A.b,{to:"/signup"},"register now!")))}))}}]),a}(c.a.Component),z=Object(f.e)(_),V=a(521),F=a(522),q=B.a.Item,Y=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var o;return Object(l.a)(this,a),(o=t.call(this,e)).formRef=c.a.createRef(),o.handleConfirmBlur=function(e){var t=e.target.value;o.setState({confirmDirty:o.state.confirmDirty||!!t})},o.compareToFirstPassword=function(e,t,a){var n=o.formRef.current;n&&t&&t!==n.getFieldValue("password")?a("Two passwords that you enter is inconsistent!"):a()},o.validateToNextPassword=function(e,t,a){var n=o.formRef.current;t&&o.state.confirmDirty&&n&&n.validateFields(["confirm"]),a()},o.handleSubmit=function(e){o.setState({isLoading:!0});var t=e.name,a=e.nickname,c=e.email,i=e.password;n.createUser(c,i).then((function(e){e&&e.user&&r.doCreateUser(e.user.uid,{name:t,nickname:a,email:c}).then((function(){o.props.history.push("/")})).catch((function(e){e.code,e.message;alert(e.message),o.setState({isLoading:!1})}))})).catch((function(e){e.code,e.message;alert(e.message),o.setState({isLoading:!1})}))},o.state={confirmDirty:!1,isLoading:!1},o}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.isLoading;return c.a.createElement(B.a,{onFinish:this.handleSubmit,ref:this.formRef,className:"login-form"},c.a.createElement(q,{name:"name",rules:[{required:!0,message:"Please input your name!"}]},c.a.createElement(L.a,{prefix:c.a.createElement(V.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Name",size:"large"})),c.a.createElement(q,{name:"nickname",rules:[{required:!0,message:"Please input your Nickname!"}]},c.a.createElement(L.a,{prefix:c.a.createElement(F.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Nickname",size:"large"})),c.a.createElement(q,{name:"email",rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your email!"}]},c.a.createElement(L.a,{prefix:c.a.createElement(G.a,{style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email",size:"large"})),c.a.createElement(q,{name:"password",rules:[{required:!0,message:"Please input your Password!"},{validator:this.validateToNextPassword}]},c.a.createElement(L.a,{prefix:c.a.createElement(H.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",size:"large"})),c.a.createElement(q,{name:"confirm",rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]},c.a.createElement(L.a,{prefix:c.a.createElement(H.a,{style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Confirm password",onBlur:this.handleConfirmBlur,size:"large"})),c.a.createElement(q,null,c.a.createElement(T.a,{type:"primary",htmlType:"submit",size:"large",className:"login-form-button",loading:e},"Sign Up")))}}]),a}(c.a.Component),K=Object(f.e)(Y),X=(a(123),a(66)),J=function(e){return function(t){var a=function(a){Object(h.a)(r,a);var n=Object(m.a)(r);function r(){return Object(l.a)(this,r),n.apply(this,arguments)}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var t=this;v.auth().onAuthStateChanged((function(a){e(a)||t.props.history.push("/login")}))}},{key:"render",value:function(){var e=this;return c.a.createElement(M.Consumer,null,(function(a){return a?c.a.createElement(t,e.props):c.a.createElement("div",{className:"full-view loader"},c.a.createElement(X.a,{size:"large",style:{width:"100%",position:"relative",top:"50%"}}))}))}}]),r}(c.a.Component);return Object(f.e)(a)}},Q=a(10),Z=(a(75),a(33)),$=a(14),ee=(a(209),a(70)),te=B.a.Item,ae=ee.a.Option,ne=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).leagueID=void 0,n.formRef=c.a.createRef(),n.onCreateLeague=function(){var e=n.formRef.current,t=n.state.users;e&&e.validateFields(["title","description","players"]).then((function(e){var a=e.description;n.setState({savingLeagueLoader:!0});var r=e.players.map((function(e){return{key:e,nickname:t[e].nickname}}));k().then((function(t){var o=t.val()&&t.val().lastID,c=o?o+1:1;v.database().ref("leagues/list/_"+c).set(Object($.a)({},e,{players:r,description:a||"",leagueID:c,active:!0})).then((function(){return n.setNewLeagueID(c)})),v.database().ref("leagues/lastID").set(c)}))}))},n.setNewLeagueID=function(e){n.leagueID=e,n.closeModal()},n.closeModal=function(){n.setState({showDialog:!1})},n.afterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&e(n.leagueID)},n.state={showDialog:n.props.visible,users:{},count:0,loading:!0,savingLeagueLoader:!1},n}return Object(u.a)(a,[{key:"fetchPlayers",value:function(){var e=this;O().then((function(t){t.val()?e.setState({users:t.val(),loading:!1}):e.setState({loading:!1})}))}},{key:"componentDidMount",value:function(){this.fetchPlayers()}},{key:"render",value:function(){var e=this.state,t=e.showDialog,a=e.users,n=e.loading,r=e.savingLeagueLoader;return c.a.createElement(Z.a,{title:"Create League",visible:t,destroyOnClose:!0,maskClosable:!1,confirmLoading:r,onOk:this.onCreateLeague,onCancel:this.closeModal,afterClose:this.afterClose,okText:"Save & Play",getContainer:".app"},c.a.createElement(B.a,{ref:this.formRef,layout:"vertical"},c.a.createElement(te,{label:"Title",name:"title",rules:[{required:!0,message:"Please input the league title!"}]},c.a.createElement(L.a,null)),c.a.createElement(te,{label:"Description",name:"description"},c.a.createElement(L.a,{type:"textarea"})),c.a.createElement(te,{label:"Players",name:"players",rules:[{required:!0,len:4,type:"array"}]},c.a.createElement(ee.a,{mode:"multiple",notFoundContent:n?c.a.createElement(X.a,{size:"small"}):null},Object.keys(a).map((function(e){return c.a.createElement(ae,{key:e,value:e},a[e].nickname)}))))))}}]),a}(o.Component),re=(a(516),a(144)),oe=(a(416),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showDialog:e.props.visible},e}return Object(u.a)(a,[{key:"closeModal",value:function(e){this.leagueID=e,this.setState({showDialog:!1})}},{key:"render",value:function(){var e=this,t=this.props,a=t.afterClose,n=t.activeLeagues,r=this.state.showDialog;return c.a.createElement(Z.a,{title:"Resume League",visible:r,destroyOnClose:!0,maskClosable:!1,width:"600px",footer:null,onCancel:function(){return e.closeModal()},afterClose:function(){return a(e.leagueID)}},c.a.createElement("p",null,"List of open leagues"),c.a.createElement(re.a,{itemLayout:"horizontal",dataSource:n,renderItem:function(t){return c.a.createElement(re.a.Item,null,c.a.createElement(re.a.Item.Meta,{title:c.a.createElement("a",{onClick:function(){return e.closeModal(t.leagueID)}},t.title)}))}}))}}]),a}(o.Component)),ce=Object(f.e)(oe),ie=a(46),se=a(29),le=a(72),ue=function(){return!!window.navigator.maxTouchPoints||"ontouchstart"in document.documentElement};function de(e,t,a){return e.addEventListener(t,a),function(){e.removeEventListener(t,a)}}a(431);var me={stiffness:180,damping:10},he={stiffness:120,damping:17};function fe(e,t,a){return Math.max(Math.min(e,a),t)}var ge,pe,ve=["#EF767A","#9acaff","#49BEAA","#49DCB1"],be=[[80,0],[160,80],[80,160],[0,80]],ye=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleTouchStart=function(e,t,a){n.handleMouseDown(e,t,a.touches[0])},n.handleTouchMove=function(e){e.preventDefault(),n.handleMouseMove(e.touches[0])},n.handleMouseMove=function(e){var t=e.pageX,a=e.pageY,r=n.state,o=r.order,c=r.lastPress,i=r.isPressed,s=Object(ie.a)(r.mouseCircleDelta,2),l=s[0],u=s[1];if(i){var d=[t-l,a-u],m=fe(Math.round(d[0]/80),0,2),h=fe(Math.round(d[1]/80),0,Math.floor(2)),f=null;1===m&&0===h?f=0:2===m&&1===h?f=1:1===m&&2===h?f=2:0===m&&1===h&&(f=3);var g=o.findIndex((function(e){return e.key===c})),p="number"===typeof f&&f!==g&&function(e,t,a){var n=Object(se.a)(e);if(Math.abs(t-a)===e.length-1){var r=[n[t],n[a]];n[a]=r[0],n[t]=r[1]}else if(t<a&&a-t>1){var o=n[t];n.splice(t,1),n.unshift(n.pop()),n.splice(a,0,o)}else{var c=n[t];n.splice(t,1),n.splice(a,0,c)}return n}(o,g,f);n.setState({mouseXY:d,order:p||Object(se.a)(o),from:p?g:n.state.from,to:p?f:n.state.to})}},n.handleMouseDown=function(e,t,a){var r=Object(ie.a)(t,2),o=r[0],c=r[1],i=a.pageX,s=a.pageY;n.setState({lastPress:e,isPressed:!0,mouseCircleDelta:[i-o,s-c],mouseXY:[o,c]})},n.handleMouseUp=function(){if(n.setState({isPressed:!1,mouseCircleDelta:[0,0]}),"function"===typeof n.props.onChange){var e=n.state,t=e.order,a=e.from,r=e.to;n.props.onChange(t,a,r)}},n.state={mouseXY:[0,0],mouseCircleDelta:[0,0],lastPress:null,isPressed:!1,order:e.players,from:null,to:null},n.colors=e.players.reduce((function(e,t,a){return e[t.key]=ve[a],e}),{}),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.unListenTouchmove=de(window,"touchmove",this.handleTouchMove),this.unListenTouchend=de(window,"touchend",this.handleMouseUp),this.unListenMousemove=de(window,"mousemove",this.handleMouseMove),this.unListenMouseup=de(window,"mouseup",this.handleMouseUp)}},{key:"componentWillUnmount",value:function(){this.unListenTouchmove(),this.unListenTouchend(),this.unListenMousemove(),this.unListenMouseup()}},{key:"render",value:function(){var e=this,t=this.state,a=t.order,n=t.lastPress,r=t.isPressed,o=t.mouseXY;return c.a.createElement("div",{className:"drag-pad"},c.a.createElement("div",{className:"drag-pad-content"},a.map((function(t,i){var s,l,u,d=a.findIndex((function(e){return e.key===t.key}));if(t.key===n&&r){var m=Object(ie.a)(o,2);l=m[0],u=m[1],s={translateX:l,translateY:u,scale:Object(le.spring)(1.2,me),boxShadow:Object(le.spring)((l-95)/15,me)}}else{var h=Object(ie.a)(be[d],2);l=h[0],u=h[1],s={translateX:Object(le.spring)(l,he),translateY:Object(le.spring)(u,he),scale:Object(le.spring)(1,me),boxShadow:Object(le.spring)((l-95)/15,me)}}return c.a.createElement(le.Motion,{key:t.key,style:s},(function(a){var r=a.translateX,o=a.translateY,i=a.scale,s=a.boxShadow;return c.a.createElement("div",{onMouseDown:e.handleMouseDown.bind(null,t.key,[l,u]),onTouchStart:e.handleTouchStart.bind(null,t.key,[l,u]),className:"player-icon",style:{backgroundColor:e.colors[t.key],WebkitTransform:"translate3d(".concat(r,"px, ").concat(o,"px, 0) scale(").concat(i,")"),transform:"translate3d(".concat(r,"px, ").concat(o,"px, 0) scale(").concat(i,")"),zIndex:t.key===n?99:d,boxShadow:"".concat(s,"px 5px 5px rgba(0,0,0,0.5)")}},c.a.createElement(V.a,null),c.a.createElement("span",null,t.nickname))}))}))))}}]),a}(c.a.Component),Ee=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={showDialog:e.visible,order:e.players},n.handleOnCancel=n.handleOnCancel.bind(Object(d.a)(n)),n.handleOnOk=n.handleOnOk.bind(Object(d.a)(n)),n.afterClose=n.afterClose.bind(Object(d.a)(n)),n.handleDragChange=n.handleDragChange.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props.players,t=this.state.showDialog;return c.a.createElement(Z.a,{title:"Reorder Players",visible:t,destroyOnClose:!0,maskClosable:!1,width:"600px",onOk:this.handleOnOk,onCancel:this.handleOnCancel,afterClose:this.afterClose},c.a.createElement(ye,{players:e,onChange:this.handleDragChange}))}},{key:"handleOnCancel",value:function(){this.setState({showDialog:!1})}},{key:"handleOnOk",value:function(){this.setState({showDialog:!1});var e=this.props.onOk;"function"===typeof e&&e(this.state.order)}},{key:"afterClose",value:function(){var e=this.props.onAfterClose;"function"===typeof e&&e()}},{key:"handleDragChange",value:function(e){this.setState({order:e})}}]),a}(o.Component),Se=(a(432),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).setGameMode=function(e){return function(){n.setState({showDialog:!1,modeSelected:e})}},n.handleAfterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&n.state.modeSelected&&e(n.state.modeSelected)},n.state={showDialog:e.visible},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.showDialog;return c.a.createElement(Z.a,{wrapClassName:"remote-local-dialog",visible:e,destroyOnClose:!0,closable:!1,maskClosable:!1,centered:!0,width:"300px",okText:"Frontal",cancelText:"OnLine",onOk:this.setGameMode("local"),onCancel:this.setGameMode("remote"),afterClose:this.handleAfterClose,bodyStyle:{display:"none"}})}}]),a}(c.a.Component)),we=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleOk=function(){n.setState({showDialog:!1});var e=n.props.onOk;"function"===typeof e&&e()},n.handleCancel=function(){n.setState({showDialog:!1})},n.handleAfterClose=function(){var e=n.props.onAfterClose;"function"===typeof e&&e()},n.state={showDialog:e.visible},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.state.showDialog,t=this.props.invite,a=t.leagueTitle,n=t.newGameId,r=t.inviter;return c.a.createElement(Z.a,{title:"Game Invite",visible:e,destroyOnClose:!0,closable:!0,maskClosable:!1,centered:!0,width:"300px",okText:"Join",cancelText:"Cancel",onOk:this.handleOk,onCancel:this.handleCancel,afterClose:this.handleAfterClose},c.a.createElement("div",null,"".concat(r.nickname," from ").concat(a," invites you to join game ").concat(n)))}}]),a}(c.a.Component);!function(e){e.NEW_LEAGUE="NEW_LEAGUE",e.RESUME_LEAGUE="RESUME_LEAGUE",e.REORDER_PLAYERS="REORDER_PLAYERS",e.NEW_GAME="NEW_GAME",e.GAME_INVITE="GAME_INVITE"}(pe||(pe={}));var Ce,Oe,ke=(ge={},Object(Q.a)(ge,pe.NEW_LEAGUE,ne),Object(Q.a)(ge,pe.RESUME_LEAGUE,ce),Object(Q.a)(ge,pe.REORDER_PLAYERS,Ee),Object(Q.a)(ge,pe.NEW_GAME,Se),Object(Q.a)(ge,pe.GAME_INVITE,we),ge),je=function(e){var t=e.dialog,a=e.dialogProps,n=ke[t];return c.a.createElement(n,a)},De=function(e){return c.a.createElement("ul",{className:"app-menu"},e.items.map((function(e,t){var a=e.onClick,n=e.text,r=e.dialog,o=e.dialogProps,i=e.disabled;return c.a.createElement("li",{key:t},c.a.createElement(T.a,{onClick:a,size:"large",disabled:i,block:!0},n),r&&o.visible?c.a.createElement(je,{dialog:r,dialogProps:o}):"")})))},Re=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={activeLeagues:[],newLeague:!1,resumeLeague:!1},e.activeLeagues=v.database().ref("leagues/list").orderByChild("active").equalTo(!0),e}return Object(u.a)(a,[{key:"fetch",value:function(){var e=this;this.activeLeagues.on("value",(function(t){if(t.val()){var a=v.auth().currentUser.uid;e.setState({activeLeagues:Object.values(t.val()).filter((function(e){var t=e.players;return Object.values(t).some((function(e){return e.key===a}))})),loading:!1})}}))}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.activeLeagues.off("value")}},{key:"showResumeLeagueDialog",value:function(){this.setState({resumeLeague:!0})}},{key:"closeResumeLeagueDialog",value:function(e){this.setState({resumeLeague:!1}),this.navigateToLeague(e)}},{key:"showNewLeagueDialog",value:function(){this.setState({newLeague:!0})}},{key:"closeNewLeagueDialog",value:function(e){this.setState({newLeague:!1}),this.navigateToLeague(e)}},{key:"navigateToLeague",value:function(e){e&&this.props.history.push("".concat("/league","/")+e)}},{key:"render",value:function(){return c.a.createElement("div",{className:"app-main"},c.a.createElement(De,{items:[{text:"Resume League",onClick:this.showResumeLeagueDialog.bind(this),dialog:pe.RESUME_LEAGUE,disabled:0===this.state.activeLeagues.length,dialogProps:{afterClose:this.closeResumeLeagueDialog.bind(this),visible:this.state.resumeLeague,activeLeagues:this.state.activeLeagues}},{text:"Create League",onClick:this.showNewLeagueDialog.bind(this),dialog:pe.NEW_LEAGUE,dialogProps:{onAfterClose:this.closeNewLeagueDialog.bind(this),visible:this.state.newLeague}},{text:"Settings"},{text:"Scores"},{text:"Sign Out",onClick:n.signOut}]}))}}]),a}(o.Component),Ne=J((function(e){return!!e}))(Re),xe=(a(173),a(34)),Ie=(a(515),a(79)),Me=(a(436),a(143)),Pe=a(529),Te=a(530),Le=a(531),Be=a(532),Ae=(a(438),a(527)),Ge=a(528),He=a(138);!function(e){e.SPADE="SPADE",e.HART="HART",e.DIAMOND="DIAMOND",e.CLUB="CLUB",e.NT="NT"}(Oe||(Oe={}));var We,Ue,_e,ze=(Ce={},Object(Q.a)(Ce,Oe.CLUB,"C"),Object(Q.a)(Ce,Oe.DIAMOND,"D"),Object(Q.a)(Ce,Oe.HART,"H"),Object(Q.a)(Ce,Oe.SPADE,"S"),Ce),Ve=function(e){for(var t=!0,a=0;a<4;a++){var n="bid".concat(a),r="won".concat(a);if("number"!==typeof e[n]||"number"!==typeof e[r]){t=!1;break}if(e[n]===e[r]){t=!1;break}}return t},Fe=function(){for(var e=[],t=0,a=Object.values(ze);t<a.length;t++)for(var n=a[t],r=2;r<15;r++)e.push("".concat(r,"-").concat(n));return e}(),qe=(We={},Object(Q.a)(We,ze.CLUB,0),Object(Q.a)(We,ze.DIAMOND,1),Object(Q.a)(We,ze.HART,2),Object(Q.a)(We,ze.SPADE,3),We),Ye=function(e){return e.findIndex((function(e){var t;return e.key===(null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid)}))},Ke=function(e){return e+1>3?e+1-4:e+1},Xe=function(e){for(var t=Je(Fe),a=[[],[],[],[]],n=0;n<52;n+=4)for(var r=0;r<a.length;r++)a[r].push(t[n+r]);return Ze(a),Qe(e,a)},Je=function(e){for(var t=Object(se.a)(e),a=t.length-1;a>0;a--){var n=Math.floor(Math.random()*(a+1)),r=[t[n],t[a]];t[a]=r[0],t[n]=r[1]}return t},Qe=function(e,t){return e.reduce((function(e,a,n){return e[a.key]=t[n],e}),{})},Ze=function(e){e.forEach((function(e){return $e(e)}))},$e=function(e){return e.sort((function(e,t){var a=e.split("-"),n=Object(ie.a)(a,2),r=n[0],o=n[1],c=t.split("-"),i=Object(ie.a)(c,2),s=i[0],l=i[1];return qe[o]<qe[l]?1:qe[o]>qe[l]?-1:+r-+s}))};a(439);!function(e){e.BID="BID",e.WON="WON"}(Ue||(Ue={})),function(e){e.ACTIVE="ACTIVE",e.FINISHED="FINISHED"}(_e||(_e={}));var et=a(525),tt=a(526),at=(a(174),a(42)),nt=(a(175),a(24)),rt=a(523),ot=a(517),ct=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 511.96 511.96",style:{enableBackground:"new 0 0 511.96 511.96"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{d:"M302.728,390.351c16.49,15.934,26.368,25.759,55.905,24.541c43.494-1.783,83.871-25.459,106.364-62.729 c38.78-64.247,17.576-128.53-23.702-166.824L272.705,6.528c-9.507-8.704-24.082-8.704-33.589,0L68.073,185.34 c-40.13,37.226-57.256,99.037-23.729,161.483c21.283,39.645,61.767,66.357,106.726,68.087c29.281,1.121,40.801-8.66,57.759-24.488 c4.458-4.167,11.767-1.033,11.767,5.076l0.009,29.987c0,16.172-4.228,32.071-12.253,46.115l-15.519,27.154 c-3.354,5.888,0.892,13.206,7.671,13.206h110.813c6.78,0,11.034-7.318,7.671-13.206l-15.519-27.154 c-8.024-14.045-12.244-29.943-12.244-46.115v-30.296C291.226,389.213,298.429,386.202,302.728,390.351"}),c.a.createElement("path",{style:{fill:"#2A2D33"},d:"M427.21,329.362c-8.701,14.419-21.869,26.091-37.482,33.362c-10.397,4.841-21.597,7.606-32.91,8.072 c-4.871,0.201-8.657,4.312-8.457,9.184c0.201,4.871,4.312,8.657,9.184,8.457c13.661-0.563,27.144-3.891,39.635-9.707 c18.759-8.735,34.611-22.785,45.145-40.244c19.021-31.51,20.189-64.061,7.087-94.822c-1.911-4.485-7.096-6.573-11.581-4.662 c-4.485,1.911-6.573,7.096-4.662,11.581C444.131,276.316,443.177,302.911,427.21,329.362z"})))},it=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 510.977 510.977",style:{enableBackground:"new 0 0 510.977 510.977"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{style:{fill:"#D71E00"},d:"M255.22,105.177c19.535-49.77,61.325-87.79,113.231-87.79c43.705,0,79.625,23.111,108.871,54.44 c38.859,41.622,56.17,137.216-15.863,209.24c-36.546,36.546-205.815,212.524-205.815,212.524S86.384,317.613,49.838,281.066 c-72.033-72.024-55.578-167.618-15.863-209.24c29.581-31.002,65.165-54.44,108.871-54.44 C194.751,17.386,235.685,55.407,255.22,105.177"}),c.a.createElement("path",{style:{fill:"#B21606"},d:"M429.848,94.824c26.006,21.865,39.538,63.103,31.858,97.341c-0.675,2.978-1.395,6.021-2.154,9.091 c-1.17,4.733,1.718,9.518,6.45,10.689c4.733,1.17,9.518-1.718,10.689-6.45c0.787-3.183,1.534-6.339,2.238-9.446 c9.114-40.635-6.622-88.592-37.718-114.736c-16.942-14.251-37.574-20.273-68.03-20.273c-4.875,0-8.828,3.952-8.828,8.828 s3.952,8.828,8.828,8.828C399.8,78.694,416.45,83.554,429.848,94.824z"})))},st=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("polygon",{style:{fill:"#D71E00"},points:"256,0 45.714,256 256,512 466.286,256 \t"}),c.a.createElement("path",{style:{fill:"#B21606"},d:"M248.872,448.656c-3.162,3.937-2.533,9.692,1.404,12.853c3.937,3.162,9.692,2.533,12.853-1.404 l64-79.698c3.162-3.937,2.533-9.692-1.404-12.853c-3.937-3.162-9.692-2.533-12.853,1.404L248.872,448.656z"})))},lt=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 511.998 511.998",style:{enableBackground:"new 0 0 511.998 511.998"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("path",{d:"M419.381,199.229c-26.651-12.378-51.541-12.674-74.177-7.186c18.441-21.827,29.058-50.472,27.396-81.642 C369.438,51,320.017,2.36,260.58,0.087c-66.578-2.542-121.353,50.67-121.353,116.682c0,28.699,10.393,54.937,27.567,75.273 c-22.636-5.488-47.526-5.192-74.177,7.186c-41.023,19.061-69.569,59.401-70.153,104.628 c-0.835,65.204,51.757,118.317,116.763,118.317c31.412,0,59.859-12.459,80.842-32.633v34.403c0,16.501-4.303,32.714-12.495,47.041 l-15.755,27.576c-3.422,5.991,0.907,13.438,7.797,13.438h112.766c6.899,0,11.219-7.446,7.797-13.438l-15.755-27.576 c-8.183-14.327-12.495-30.54-12.495-47.041V389.54c20.992,20.175,49.439,32.633,80.842,32.633 c65.006,0,117.607-53.113,116.763-118.317C488.95,258.629,460.403,218.289,419.381,199.229"}),c.a.createElement("path",{style:{fill:"#2A2D33"},d:"M423.915,355.877c-13.621,13.805-31.752,21.385-51.142,21.385c-4.961,0-8.982,4.022-8.982,8.982 c0,4.961,4.022,8.982,8.982,8.982c24.196,0,46.934-9.506,63.927-26.729c16.991-17.2,26.197-40.066,25.888-64.288 c-0.063-4.96-4.136-8.93-9.096-8.867c-4.96,0.063-8.93,4.136-8.867,9.096C444.872,323.859,437.529,342.095,423.915,355.877z"})))},ut=function(){return c.a.createElement("svg",{x:"0px",y:"0px",viewBox:"0 0 512 512",style:{enableBackground:"new 0 0 512 512"},width:"1em",height:"1em"},c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("path",{d:"M170.256,403.875c10.65-12.234,17.122-28.196,17.122-45.652c0-38.393-31.234-69.627-69.627-69.627 c-14.451,0-27.886,4.428-39.024,11.994c-1.632-10.049-2.463-20.254-2.463-30.537c0-49.249,18.842-95.868,53.054-131.273 c25.408-26.294,57.27-44.329,92.103-52.568l-23.142,27.868l23.133,19.21l59.366-71.49L201.539,17.43l-14.69,26.236l24.912,13.95 c-39.327,9.833-75.273,30.476-104.065,60.27c-39.659,41.041-61.5,95.081-61.5,152.168c0,20.2,2.752,40.155,8.17,59.414 c-3.996,8.772-6.241,18.504-6.241,28.756c0,17.491,6.497,33.483,17.185,45.726c-37.719,14.016-64.668,50.375-64.668,92.914v15.034 h234.473v-15.034C235.117,454.25,208.078,417.838,170.256,403.875z M117.752,318.665c21.813,0,39.558,17.746,39.558,39.558 s-17.746,39.558-39.559,39.558c-21.812,0-39.557-17.746-39.557-39.558S95.94,318.665,117.752,318.665z M32.362,481.828 c6.879-30.85,34.471-53.977,67.363-53.977h36.311c32.892,0,60.484,23.128,67.363,53.977H32.362z"}))),c.a.createElement("g",null,c.a.createElement("g",null,c.a.createElement("path",{d:"M511.357,208.266c0-42.611-27.04-79.025-64.86-92.988c10.65-12.233,17.122-28.196,17.122-45.652 C463.619,31.234,432.385,0,393.992,0c-38.393,0-69.627,31.234-69.627,69.626c0,17.491,6.497,33.483,17.186,45.726 c-37.719,14.016-64.667,50.375-64.667,92.915v15.034h171.669c3.701,14.892,5.576,30.234,5.576,45.751 c0,45.405-16.341,89.291-46.014,123.576c-21.289,24.598-48.406,43.143-78.51,54.073l19.818-31.008l-25.335-16.193l-50.044,78.3 L358.173,512l11.325-27.855l-25.967-10.556c33.429-12.822,63.523-33.788,87.321-61.284 c34.401-39.748,53.347-90.623,53.347-143.254c0-15.46-1.611-30.777-4.793-45.751h31.952V208.266z M393.992,30.069 c21.813,0,39.558,17.746,39.558,39.557c0,21.813-17.746,39.558-39.558,39.558s-39.558-17.746-39.558-39.558 C354.434,47.814,372.179,30.069,393.992,30.069z M308.603,193.232c6.879-30.851,34.471-53.978,67.363-53.978h36.311 c32.892,0,60.484,23.128,67.363,53.978H308.603z"}))),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null),c.a.createElement("g",null))},dt=function(e){var t=e.dataSource,a=e.players,n=e.currentRound,r=e.leagueScores,o=e.gameID;return c.a.createElement("div",{className:"game-table"},c.a.createElement("h3",{className:"game-header"},"Game ",o),c.a.createElement(at.a,{gutter:1,className:"table-header",style:{marginBottom:1}},c.a.createElement(nt.a,{span:4},c.a.createElement("div",{className:"table-cell"},"round")),mt(a)),t.map((function(e,t){return c.a.createElement(at.a,{gutter:1,className:"table-row ".concat(n-1===t?"current-round":""," ").concat(e.fell?"round-fell":""),key:t},c.a.createElement(nt.a,{span:4},c.a.createElement("div",{className:"table-cell"},t+1," ",e.factor>1&&c.a.createElement("span",{className:"round-factor"},"x".concat(e.factor)))),ht(a,e))})),c.a.createElement(at.a,{gutter:1,className:"table-row"},c.a.createElement(nt.a,{span:4},c.a.createElement("div",{className:"table-cell"},c.a.createElement(rt.a,{twoToneColor:"#52c41a"}))),ft(a,r)))},mt=function(e){return e.map((function(e){var t=e.index,a=e.playerName;return c.a.createElement(nt.a,{key:t,span:5},c.a.createElement("div",{className:"table-cell"},a))}))},ht=function(e,t){return e.map((function(e){var a=e.index;return c.a.createElement(nt.a,{span:5,key:a},c.a.createElement("div",{className:"table-cell score-cell ".concat(t["bid".concat(a)]!==t["won".concat(a)]?"fell":""," ").concat(a===t.highestBidder?"highest-bidder":"")},t["aggregateScore".concat(a)],a===t.highestBidder&&c.a.createElement("span",{className:"trump"},function(e){var t;switch(e){case Oe.SPADE:t=c.a.createElement(ot.a,{component:ct});break;case Oe.HART:t=c.a.createElement(ot.a,{component:it});break;case Oe.DIAMOND:t=c.a.createElement(ot.a,{component:st});break;case Oe.CLUB:t=c.a.createElement(ot.a,{component:lt});break;case Oe.NT:t="NT"}return{children:t}}(t.trump).children)))}))},ft=function(e,t){return e.map((function(e){var a=e.index;return c.a.createElement(nt.a,{span:5,key:a},c.a.createElement("div",{className:"table-cell"},""!==t["leagueScore".concat(a)]?t["leagueScore".concat(a)]:"-"))}))},gt=(a(440),a(236)),pt=(a(442),a(240)),vt=(a(444),a(181)),bt=a(524),yt=(a(446),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={visible:!1},e.showModal=function(){e.setState({visible:!0})},e.handleCancel=function(){e.setState({visible:!1})},e.trumpIconMap={SPADE:ct,HART:it,DIAMOND:st,CLUB:lt,NT:"NT"},e}return Object(u.a)(a,[{key:"onTrumpSelect",value:function(e){this.props.onChange(e),this.setState({visible:!1})}},{key:"render",value:function(){var e=this.props,t=e.trump,a=e.disabled;return c.a.createElement("div",{className:"cards-modal"},"trump",c.a.createElement(T.a,{ghost:!0,className:"card-btn",onClick:this.showModal,disabled:a},t?"NT"===t?"NT":c.a.createElement(ot.a,{component:this.trumpIconMap[t]}):c.a.createElement(bt.a,null)),c.a.createElement(Z.a,{footer:null,visible:this.state.visible,onCancel:this.handleCancel,className:"cards-modal-dialog"},c.a.createElement(T.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"SPADE")},c.a.createElement(ot.a,{component:ct})),c.a.createElement(T.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"HART")},c.a.createElement(ot.a,{component:it})),c.a.createElement(T.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"DIAMOND")},c.a.createElement(ot.a,{component:st})),c.a.createElement(T.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"CLUB")},c.a.createElement(ot.a,{component:lt})),c.a.createElement(T.a,{className:"card-btn",onClick:this.onTrumpSelect.bind(this,"NT")},"NT")))}}]),a}(o.Component)),Et=(a(447),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getButtons=function(e,t){var a=n.props,r=a.disabled,o=a.disabledNumber;return Array(t).fill(e).map((function(e,t){return c.a.createElement(T.a,{key:t,onClick:n.onBtnClick,size:"default",disabled:r||o===t+e},t+e)}))},n.state={showMore:!1},n.toggleMore=n.toggleMore.bind(Object(d.a)(n)),n.onBtnClick=n.onBtnClick.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"toggleMore",value:function(){this.setState({showMore:!this.state.showMore})}},{key:"onBtnClick",value:function(e){this.props.onSelect(1*e.target.textContent)}},{key:"render",value:function(){var e=this.props.disabled,t=this.state.showMore;return c.a.createElement("div",null,c.a.createElement("div",{className:"dial-pad"},t?this.getButtons(10,4):this.getButtons(0,10),c.a.createElement(T.a,{size:"default",onClick:this.toggleMore,className:"more-less-btn",disabled:e},t?"Less...":"More...")))}}]),a}(o.Component)),St=(a(448),"fade-in"),wt="slide-up",Ct=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.type;this.div.classList.add(t),setTimeout((function(){return e.div.classList.remove(t)}),400)}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.children!==this.props.children){var a=this.props.type;this.div.classList.add(a),setTimeout((function(){return t.div.classList.remove(a)}),400)}}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"",ref:function(t){return e.div=t}},this.props.children)}}]),a}(o.Component),Ot=function(e){var t=e.name,a=e.bid,n=e.won,r=e.score;return c.a.createElement("div",{className:"player-pad"},c.a.createElement("div",{className:"pad-name"},t,"\xa0",void 0!==r&&c.a.createElement("span",{className:"pad-score"},"[",c.a.createElement(Ct,{type:wt},r),"]")),c.a.createElement("div",{className:"pad-bid-won"},"Bid: ","number"===typeof a?a:" "," Won: ",n))},kt=(a(449),a(450),"top"),jt="bottom",Dt=function(e){return c.a.createElement("div",{className:"arrow-indicator ".concat(e.direction||"")},c.a.createElement("span",null,c.a.createElement("i",null),c.a.createElement("i",null)),c.a.createElement("i",null),c.a.createElement("span",null,c.a.createElement("i",null),c.a.createElement("i",null)))},Rt=(a(451),function(e){var t=e.card,n=e.preSelected,r=e.thrown,i=e.onCardClick,s=e.disabled,l=Object(o.useCallback)((function(e){s||i(e)}),[i,s]);return c.a.createElement("div",{className:"play-card ".concat(n?"pre-selected":""," ").concat(r?"thrown":""," ").concat(s?"disabled":""),onClick:l},c.a.createElement("img",{src:a(213)("./".concat(t,".svg"))}))}),Nt=(a(505),function(e){var t=e.card,n=e.thrownType,r=e.from,i=e.to,s=e.hasWinner,l=Object(o.useState)(r||i),u=Object(ie.a)(l,2),d=u[0],m=u[1];return Object(o.useEffect)((function(){m(i)}),[i]),c.a.createElement("div",{className:"thrown-card ".concat(n," ").concat(s?"has-winner":""),style:Object($.a)({},d)},t&&c.a.createElement("img",{src:a(213)("./".concat(t,".svg")),style:{width:"90px"}}))}),xt=Z.a.confirm;xe.a.config({top:100,maxCount:3});var It=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getNextPlayer=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t[a+1>3?a+1-4:a+1].index},n.getBeforePlayer=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t[a-1>-1?a-1:a-1+4].index},n.getBeforePlayers=function(e,t){var a=t.findIndex((function(t){return t.index===e}));return t.filter((function(e){return a!==e.index})).map((function(e){return e.index}))},n.getPlayerAggregateScore=function(e,t,a){var r=e[t];if(!r)return 0;var o=r["aggregateScore".concat(a)];return"number"!==typeof o||r.fell?n.getPlayerAggregateScore(e,t-1,a):o},n.getPlayersButtons=function(){var e=n.props,t=e.allRounds,a=e.currentRound,r=e.players,o=t.length&&t[a-1],i=o.highestBidder;return r.map((function(e,r){var s=e.index,l=e.playerName;return c.a.createElement(pt.a,{key:s,dot:i===s},c.a.createElement(vt.a.Button,{value:s},c.a.createElement(Ot,{name:l,bid:o["bid".concat(s)],won:o["won".concat(s)],score:n.getPlayerAggregateScore(t,a-1,s)})))}))},n.handleCardClick=function(e){return function(t){var a=n.state,r=a.preSelectedCard,o=a.selectedPlayer,c=n.props,i=c.currentRound,s=c.devicePlayerIndex,l=c.onCardThrown,u=(c.ownCardsState,n.getRoundData());if(u.inputMode===Ue.WON&&o===s)if(r===e){var d=t.currentTarget.offsetParent.offsetTop-15,m=t.currentTarget.offsetLeft;n.ownThrownCardInitPos={top:d,left:m},n.setState({thrownCards:[].concat(Object(se.a)(n.state.thrownCards),[{player:o,card:e}])}),l(e,o,i,u.currentHand),n.setState({thrownCard:e})}else n.setState({preSelectedCard:e})}},n.isAllBids=function(e){return Array(4).fill(1).every((function(t,a){return"number"===typeof e["bid".concat(a)]}))},n.state={selectedPlayer:void 0,reorderPlayersDialogVisible:!1,preSelectedCard:void 0,thrownCard:void 0,thrownCards:[],handCardType:void 0},n.handleSwitchMode=n.handleSwitchMode.bind(Object(d.a)(n)),n.handleCardsPadChange=n.handleCardsPadChange.bind(Object(d.a)(n)),n.handleNumberSelect=n.handleNumberSelect.bind(Object(d.a)(n)),n.setSelectedPlayer=n.setSelectedPlayer.bind(Object(d.a)(n)),n.showChangeHighestBidderConfirm=n.showChangeHighestBidderConfirm.bind(Object(d.a)(n)),n.showChangePlayerDialog=n.showChangePlayerDialog.bind(Object(d.a)(n)),n.handleReorderPlayersAfterClose=n.handleReorderPlayersAfterClose.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidUpdate",value:function(e){if("remote"===this.props.gameMode){var t=this.props,a=t.devicePlayerIndex,n=t.ownCardsState,r=this.getRoundData(),o=r.handsState,c=r.currentHand,i=r.inputMode,s=e.allRounds,l=e.currentRound,u=s.length&&s[l-1];if(u.inputMode!==i&&i===Ue.WON&&this.setState({selectedPlayer:r.highestBidder}),u.handsState!==o){var d={},m=o&&o[c]&&(o[c].thrownCards||[]).find((function(e){return e.player===a}));if(m&&m.card&&(n||[]).length>1?d.thrownCard=m.card:d.thrownCard=void 0,console.log(d.thrownCard),o){var h=o[c].thrownCards?function(e){var t,a=[],n=new Map,r=Object(He.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.has(o.player)||(n.set(o.player,!0),a.push(o))}}catch(c){r.e(c)}finally{r.f()}return a}([].concat(Object(se.a)(this.state.thrownCards),Object(se.a)(o[c].thrownCards))):[];d.thrownCards=h,d.selectedPlayer=o[c].turnOf,d.handCardType=h[0]&&h[0].card.split("-")[1]}else d.thrownCards=[],d.selectedPlayer=r.highestBidder,d.handCardType=void 0;this.setState(d)}}}},{key:"handleSwitchMode",value:function(e){var t=this.props.onChange,a=this.getRoundData(),n=a.trump,r=a.segment,o=a.handsState;if(0===r)return xe.a.warning("Total Bids are 13?!?!");if(this.state.thrownCard||o)return xe.a.warning("Can`t change bids after a card was thrown");var c=this.isAllBids(a);n&&c?(this.setState({selectedPlayer:void 0}),t(Object($.a)({},a,{inputMode:e?Ue.WON:Ue.BID}))):xe.a.warning("Bids are not completed")}},{key:"setSelectedPlayer",value:function(e){var t=this.props.gameMode,a=this.getRoundData();"remote"===t&&a.inputMode===Ue.WON||"radio"===e.target.type&&this.setState({selectedPlayer:e.target.value})}},{key:"handleCardsPadChange",value:function(e){var t=this.props.onChange,a=this.getRoundData();a.inputMode!==Ue.WON&&t(Object($.a)({},a,{trump:e}))}},{key:"handleNumberSelect",value:function(e){var t=this.props,a=t.players,n=t.currentRound,r=t.onChange,o=this.getRoundData(),c=o.inputMode,i=o.highestBidder,s=this.state.selectedPlayer,l=(c===Ue.BID?"bid":"won")+s,u={};if(c===Ue.BID)if(13===n)(e>=5&&!o["bid".concat(i)]||o["bid".concat(i)]<e)&&(u.highestBidder=s);else{var d=this.getNextPlayer(s,a);if(""!==o["bid".concat(d)]&&d!==i)return xe.a.warning("The Next Player already Bid, Can not change bid");if(!i&&0!==i||i===s){if(e<5)return xe.a.warning("First Bid should be more then 5");u.highestBidder=s}else if(e>=5)this.showChangeHighestBidderConfirm(r,o,l,e,s,a);else if(!Number.isInteger(o["bid".concat(this.getBeforePlayer(s,a))]))return xe.a.warning("The Bids are not in the right order!!")}u[l]=e,r(Object($.a)({},o,{},u),s)}},{key:"calculateDisableNum",value:function(){var e=this.props.players,t=this.getRoundData(),a=t.highestBidder,n=t.inputMode,r=this.state.selectedPlayer;if("number"===typeof r&&n===Ue.BID&&this.getNextPlayer(r,e)===a){var o,c=this.getBeforePlayers(r,e),i=0,s=Object(He.a)(c);try{for(s.s();!(o=s.n()).done;){var l=o.value,u=t["bid".concat(l)];if(null===u)return;i+=u}}catch(d){s.e(d)}finally{s.f()}return 13-i}}},{key:"showChangeHighestBidderConfirm",value:function(e,t,a,n,r,o){var c=this.getBeforePlayer;xt({title:"Change Highest Bidder?",content:"(will reset the rest of the bids)",okType:"danger",onOk:function(){var o;e(Object($.a)({},t,(o={bid0:null,bid1:null,bid2:null,bid3:null},Object(Q.a)(o,a,n),Object(Q.a)(o,"highestBidder",r),o)),r)},onCancel:function(){t["bid".concat(c(r,o))]?e(Object($.a)({},t,Object(Q.a)({},a,n)),r):(xe.a.warning("The Bids are not in the right order!!"),e(Object($.a)({},t),r))}})}},{key:"render",value:function(){var e=this,t=this.props,a=t.devicePlayerIndex,n=t.gameMode,r=this.getRoundData(),o=r.round,i=r.check,s=r.trump,l=r.segment,u=r.inputMode,d=r.fell,m=r.factor,h=this.state,f=h.selectedPlayer,g=h.reorderPlayersDialogVisible,p=this.isAllBids(r),v=this.getPlayersButtons();return c.a.createElement(vt.a.Group,{buttonStyle:"solid",className:"game-pad-container ".concat(d?"round-fell":""),onChange:this.setSelectedPlayer,value:f},c.a.createElement("h3",null,"Round: ",o),c.a.createElement(at.a,{type:"flex",justify:"space-around"},c.a.createElement(nt.a,null,c.a.createElement(gt.a,{onChange:this.handleSwitchMode,checkedChildren:" Won ",unCheckedChildren:" Bid ",checked:u===Ue.WON}),c.a.createElement("div",{className:"segment"},"Bids:"," ",c.a.createElement(Ct,{type:St},p?l:"".concat(l&&13+l)),c.a.createElement(Dt,{direction:p&&(l>0?kt:jt)})),c.a.createElement("div",null,"Check: ",i?"yes":"no"),c.a.createElement(Ct,{type:St},d?c.a.createElement("div",{className:"fell-indicator"},"round fell"):""),!d&&m>1&&c.a.createElement("div",{className:"factor-indicator"},"x".concat(m))),c.a.createElement(nt.a,{className:"item item2"},v[Ke(a+1)]),c.a.createElement(nt.a,null,c.a.createElement(yt,{trump:s,onChange:this.handleCardsPadChange,disabled:u===Ue.WON}))),c.a.createElement("div",{className:"thrown-cards-marker",ref:function(t){return e.cardsMarkerRef=t}}),c.a.createElement(at.a,{type:"flex",justify:"space-around"},c.a.createElement(nt.a,{className:"item item4"},v[Ke(a)]),c.a.createElement(nt.a,{style:{zIndex:1}},"remote"===n&&u===Ue.WON?c.a.createElement("div",{className:"number-pad-placement"}):c.a.createElement(Et,{disabledNumber:this.calculateDisableNum(),onSelect:this.handleNumberSelect,disabled:void 0===f})),c.a.createElement(nt.a,{className:"item item6"},v[Ke(a+2)])),c.a.createElement(at.a,{type:"flex",justify:"center",style:{position:"relative"}},c.a.createElement(nt.a,{className:"item item8"},v[a]),"remote"!==n&&1===o&&u===Ue.BID&&c.a.createElement("div",null,c.a.createElement(T.a,{type:"dashed",shape:"circle",className:"change-players-btn",onClick:this.showChangePlayerDialog},c.a.createElement(ot.a,{component:ut})),g&&c.a.createElement(Lt.Consumer,null,(function(t){var a=t.players,n=t.reorderPlayers;return c.a.createElement(je,{dialog:pe.REORDER_PLAYERS,dialogProps:{onOk:n,onAfterClose:e.handleReorderPlayersAfterClose,visible:g,players:a}})})))),"remote"===n&&this.getThrownCardsPlacement(),this.getCards())}},{key:"showChangePlayerDialog",value:function(){this.setState({reorderPlayersDialogVisible:!0})}},{key:"handleReorderPlayersAfterClose",value:function(){this.setState({reorderPlayersDialogVisible:!1})}},{key:"getCards",value:function(){var e=this,t=this.props,a=t.ownCardsState,n=t.devicePlayerIndex,r=this.state,o=r.preSelectedCard,i=r.thrownCard,s=r.handCardType,l=r.selectedPlayer;if(a){var u=Object.values(a).some((function(e){return e.split("-")[1]===s})),d=n===l;return c.a.createElement("div",{className:"cards-container"},Object.values(a).map((function(t){return c.a.createElement(Rt,{key:t,card:t,preSelected:o===t,thrown:i===t,onCardClick:e.handleCardClick(t),disabled:d&&u&&t.split("-")[1]!==s})})))}return""}},{key:"getThrownCardsPlacement",value:function(){var e,t=this;if(!this.cardsMarkerRef)return"";var a=this.getRoundData(),n=a.handsState,r=a.currentHand,o=n&&n[r].handWinner,i=this.state.thrownCards,s=this.props.devicePlayerIndex,l=Ke,u=(e={},Object(Q.a)(e,s,"bottom"),Object(Q.a)(e,l(s),"left"),Object(Q.a)(e,l(s+1),"top"),Object(Q.a)(e,l(s+2),"right"),e),d=void 0!==o&&this.getFromTo(u[o],!0);return c.a.createElement("div",{className:"hand-cards-container"},i.map((function(e){var a=d||t.getFromTo(u[e.player]),n=a.from,r=a.to;return c.a.createElement(Nt,{key:e.player,thrownType:u[e.player],card:e.card,from:n,to:r,hasWinner:void 0!==o})})))}},{key:"getFromTo",value:function(e,t){var a=this.cardsMarkerRef&&this.cardsMarkerRef.offsetTop,n=this.cardsMarkerRef&&this.cardsMarkerRef.offsetWidth;return t?function(e,t,a){switch(e){case"right":return{to:{top:94+t-63,left:a+90}};case"left":return{to:{top:94+t-63,left:-90}};case"top":return{to:{top:0,left:a/2-45}};case"bottom":return{to:{top:566,left:a/2-45}}}}(e,a,n):function(e,t,a,n){switch(e){case"right":return{from:{top:94+t-63,left:a+90},to:{top:94+t-63,left:a/2}};case"left":return{from:{top:94+t-63,left:-90},to:{top:94+t-63,left:a/2-90}};case"top":return{from:{top:63,left:a/2-45},to:{top:94+t-126*.8,left:a/2-45}};case"bottom":var r=void 0,o=void 0;return n&&(r=n.top,o=n.left),{from:"number"===typeof r&&"number"===typeof o?{top:r,left:o}:void 0,to:{top:94+t-126*.2,left:a/2-45}};default:return{to:{top:94+t,left:a/2}}}}(e,a,n,this.ownThrownCardInitPos)}},{key:"getRoundData",value:function(){var e=this.props,t=e.allRounds,a=e.currentRound;return t.length&&t[a-1]}}]),a}(o.Component),Mt=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).carouselSwipedLeft=function(){var e=n.props,t=e.currentView,a=e.onCurrentViewChange;"panel"!==t?a("panel"):(n.carouselEl.classList.add("bounce-left"),setTimeout((function(){return n.carouselEl.classList.remove("bounce-left")}),400))},n.nextRound=function(){var e=n.props,t=e.goToRound,a=e.currentRound,r=Number(a);r<13&&t&&t(r+1)},n.toRoundBefore=function(){var e=n.props,t=e.goToRound,a=e.currentRound,r=Number(a);1!==r&&t&&t(r-1)},n.carouselEl=c.a.createRef(),n.carouselSwipedRight=n.carouselSwipedRight.bind(Object(d.a)(n)),n.carouselSwipedLeft=n.carouselSwipedLeft.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){ue()&&(this.unListenSwipedLeft=de(this.carouselEl,"swiped-left",this.carouselSwipedLeft),this.unListenSwipedRight=de(this.carouselEl,"swiped-right",this.carouselSwipedRight))}},{key:"componentWillUnmount",value:function(){ue()&&(this.unListenSwipedLeft(),this.unListenSwipedRight())}},{key:"carouselSwipedRight",value:function(){var e=this,t=this.props,a=t.currentView,n=t.onCurrentViewChange;"table"!==a?n("table"):(this.carouselEl.classList.add("bounce-right"),setTimeout((function(){return e.carouselEl.classList.remove("bounce-right")}),400))}},{key:"render",value:function(){var e=this,t=this.props,a=t.gameID,n=t.gameMode,r=t.ownCardsState,o=t.currentView,i=t.rounds,s=t.playersColumns,l=t.currentRound,u=t.handleSave,d=t.leagueScores,m=t.devicePlayerIndex,h=t.handleCardThrown;return c.a.createElement("div",{className:"game-mobile-view ".concat("remote"===n?"mode-remote":"")},c.a.createElement("div",{className:"my-carousel",ref:function(t){return e.carouselEl=t}},c.a.createElement("div",{className:"my-carousel-slides-container ".concat(o)},c.a.createElement("div",{className:"my-carousel-slide"},c.a.createElement(dt,{dataSource:i,leagueScores:d,players:s,currentRound:l,gameID:a})),c.a.createElement("div",{className:"my-carousel-slide"},c.a.createElement(It,{gameMode:n,ownCardsState:r,onCardThrown:h,currentRound:l,allRounds:i,players:s,devicePlayerIndex:m,onChange:u})))),"remote"!==n||(0===(r||[]).length||"table"===o)&&c.a.createElement("div",{className:"round-navigation"},1!==l&&c.a.createElement(T.a,{type:"primary",className:"left",ghost:!0,onClick:this.toRoundBefore},c.a.createElement(et.a,null),"Round ".concat(l-1)),13!==l&&c.a.createElement(T.a,{type:"primary",ghost:!0,onClick:this.nextRound},"Round ".concat(Number(l)+1),c.a.createElement(tt.a,null))))}}]),a}(o.Component),Pt=[10,7,3,1],Tt=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"setCardsToPlayers",value:function(e,t,a){v.database().ref().child("cardsByGame/".concat(e,"/round").concat(t)).update({cardsState:a},(function(e){e&&console.error("cards state probably already exists")}))}},{key:"updateHandCardsState",value:function(e,t,a){var n,r=null===(n=v.auth().currentUser)||void 0===n?void 0:n.uid;r&&v.database().ref().child("cardsByGame/".concat(e,"/round").concat(t,"/cardsState/").concat(r)).update(Object(Q.a)({},"".concat(a),null))}}]),e}(),Lt=c.a.createContext(),Bt=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).handleSave=function(e,t){var a,r={},o=n.state.gameData.rounds,c=Object(se.a)(o),i=c.findIndex((function(t){return e.round===t.round})),s=c[i];if(c.splice(i,1,Object($.a)({},s,{},e)),e=c[i],"number"===typeof t){n.calculatePlayerScore(e,t,c,i,r);var l=function(e){for(var t=0,a=0,n=!0,r=0,o=Object.entries(e);r<o.length;r++){var c=Object(ie.a)(o[r],2),i=c[0],s=c[1];i.indexOf("bid")>-1&&null!==s&&""!==s&&(t+=1*s),i.indexOf("won")>-1&&(null!==s&&""!==s?a+=1*s:n=!1)}return{currentTotalBid:t,currentTotalWon:a,allHasWonInput:n}}(e),u=l.currentTotalBid,d=l.currentTotalWon,m=l.allHasWonInput;if(e.segment=null!==u?u-13:null,e.check=m&&13===d,e.check){if(Ve(e))e.fell=!0,e.round<12?c[e.round].factor=2*e.factor:e.factor>1&&(c[e.round].factor=e.factor);else if(e.fell){e.fell=!1,c[e.round]&&(c[e.round].factor=e.factor>1?e.factor/2:e.factor);for(var h=0;h<4;h++)n.calculatePlayerScore(e,h,c,i,r)}if(a=n.calculateSummary(c,i),13===e.round&&!e.fell){r.status=_e.FINISHED,n.updateGameStatus(_e.FINISHED);var f=n.state.gameData,g={totalScore0:f.totalScore0,totalScore1:f.totalScore1,totalScore2:f.totalScore2,totalScore3:f.totalScore3};g["totalScore".concat(t)]=r["totalScore".concat(t)],a=n.calculateLeagueScores(g,a)}n.gameSummaryRef.update(n.mapToPlayersObj(a))}}"remote"===n.state.gameData.gameMode&&(console.log(e.inputMode),o[i].inputMode===Ue.BID&&e.inputMode===Ue.WON&&[0,1,2,3].forEach((function(t){e["won".concat(t)]=0})));r.rounds=c,n.gameRef.update(r)},n.handleCardThrown=function(e,t,a,r){var o=n.getRoundData(a),c=o&&o.handsState&&o.handsState[r].thrownCards||[],i=[].concat(Object(se.a)(c),[{player:t,card:e}]),s=n.state.gameData.ownCardsState;n.gameRef.child("rounds/".concat(a-1,"/handsState/").concat(r)).update({status:"ACTIVE",turnOf:4!==i.length?Ke(t):null,thrownCards:i}).then((function(){return n.updateOwnCardState(e,a,s)}))},n.calculatePlayerScore=function(e,t,a,n,r){var o,c=e["bid".concat(t)],i=e["won".concat(t)];if(""!==i&&""!==c){if(i===c)o=1*i===0?e.segment>0?25:50:Math.pow(i,2)+10;else{var s=Math.abs(i-c);o=1*c===0?-(e.segment>0?25:50)+10*(s-1):-10*s}o*=e.factor,e["score".concat(t)]=o;for(var l=0,u=0;u<=n;u++){var d=a[u];"number"!==typeof d["score".concat(t)]||d.fell||(l+=d["score".concat(t)])}e["aggregateScore".concat(t)]=l,r["totalScore".concat(t)]=e["aggregateScore".concat(t)]}},n.calculateLeagueScores=function(e,t){return Object.keys(e).sort((function(t,a){return e[a]-e[t]})).forEach((function(a,n){var r=e[a],o=Pt[n];r<0&&o--,r%100===0&&o++,r>300&&(o+=3),r<-100&&(o-=3),t["".concat(a.slice(-1))].leagueScore=o})),t},n.calculateSummary=function(e,t){for(var a=t+1,n={},r=0;r<4;r++){n[r]={};for(var o=0,c=0,i=0,s=0,l=0,u=0,d=0,m=0,h=0,f=0,g=0,p=0;p<a;p++){var v=e[p];if(!v.fell){c++;var b=v.highestBidder===r,y=!b&&(r+1>3?0:r+1)===v.highestBidder;b?i++:y&&g++,v.segment>0&&u++,"NT"===v.trump&&m++,v["bid".concat(r)]===v["won".concat(r)]&&(o++,b?s++:y&&f++,"NT"===v.trump&&h++,v.segment>0?l++:d++)}}var E={wins:o,total:c},S={wins:s,total:i},w={wins:l,total:u},C={wins:d,total:c-u},O={wins:h,total:m},k={wins:f,total:g};n[r]={successRate:Number.isNaN(E)?"":E,successRateHB:S,successRateOver:w,successRateUnder:C,successRateNT:O,successRateLastBidder:k}}return n},n.mapToPlayersObj=function(e){var t=n.state,a=t.players,r=t.gameSummary;return a.reduce((function(t,a,n){return t[a.key]=Object($.a)({},r[a.key],{},e[n]),t}),{})},n.updateGameStatus=function(e){var t=n.props.match.params.leagueID;v.database().ref("leagueGames/_".concat(1*t,"/").concat(n.gameKey)).update({status:e})},n.toggleSlide=function(){var e="panel"===n.state.currentView?"table":"panel";n.setCurrentViewState(e)},n.getLeagueScores=function(){var e=n.state.players,t=n.state.gameSummary;return 0===Object.keys(t).length?{leagueScore0:"",leagueScore1:"",leagueScore2:"",leagueScore3:""}:e.reduce((function(e,a,n){return e["leagueScore".concat(n)]=t[a.key].leagueScore,e}),{})},n.initColumns=function(e){return e.map((function(e,t){return{playerName:e.nickname,index:t}}))},n.state={players:e.players,devicePlayerIndex:null,columns:[],currentView:"table",gameData:{currentRound:1,dealer:void 0,rounds:[],totalScore0:0,totalScore1:0,totalScore2:0,totalScore3:0,status:""},gameSummary:{}},n.selectActiveRound=n.selectActiveRound.bind(Object(d.a)(n)),n.setCurrentViewState=n.setCurrentViewState.bind(Object(d.a)(n)),n.handleReorderPlayers=n.handleReorderPlayers.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"fetch",value:function(){var e=this,t=this.props.match.params,a=t.leagueID,n=t.gameID,r=v.database();this.gameRef&&this.gameRef.off("value"),this.leagueGamesRef=r.ref("leagueGames/_".concat(1*a)).orderByChild("gameID").equalTo(1*n),this.leagueGamesRef.once("value",(function(t){var n=Object.values(t.val())[0],o=Object.keys(t.val())[0];e.gameKey=o,e.gameRef=r.ref("games/".concat(o)),e.gameSummaryRef=r.ref("leagueGamesSummary/_".concat(1*a,"/").concat(o,"/players"));var c=n.gameMode,i=n.playersOrder?n.playersOrder:e.props.players;e.setState({players:i,columns:e.initColumns(i),devicePlayerIndex:Ye(i)}),e.gameRef.on("value",(function(t){var a=t.val();e.setState({gameData:Object($.a)({},e.state.gameData,{gameMode:c},a)}),e.props.loaderStateCb(!1)})),e.gameSummaryRef.on("value",(function(t){e.setState({gameSummary:Object($.a)({},t.val())})}))}))}},{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.gameRef.off("value"),this.gameSummaryRef.off("value"),this.ownCardsStateRef&&this.ownCardsStateRef.off("value")}},{key:"componentDidUpdate",value:function(e,t){var a=this;e.match.params.gameID!==this.props.match.params.gameID&&this.fetch();var n=this.state.gameData;if(t.gameData.gameMode===n.gameMode&&t.gameData.currentRound===n.currentRound||this.handleGameModeChange(),t.gameData!==n){var r=n.currentRound,o=n.dealer,c=n.gameMode,i=this.getRoundData(r);if("remote"===c&&i){var s,l=i.handsState,u=i.currentHand,d=l&&l[u],m=null===(s=v.auth().currentUser)||void 0===s?void 0:s.uid;d&&4===(d.thrownCards||[]).length&&"ACTIVE"===d.status&&setTimeout((function(){o===m&&a.handleHandFinished(i)}),2500),13===u&&"FINISHED"===l[u].status&&o===m&&this.calculateHandScore(i)}}}},{key:"setCurrentViewState",value:function(e){this.setState({currentView:e})}},{key:"selectActiveRound",value:function(e){var t,a=this.state,n=a.gameData,r=a.currentView,o=n.rounds,c=n.currentRound,i=n.gameMode,s=n.dealer,l=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid;if(Number(e)<Number(c)||o[c-1].check){if(this.gameRef.update({currentRound:Number(e)}),"table"===r&&this.toggleSlide(),"remote"===i&&s===l&&!o[e-1].handsState){var u=this.state.players,d=Xe(u);Tt.setCardsToPlayers(this.gameKey,e,d)}}else xe.a.warning("Current round is not completed")}},{key:"handleReorderPlayers",value:function(e){this.setState({players:e,devicePlayerIndex:Ye(e),columns:this.initColumns(e)});var t=this.props.match.params.leagueID;v.database().ref("leagueGames/_".concat(1*t,"/").concat(this.gameKey)).update({playersOrder:e})}},{key:"render",value:function(){var e=this.state,t=e.columns,a=e.currentView,n=e.gameData,r=e.players,o=e.devicePlayerIndex,s=n.rounds,l=n.currentRound,u=n.gameMode,d=n.ownCardsState,m=this.props.match.params.gameID,h=t.slice(0,4);return c.a.createElement(Lt.Provider,{value:{players:r,reorderPlayers:this.handleReorderPlayers}},Object(i.createPortal)(c.a.createElement(T.a,{className:"toggle-view-btn",type:"link",onClick:this.toggleSlide,icon:"table"===a?c.a.createElement(Ae.a,null):c.a.createElement(Ge.a,null)}),document.querySelector("#app-header")||document.body),c.a.createElement(Mt,{gameID:m,gameMode:u,currentView:a,rounds:s,ownCardsState:d,handleCardThrown:this.handleCardThrown,playersColumns:h,devicePlayerIndex:o,currentRound:l,handleSave:this.handleSave,onCurrentViewChange:this.setCurrentViewState,goToRound:this.selectActiveRound,leagueScores:this.getLeagueScores()}))}},{key:"getRoundData",value:function(e){return this.state.gameData.rounds.find((function(t){return t.round===e}))}},{key:"handleGameModeChange",value:function(){var e=this,t=this.state,a=t.gameData,n=t.players;if("remote"===a.gameMode){var r,o=a.currentRound,c=a.dealer,i=null===(r=v.auth().currentUser)||void 0===r?void 0:r.uid;this.ownCardsStateRef=v.database().ref("cardsByGame/".concat(this.gameKey,"/round").concat(o,"/cardsState/").concat(i)),this.ownCardsStateRef.on("value",(function(t){console.log(t.val()),e.setState((function(e){return{gameData:Object($.a)({},e.gameData,{ownCardsState:t.val()||[]})}}));var a=e.state.gameData.currentRound,r=e.getRoundData(a);if(!t.val()&&1===a&&!r.handsState&&c===i){var o=Xe(n);Tt.setCardsToPlayers(e.gameKey,a,o)}}))}else a.ownCardsState&&this.setState({gameData:Object($.a)({},a,{ownCardsState:void 0})})}},{key:"handleHandFinished",value:function(e){var t,a,n=this,r=this.calculateHandWinner(e),o=e.round,c=e.handsState,i=e.currentHand;this.gameRef.child("rounds/".concat(o-1)).update((a={},Object(Q.a)(a,"won".concat(r.player),e["won".concat(r.player)]?e["won".concat(r.player)]+1:1),Object(Q.a)(a,"handsState",Object($.a)({},c,(t={},Object(Q.a)(t,i,Object($.a)({},c[i],{status:"FINISHED",handWinner:r.player})),Object(Q.a)(t,i+1,{status:"ACTIVE",turnOf:r.player,thrownCards:[]}),t))),a)).then((function(){return setTimeout((function(){return 13!==i&&n.goToNextHand(e,r)}),200)}))}},{key:"goToNextHand",value:function(e,t){var a=e.round,n=(e.handsState,e.currentHand);this.gameRef.child("rounds/".concat(a-1)).update({currentHand:n+1})}},{key:"calculateHandScore",value:function(e){var t=this,a=Object($.a)({},this.state.gameData),n=a.rounds,r=a.currentRound,o=Object($.a)({},e),c={};[0,1,2,3].forEach((function(e){return t.calculatePlayerScore(o,e,n,r-1,c)}));var i=function(e){var t=0,a=0;return[0,1,2,3].forEach((function(n){t+=+e["bid".concat(n)],a+=+e["won".concat(n)]})),{currentTotalBid:t,currentTotalWon:a}}(o).currentTotalWon;if(o.check=13===i,o.check){if(Ve(o))o.fell=!0,o.round<12?n[o.round].factor=2*o.factor:o.factor>1&&(n[o.round].factor=o.factor);else if(o.fell){o.fell=!1,n[o.round]&&(n[o.round].factor=o.factor>1?o.factor/2:o.factor);for(var s=0;s<4;s++)this.calculatePlayerScore(o,s,n,r-1,c)}var l=this.calculateSummary(n,r-1);if(13===o.round&&!o.fell){c.status=_e.FINISHED,this.updateGameStatus(_e.FINISHED);var u={totalScore0:c.totalScore0,totalScore1:c.totalScore1,totalScore2:c.totalScore2,totalScore3:c.totalScore3};l=this.calculateLeagueScores(u,l)}this.gameSummaryRef.update(this.mapToPlayersObj(l))}n.splice(r-1,1,o),c.rounds=n,this.gameRef.update(c)}},{key:"calculateHandWinner",value:function(e){var t=e.trump,a=e.handsState,n=e.currentHand,r=(a&&a[n]).thrownCards,o=r.filter((function(e){return e.card.split("-")[1]===ze[t]}));if(o.length)return o.sort((function(e,t){return+t.card.split("-")[0]-+e.card.split("-")[0]}))[0];var c=r[0].card.split("-")[1];return r.filter((function(e){return e.card.split("-")[1]===c})).sort((function(e,t){return+t.card.split("-")[0]-+e.card.split("-")[0]}))[0]}},{key:"updateOwnCardState",value:function(e,t,a){var n=Object.keys(a).find((function(t){return a[t]===e}));Tt.updateHandCardsState(this.gameKey,t,n)}}]),a}(o.Component);var At=a(239),Gt=(a(509),function(e){return c.a.createElement("div",{className:"full-view loader ".concat(e.className?e.className:"")},c.a.createElement(X.a,{size:"large",style:{width:"100%",position:"relative",top:"50%"}}))}),Ht=(a(510),{successRate:"Succes Win Rates",successRateHB:"Highest Bidding Win Rates",successRateOver:"Over Win Rate",successRateUnder:"Under Win Rate",successRateNT:"NT Win Rates",successRateLastBidder:"Last Bidder Win Rate"}),Wt=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).getTableHeaders=function(e){return e.map((function(e){var t=e.key,a=e.nickname;return c.a.createElement(nt.a,{key:t,span:6},c.a.createElement("div",{className:"table-cell"},a))}))},n.getScoreRow=function(e){return e.map((function(e){return c.a.createElement(nt.a,{span:6,key:e.key},c.a.createElement("div",{className:"table-cell"},e.games&&n.scoreReducer(e.games,"leagueScore")))}))},n.getStatsRow=function(e){var t=n.state.players;return c.a.createElement("div",{className:"stats-row",key:e},c.a.createElement("h4",null,Ht[e]),c.a.createElement(at.a,{gutter:1},n.getWinRateRow(t,e)))},n.getWinRateRow=function(e,t){return e.map((function(e){return c.a.createElement(nt.a,{span:6,key:e.key},c.a.createElement("div",{className:"table-cell"},e.games&&n.calculateRate(e.games,t),"%"))}))},n.scoreReducer=function(e,t){return e.reduce((function(e,a){return e+Number(a[t])}),0)},n.calculateRate=function(e,t){return n.toPercentage(n.preCalculateRate(e,t))},n.toPercentage=function(e){var t=e.wins,a=e.total;return Number.parseFloat(t/a*100).toFixed(0)},n.preCalculateRate=function(e,t){return e.reduce((function(e,a){var n=a[t];return e.wins+=n.wins,e.total+=n.total,e}),{wins:0,total:0})},n.state={players:e.league.players},n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.gameSummaryRef.off("value")}},{key:"fetch",value:function(){var e=this,t=this.props.league.leagueID,a=this.state.players,n=v.database().ref();this.gameSummaryRef=n.child("leagueGamesSummary/_".concat(t)),this.leagueGamesRef=n.child("leagueGames/_".concat(t)).orderByChild("status").equalTo("FINISHED"),this.leagueGamesRef.on("value",(function(t){if(t.val()){var n=Object.keys(t.val()),r=n[n.length-1];e.gameSummaryRef.orderByKey().endAt(r).on("value",(function(t){var n=Object.values(t.val());e.setState({players:a.map((function(e){var t=e.key;return Object($.a)({},e,{games:n.map((function(e,a){return e.players[t]}))})}))})}))}}))}},{key:"render",value:function(){var e=this.props.league.title,t=this.state.players;return c.a.createElement("div",{className:"game-summery"},c.a.createElement("h3",null,e),c.a.createElement("h3",null,"League Score:"),c.a.createElement(at.a,{gutter:1,className:"table-header",style:{marginBottom:1}},this.getTableHeaders(t)),c.a.createElement(at.a,{gutter:1},this.getScoreRow(t)),Object.keys(Ht).map(this.getStatsRow))}}]),a}(o.Component),Ut=function(){function e(){Object(l.a)(this,e)}return Object(u.a)(e,null,[{key:"invitePlayers",value:function(t,a){return new Promise((function(n){var r=v.database().ref().child("notifications/gameInvites"),o=r.push().key,c=e.setInviteObj(t,o,a),i=c.invited,s=c.invite,l=Object(Q.a)({},"".concat(o),s);r.update(l).then((function(){return e.setAllInvited(i,r)})).then((function(t){var a=Object.keys(i);r.child("".concat(o,"/joinedPlayers")).on("child_added",(function(c){console.log(c.val());var i=a.indexOf(c.val());i>-1&&a.splice(i,1),console.log(a),a.length||(r.child("".concat(o,"/joinedPlayers")).off("child_added"),e.removeAllInvited(t),n())}))}))}))}},{key:"setInviteObj",value:function(e,t,a){var n,r=e.players,o=e.leagueID,c=e.title,i=null===(n=v.auth().currentUser)||void 0===n?void 0:n.uid,s=null===r||void 0===r?void 0:r.find((function(e){return e.key===i}));return{invited:r.filter((function(e){return e.key!==i})).reduce((function(e,a){return e[a.key]=t,e}),{}),invite:{inviter:s,inviteKey:t,leagueID:o,leagueTitle:c,newGameId:a}}}},{key:"setAllInvited",value:function(e,t){var a=[];return Object.keys(e).forEach((function(n){var r=t.child("invitedPlayers/".concat(n)).push(e[n]);a.push(r)})),Promise.all(a)}},{key:"removeAllInvited",value:function(e){e.forEach((function(e){e.set(null)}))}},{key:"acceptGameInvite",value:function(e){var t,a=e.inviteKey,n=v.database().ref().child("notifications/gameInvites/".concat(a,"/joinedPlayers")),r=null===(t=v.auth().currentUser)||void 0===t?void 0:t.uid;return new Promise((function(e){n.push(r).then((function(){n.on("value",(function(t){3===Object.values(t.val()).length&&(n.off("value"),e())}))}))}))}}]),e}(),_t=Me.a.Content,zt=Ie.a.SubMenu,Vt=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;Object(l.a)(this,a),(n=t.call(this,e)).leagueRef=void 0,n.leagueGamesRef=void 0,n.toggleDrawer=function(){n.setState({drawerVisible:!n.state.drawerVisible})},n.setLoaderState=function(e){n.setState({loading:e})},n.setNewGameDialogState=function(e){n.setState({newGameDialog:e})},n.addGame=function(e){var t=n.state,a=t.league,r=t.leagueGames,o=a.leagueID,c=a.players,i=a.blockedBy,s=n.props,l=s.history,u=s.match,d=r.length+1,m=v.database().ref().child("games").push().key,h=function(e,t){var a=[],n={segment:"",totalBids:"",trump:"",check:!1,factor:1,fell:!1,highestBidder:"",inputMode:Ue.BID,score0:"",aggregateScore0:"",bid0:"",won0:"",score1:"",aggregateScore1:"",bid1:"",won1:"",score2:"",aggregateScore2:"",bid2:"",won2:"",score3:"",aggregateScore3:"",bid3:"",won3:""};"remote"===t&&(n.currentHand=1);for(var r=0;r<13;r++)a.push(Object($.a)({round:r+1},n));return{gameData:{rounds:a,currentRound:1,totalScore0:0,totalScore1:0,totalScore2:0,totalScore3:0,status:_e.ACTIVE},gameSummary:{players:e.reduce((function(e,t){return e[t.key]={leagueScore:"",successRate:"",successRateHB:"",successRateOver:"",successRateUnder:"",successRateNT:""},e}),{})}}}(c,e),f={};f["/games/".concat(m)]=Object($.a)({gameID:d,dealer:"remote"===e&&i?i:""},h.gameData),f["/leagueGames/_".concat(o,"/").concat(m)]={gameID:d,gameMode:e,status:_e.ACTIVE},f["/leagueGamesSummary/_".concat(o,"/").concat(m)]=Object($.a)({},h.gameSummary),v.database().ref().update(f,(function(e){e||(n.setState({menuSelected:"".concat(d)}),l.push("".concat(u.url).concat("/game","/").concat(d)))}))};var r=e.location,o=e.match.params.leagueID,c=r.pathname.match(/game\/[1-9]/g)||[],i=!!c.length&&c[0].split("/")[1];n.state={loading:!1,menuSelected:i||"dashboard",league:{title:"",players:[]},leagueGames:[],drawerVisible:!1,newGameDialog:!1};var s=v.database().ref();return n.leagueRef=s.child("leagues/list/_".concat(o)),n.leagueGamesRef=s.child("leagueGames/_".concat(o)),n.handleMenuItemClick=n.handleMenuItemClick.bind(Object(d.a)(n)),n.newGameDialogHandler=n.newGameDialogHandler.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.leagueRef.off("value")}},{key:"fetch",value:function(){var e=this;this.setState({loading:!0}),this.leagueRef.on("value",(function(t){var a=t.val();console.log(a),a&&e.setState({league:Object($.a)({},e.state.league,{},a),loading:!1})})),this.leagueGamesRef.on("child_added",(function(t){e.setState((function(e){return{leagueGames:[].concat(Object(se.a)(e.leagueGames),[t.val()])}}))})),this.leagueGamesRef.on("child_changed",(function(t){console.log("child_changed",t.val()),e.setState((function(e){var a=e.leagueGames,n=a.findIndex((function(e){return e.gameID===t.val().gameID}));return{leagueGames:[].concat(Object(se.a)(a.slice(0,n)),[Object($.a)({},t.val())],Object(se.a)(a.slice(n+1)))}}))}))}},{key:"render",value:function(){var e=this,t=this.props.match,a=this.state,n=a.league,r=a.loading,o=a.drawerVisible,i=n.leagueID,s=n.players;return c.a.createElement(Me.a,{className:"league-container"},c.a.createElement(At.a,{getContainer:".app",width:"250px",open:o,onHandleClick:this.toggleDrawer,onClose:this.toggleDrawer},c.a.createElement("div",{className:"drawer-title"},n.title),this.getMenu()),r&&c.a.createElement(Gt,{className:"with-mask"}),c.a.createElement(Me.a,null,c.a.createElement(_t,null,c.a.createElement(f.a,{path:"".concat("/league","/:leagueID/game/:gameID"),render:function(t){return i?c.a.createElement(Bt,Object.assign({},t,{players:s,loaderStateCb:e.setLoaderState})):c.a.createElement(Gt,null)}}),c.a.createElement(f.a,{exact:!0,path:t.url,render:function(e){return i?c.a.createElement(Wt,Object.assign({},e,{league:n})):c.a.createElement(Gt,null)}}))))}},{key:"getMenu",value:function(){var e=this.props.match,t=this.state,a=t.leagueGames,n=t.menuSelected,r=t.newGameDialog;return c.a.createElement(Ie.a,{mode:"inline",selectedKeys:[n],defaultOpenKeys:["gamesSub"],onClick:this.handleMenuItemClick,className:"league-menu"},c.a.createElement(Ie.a.Item,{key:"dashboard"},c.a.createElement(Pe.a,null),c.a.createElement(A.b,{to:"".concat(e.url)},"League Summary")),c.a.createElement(zt,{key:"gamesSub",title:c.a.createElement("span",null,c.a.createElement(Te.a,null),c.a.createElement("span",null,"Games"))},a.map((function(t,a){return c.a.createElement(Ie.a.Item,{key:t.gameID.toString()},c.a.createElement(A.b,{to:"".concat(e.url).concat("/game","/").concat(t.gameID)},"Game ",t.gameID))})),c.a.createElement(Ie.a.Item,{key:"new_game"},c.a.createElement(Le.a,null),c.a.createElement("span",null,"New Game"))),r&&c.a.createElement(je,{dialog:pe.NEW_GAME,dialogProps:{visible:!0,onAfterClose:this.newGameDialogHandler}}),c.a.createElement(Ie.a.Item,{key:"main_menu"},c.a.createElement(Be.a,{className:"rotate-180"}),c.a.createElement(A.b,{to:"/"},"To Main Menu")))}},{key:"handleMenuItemClick",value:function(e){var t=this,a=e.key;"new_game"===a?this.isAddGameOk()?this.blockLeague().then((function(){t.setNewGameDialogState(!0)}),(function(e){console.error(e),xe.a.warning("One of the players is blocking!!")})):xe.a.warning("Last Game is not finished yet!!"):"main_menu"!==a&&a!==this.state.menuSelected&&this.setState({menuSelected:a}),setTimeout(this.toggleDrawer,200)}},{key:"blockLeague",value:function(){var e,t=null===(e=v.auth().currentUser)||void 0===e?void 0:e.uid;return this.leagueRef.child("blockedBy").set(t)}},{key:"unblockLeague",value:function(){this.leagueRef.update({blockedBy:null})}},{key:"newGameDialogHandler",value:function(e){var t=this;if(this.setState({newGameDialog:!1}),"local"===e)this.unblockLeague(),this.addGame(e);else if("remote"===e){this.setState({loading:!0});var a=this.state,n=a.league,r=a.leagueGames.length+1;Ut.invitePlayers(Object($.a)({},n),r).then((function(){console.log("inventation resolved- ok to add game"),t.addGame("remote"),t.setState({loading:!1})}))}}},{key:"isAddGameOk",value:function(){var e=this.state.leagueGames,t=e[e.length-1];return!t||t.status===_e.FINISHED}}]),a}(c.a.Component),Ft=J((function(e){return!!e}))(Vt),qt=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onGameInvite=function(e){n.setState({showGameInvite:!0,invite:e})},n.acceptGameInvite=function(){var e=n.state.invite;n.setState({loader:!0}),Ut.acceptGameInvite(e).then((function(){n.setState({loader:!1});var t=n.props.history,a=e.leagueID,r=e.newGameId;setTimeout((function(){return t.push("".concat("/league","/").concat(a,"/game/").concat(r))}),500)}),(function(){n.setState({loader:!1})}))},n.closeGameInvite=function(){n.setState({showGameInvite:!1})},n.state={inlineHeader:!1,showGameInvite:!1,loader:!1},n.toggleHeaderInline=n.toggleHeaderInline.bind(Object(d.a)(n)),n.handleWindowSizeChange=n.handleWindowSizeChange.bind(Object(d.a)(n)),n}return Object(u.a)(a,[{key:"toggleHeaderInline",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setState({inlineHeader:e})}},{key:"handleWindowSizeChange",value:function(){this.setState({})}},{key:"listenToWinResize",value:function(e){return de(window,"resize",e)}},{key:"componentWillMount",value:function(){var e=this,t=this.props.location.pathname;this.toggleHeaderInline("/"!==t),this.unlistenHistory=this.props.history.listen((function(t,a){var n=t.pathname;e.toggleHeaderInline("/"!==n&&"/login"!==n)})),this.unlistenWinResize=this.listenToWinResize(this.handleWindowSizeChange)}},{key:"componentWillUnmount",value:function(){this.unlistenHistory(),this.unlistenWinResize()}},{key:"componentDidMount",value:function(){var e=this;v.auth().onAuthStateChanged((function(t){t&&D.registerGameInvite(e.onGameInvite)}))}},{key:"render",value:function(){var e=this.state,t=e.inlineHeader,a=e.showGameInvite,n=e.invite,r=e.loader;return c.a.createElement("div",{className:"app-wrapper ".concat("undefined"!==typeof window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")?"mobile-mode":"desktop-mode")},c.a.createElement("img",{src:I.a}),c.a.createElement("div",{className:"app ".concat(t?"inline-header":"")},c.a.createElement("header",{id:"app-header"},c.a.createElement("img",{src:N.a,className:"app-logo",alt:"logo"}),c.a.createElement("h1",{className:"app-title"},"Sub Whist")),r&&c.a.createElement(Gt,{className:"with-mask"}),c.a.createElement("div",{className:"app-content"},c.a.createElement(f.a,{exact:!0,path:"/",component:Ne}),c.a.createElement(f.a,{exact:!0,path:"/login",component:z}),c.a.createElement(f.a,{exact:!0,path:"/signup",component:K}),c.a.createElement(f.a,{path:"".concat("/league","/:leagueID"),render:function(e){return c.a.createElement(Ft,Object.assign({},e,{screenSize:442}))}}))),a&&c.a.createElement(je,{dialog:pe.GAME_INVITE,dialogProps:{visible:!0,invite:n,onAfterClose:this.closeGameInvite,onOk:this.acceptGameInvite}}))}}]),a}(o.Component),Yt=Object(f.e)(P(qt)),Kt=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Xt(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}a(513);s.a.render(c.a.createElement(A.a,{basename:"/whist"},c.a.createElement(Yt,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/whist",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/whist","/service-worker.js");Kt?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Xt(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Xt(e)}))}}()}},[[241,1,2]]]);
//# sourceMappingURL=main.e3dda57b.chunk.js.map